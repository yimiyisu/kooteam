(()=>{var e={232:(e,t,i)=>{"use strict";t.B=!0,t.A=void 0;var s,n=(s=i(853))&&s.__esModule?s:{default:s},r=i(585);n.default.locale("zh-cn",r.zhCN);t.A={data:()=>({sheet:null,saver:null,result:null}),async mounted(){if(document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&"s"===e.key&&(e.preventDefault(),e.stopPropagation(),this.save())})),void 0===window._rd_)return this.init();this.saver=$.throttle(this.save,1e4),window.addEventListener("message",this.listen),window.parent.postMessage({type:"iframeLoaded"})},methods:{listen({data:e}){e&&"initContent"===e.type&&this.init(e.content)},init(e){const t=e?JSON.parse(e):{};this.sheet=new n.default(this.$el,{mode:window._rd_?"read":"edit"}).loadData(t).change((e=>{this.result=e,this.saver()}))},save(){window.parent.postMessage({type:"saveContent",content:JSON.stringify(this.result)})}}}},617:(e,t,i)=>{"use strict";t.X=function(e,t,i,n,r,l){return(0,s.openBlock)(),(0,s.createElementBlock)("div")};var s=i(61)},388:(e,t,i)=>{var s=i(314),n=i(417),r=i(164);t=s(!1);var l=n(r);t.push([e.id,"body {\n  margin: 0;\n}\n.x-spreadsheet {\n  font-size: 13px;\n  line-height: normal;\n  user-select: none;\n  -moz-user-select: none;\n  font-family: 'Lato', 'Source Sans Pro', Roboto, Helvetica, Arial, sans-serif;\n  box-sizing: content-box;\n  background: #fff;\n  -webkit-font-smoothing: antialiased;\n}\n.x-spreadsheet textarea {\n  font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;\n}\n.x-spreadsheet-sheet {\n  position: relative;\n  overflow: hidden;\n}\n.x-spreadsheet-table {\n  vertical-align: bottom;\n}\n.x-spreadsheet-tooltip {\n  font-family: inherit;\n  position: absolute;\n  padding: 5px 10px;\n  color: #fff;\n  border-radius: 1px;\n  background: #000000;\n  font-size: 12px;\n  z-index: 201;\n}\n.x-spreadsheet-tooltip:before {\n  pointer-events: none;\n  position: absolute;\n  left: calc(50% - 4px);\n  top: -4px;\n  content: \"\";\n  width: 8px;\n  height: 8px;\n  background: inherit;\n  -webkit-transform: rotate(45deg);\n  transform: rotate(45deg);\n  z-index: 1;\n  box-shadow: 1px 1px 3px -1px rgba(0, 0, 0, 0.3);\n}\n.x-spreadsheet-color-palette {\n  padding: 5px;\n}\n.x-spreadsheet-color-palette table {\n  margin: 0;\n  padding: 0;\n  border-collapse: separate;\n  border-spacing: 2;\n  background: #fff;\n}\n.x-spreadsheet-color-palette table td {\n  margin: 0;\n  cursor: pointer;\n  border: 1px solid transparent;\n}\n.x-spreadsheet-color-palette table td:hover {\n  border-color: #ddd;\n}\n.x-spreadsheet-color-palette table td .x-spreadsheet-color-palette-cell {\n  width: 16px;\n  height: 16px;\n}\n.x-spreadsheet-border-palette {\n  padding: 6px;\n}\n.x-spreadsheet-border-palette table {\n  margin: 0;\n  padding: 0;\n  border-collapse: separate;\n  border-spacing: 0;\n  background: #fff;\n  table-layout: fixed;\n}\n.x-spreadsheet-border-palette table td {\n  margin: 0;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left {\n  border-right: 1px solid #eee;\n  padding-right: 6px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell {\n  width: 30px;\n  height: 30px;\n  cursor: pointer;\n  text-align: center;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell .x-spreadsheet-icon-img {\n  opacity: 0.8;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-left .x-spreadsheet-border-palette-cell:hover {\n  background-color: #eee;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right {\n  padding-left: 6px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right .x-spreadsheet-toolbar-btn {\n  margin-top: 0;\n  margin-bottom: 3px;\n}\n.x-spreadsheet-border-palette .x-spreadsheet-border-palette-right .x-spreadsheet-line-type {\n  position: relative;\n  left: 0;\n  top: -3px;\n}\n.x-spreadsheet-dropdown {\n  position: relative;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-content {\n  position: absolute;\n  z-index: 200;\n  background: #fff;\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\n}\n.x-spreadsheet-dropdown.bottom-left .x-spreadsheet-dropdown-content {\n  top: calc(100% + 5px);\n  left: 0;\n}\n.x-spreadsheet-dropdown.bottom-right .x-spreadsheet-dropdown-content {\n  top: calc(100% + 5px);\n  right: 0;\n}\n.x-spreadsheet-dropdown.top-left .x-spreadsheet-dropdown-content {\n  bottom: calc(100% + 5px);\n  left: 0;\n}\n.x-spreadsheet-dropdown.top-right .x-spreadsheet-dropdown-content {\n  bottom: calc(100% + 5px);\n  right: 0;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-title {\n  padding: 0 5px;\n  display: inline-block;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-left {\n  margin-left: 4px;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right {\n  width: 10px;\n  margin-right: 4px;\n}\n.x-spreadsheet-dropdown .x-spreadsheet-dropdown-header .x-spreadsheet-icon.arrow-right .arrow-down {\n  left: -130px;\n}\n/* resizer **/\n.x-spreadsheet-resizer {\n  position: absolute;\n  z-index: 11;\n}\n.x-spreadsheet-resizer .x-spreadsheet-resizer-hover {\n  background-color: rgba(75, 137, 255, 0.25);\n}\n.x-spreadsheet-resizer .x-spreadsheet-resizer-line {\n  position: absolute;\n}\n.x-spreadsheet-resizer.horizontal {\n  cursor: row-resize;\n}\n.x-spreadsheet-resizer.horizontal .x-spreadsheet-resizer-line {\n  border-bottom: 2px dashed #4b89ff;\n  left: 0;\n  bottom: 0;\n}\n.x-spreadsheet-resizer.vertical {\n  cursor: col-resize;\n}\n.x-spreadsheet-resizer.vertical .x-spreadsheet-resizer-line {\n  border-right: 2px dashed #4b89ff;\n  top: 0;\n  right: 0;\n}\n/* scrollbar */\n.x-spreadsheet-scrollbar {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  background-color: #f4f5f8;\n  opacity: 0.9;\n  z-index: 12;\n}\n.x-spreadsheet-scrollbar.horizontal {\n  right: 15px;\n  overflow-x: scroll;\n  overflow-y: hidden;\n}\n.x-spreadsheet-scrollbar.horizontal > div {\n  height: 1px;\n  background: #ddd;\n}\n.x-spreadsheet-scrollbar.vertical {\n  bottom: 15px;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.x-spreadsheet-scrollbar.vertical > div {\n  width: 1px;\n  background: #ddd;\n}\n/* @{css-prefix}-overlayer */\n.x-spreadsheet-overlayer {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 10;\n}\n.x-spreadsheet-overlayer .x-spreadsheet-overlayer-content {\n  position: absolute;\n  overflow: hidden;\n  pointer-events: none;\n  width: 100%;\n  height: 100%;\n}\n.x-spreadsheet-editor,\n.x-spreadsheet-selector {\n  box-sizing: content-box;\n  position: absolute;\n  overflow: hidden;\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n/* @{css-prefix}-selector */\n.x-spreadsheet-selector .hide-input {\n  position: absolute;\n  z-index: 0;\n}\n.x-spreadsheet-selector .hide-input input {\n  padding: 0;\n  width: 0;\n  border: none!important;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-area {\n  position: absolute;\n  border: 2px solid #4b89ff;\n  background: rgba(75, 137, 255, 0.1);\n  z-index: 5;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-clipboard,\n.x-spreadsheet-selector .x-spreadsheet-selector-autofill {\n  position: absolute;\n  background: transparent;\n  z-index: 100;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-clipboard {\n  border: 2px dashed #4b89ff;\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-autofill {\n  border: 1px dashed rgba(0, 0, 0, 0.45);\n}\n.x-spreadsheet-selector .x-spreadsheet-selector-corner {\n  pointer-events: auto;\n  position: absolute;\n  cursor: crosshair;\n  font-size: 0;\n  height: 5px;\n  width: 5px;\n  right: -5px;\n  bottom: -5px;\n  border: 2px solid #ffffff;\n  background: #4b89ff;\n}\n.x-spreadsheet-editor {\n  z-index: 20;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area {\n  position: absolute;\n  text-align: left;\n  border: 2px solid #4b89ff;\n  line-height: 0;\n  z-index: 100;\n  pointer-events: auto;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area textarea {\n  box-sizing: content-box;\n  border: none;\n  padding: 0 3px;\n  outline: none;\n  resize: none;\n  text-align: start;\n  overflow-y: hidden;\n  font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;\n  color: inherit;\n  white-space: normal;\n  word-wrap: break-word;\n  line-height: 22px;\n  margin: 0;\n}\n.x-spreadsheet-editor .x-spreadsheet-editor-area .textline {\n  overflow: hidden;\n  visibility: hidden;\n  position: fixed;\n  top: 0;\n  left: 0;\n}\n.x-spreadsheet-item {\n  user-select: none;\n  background: 0;\n  border: 1px solid transparent;\n  outline: none;\n  height: 26px;\n  color: rgba(0, 0, 0, 0.9);\n  line-height: 26px;\n  list-style: none;\n  padding: 2px 10px;\n  cursor: default;\n  text-align: left;\n  overflow: hidden;\n}\n.x-spreadsheet-item.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-item:hover,\n.x-spreadsheet-item.active {\n  background: rgba(0, 0, 0, 0.05);\n}\n.x-spreadsheet-item.divider {\n  height: 0;\n  padding: 0;\n  margin: 5px 0;\n  border: none;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n}\n.x-spreadsheet-item .label {\n  float: right;\n  opacity: 0.65;\n  font-size: 1em;\n}\n.x-spreadsheet-item.state,\n.x-spreadsheet-header.state {\n  padding-left: 35px!important;\n  position: relative;\n}\n.x-spreadsheet-item.state:before,\n.x-spreadsheet-header.state:before {\n  content: '';\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  left: 12px;\n  top: calc(50% - 5px);\n  background: rgba(0, 0, 0, 0.08);\n  border-radius: 2px;\n}\n.x-spreadsheet-item.state.checked:before,\n.x-spreadsheet-header.state.checked:before {\n  background: #4b89ff;\n}\n.x-spreadsheet-checkbox {\n  position: relative;\n  display: inline-block;\n  backface-visibility: hidden;\n  outline: 0;\n  vertical-align: baseline;\n  font-style: normal;\n  font-size: 1rem;\n  line-height: 1em;\n}\n.x-spreadsheet-checkbox > input {\n  position: absolute;\n  top: 0;\n  left: 0;\n  opacity: 0!important;\n  outline: 0;\n  z-index: -1;\n}\n.x-spreadsheet-suggest,\n.x-spreadsheet-contextmenu,\n.x-spreadsheet-sort-filter {\n  position: absolute;\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\n  background: #fff;\n  z-index: 100;\n  width: 260px;\n  pointer-events: auto;\n  overflow: auto;\n}\n.x-spreadsheet-suggest {\n  width: 200px;\n}\n.x-spreadsheet-filter {\n  border: 1px solid #e9e9e9;\n  font-size: 12px;\n  margin: 10px;\n}\n.x-spreadsheet-filter .x-spreadsheet-header {\n  padding: 0.5em 0.75em;\n  background: #f8f8f9;\n  border-bottom: 1px solid #e9e9e9;\n  border-left: 1px solid transparent;\n}\n.x-spreadsheet-filter .x-spreadsheet-body {\n  height: 200px;\n  overflow-y: auto;\n}\n.x-spreadsheet-filter .x-spreadsheet-body .x-spreadsheet-item {\n  height: 20px;\n  line-height: 20px;\n}\n.x-spreadsheet-sort-filter .x-spreadsheet-buttons {\n  margin: 10px;\n}\n.x-spreadsheet-toolbar,\n.x-spreadsheet-bottombar {\n  height: 40px;\n  padding: 0 30px;\n  text-align: left;\n  background: #f5f6f7;\n  display: flex;\n}\n.x-spreadsheet-bottombar {\n  position: relative;\n  border-top: 1px solid #e0e2e4;\n}\n.x-spreadsheet-bottombar .x-spreadsheet-menu > li {\n  line-height: 40px;\n  height: 40px;\n  padding-top: 0;\n  padding-bottom: 0;\n  vertical-align: middle;\n  border-right: 1px solid #e8eaed;\n}\n.x-spreadsheet-menu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  user-select: none;\n}\n.x-spreadsheet-menu > li {\n  float: left;\n  line-height: 1.25em;\n  padding: 0.785em 1em;\n  margin: 0;\n  vertical-align: middle;\n  text-align: left;\n  font-weight: 400;\n  color: #80868b;\n  white-space: nowrap;\n  cursor: pointer;\n  transition: all 0.3s;\n  font-weight: bold;\n}\n.x-spreadsheet-menu > li.active {\n  background-color: #fff;\n  color: rgba(0, 0, 0, 0.65);\n}\n.x-spreadsheet-menu > li .x-spreadsheet-icon {\n  margin: 0 6px;\n}\n.x-spreadsheet-menu > li .x-spreadsheet-icon .x-spreadsheet-icon-img:hover {\n  opacity: 0.85;\n}\n.x-spreadsheet-menu > li .x-spreadsheet-dropdown {\n  display: inline-block;\n}\n.x-spreadsheet-toolbar {\n  border-bottom: 1px solid #e0e2e4;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btns {\n  display: inline-flex;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more {\n  padding: 0 6px 6px;\n  text-align: left;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-more .x-spreadsheet-toolbar-divider {\n  margin-top: 0;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn {\n  flex: 0 0 auto;\n  display: inline-block;\n  border: 1px solid transparent;\n  height: 26px;\n  line-height: 26px;\n  min-width: 26px;\n  margin: 6px 1px 0;\n  padding: 0;\n  text-align: center;\n  border-radius: 2px;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn:hover,\n.x-spreadsheet-toolbar .x-spreadsheet-toolbar-btn.active {\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-toolbar-divider {\n  display: inline-block;\n  border-right: 1px solid #e0e2e4;\n  width: 0;\n  vertical-align: middle;\n  height: 18px;\n  margin: 12px 3px 0;\n}\n.x-spreadsheet-print {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 100;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.x-spreadsheet-print-bar {\n  background: #424242;\n  height: 60px;\n  line-height: 60px;\n  padding: 0 30px;\n}\n.x-spreadsheet-print-bar .-title {\n  color: #fff;\n  font-weight: bold;\n  font-size: 1.2em;\n  float: left;\n}\n.x-spreadsheet-print-bar .-right {\n  float: right;\n  margin-top: 12px;\n}\n.x-spreadsheet-print-content {\n  display: flex;\n  flex: auto;\n  flex-direction: row;\n  background: #d0d0d0;\n  height: calc(100% - 60px);\n}\n.x-spreadsheet-print-content .-sider {\n  flex: 0 0 300px;\n  width: 300px;\n  border-left: 2px solid #ccc;\n  background: #fff;\n}\n.x-spreadsheet-print-content .-content {\n  flex: auto;\n  overflow-x: auto;\n  overflow-y: scroll;\n  height: 100%;\n}\n.x-spreadsheet-canvas-card-wraper {\n  margin: 40px 20px;\n}\n.x-spreadsheet-canvas-card {\n  background: #fff;\n  margin: auto;\n  page-break-before: auto;\n  page-break-after: always;\n  box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 3px rgba(0, 0, 0, 0.12), 0 4px 5px 0 rgba(0, 0, 0, 0.2);\n}\n.x-spreadsheet-calendar {\n  color: rgba(0, 0, 0, 0.65);\n  background: #ffffff;\n  user-select: none;\n}\n.x-spreadsheet-calendar .calendar-header {\n  font-weight: 700;\n  line-height: 30px;\n  text-align: center;\n  width: 100%;\n  float: left;\n  background: #f9fafb;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-left {\n  padding-left: 5px;\n  float: left;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right {\n  float: right;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right a {\n  padding: 3px 0;\n  margin-right: 2px;\n  border-radius: 2px;\n}\n.x-spreadsheet-calendar .calendar-header .calendar-header-right a:hover {\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-calendar .calendar-body {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\n.x-spreadsheet-calendar .calendar-body th,\n.x-spreadsheet-calendar .calendar-body td {\n  width: 100%/7;\n  min-width: 32px;\n  text-align: center;\n  font-weight: 700;\n  line-height: 30px;\n  padding: 0;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell:hover {\n  background: #ecf6fd;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell.active,\n.x-spreadsheet-calendar .calendar-body td > .cell.active:hover {\n  background: #ecf6fd;\n  color: #2185D0;\n}\n.x-spreadsheet-calendar .calendar-body td > .cell.disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n.x-spreadsheet-datepicker {\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);\n  position: absolute;\n  left: 0;\n  top: calc(100% + 5px);\n  z-index: 10;\n  width: auto;\n}\n.x-spreadsheet-buttons {\n  display: flex;\n  justify-content: flex-end;\n}\n.x-spreadsheet-buttons .x-spreadsheet-button {\n  margin-left: 8px;\n}\n.x-spreadsheet-button {\n  display: inline-block;\n  border-radius: 3px;\n  line-height: 1em;\n  min-height: 1em;\n  white-space: nowrap;\n  text-align: center;\n  cursor: pointer;\n  font-size: 1em;\n  font-weight: 700;\n  padding: 0.75em 1em;\n  color: rgba(0, 0, 0, 0.6);\n  background: #E0E1E2;\n  text-decoration: none;\n  font-family: \"Lato\", \"proxima-nova\", \"Helvetica Neue\", Arial, sans-serif;\n  outline: none;\n  vertical-align: baseline;\n  zoom: 1;\n  user-select: none;\n  transition: all 0.1s linear;\n}\n.x-spreadsheet-button.active,\n.x-spreadsheet-button:hover {\n  background-color: #C0C1C2;\n  color: rgba(0, 0, 0, 0.8);\n}\n.x-spreadsheet-button.primary {\n  color: #fff;\n  background-color: #2185D0;\n}\n.x-spreadsheet-button.primary:hover,\n.x-spreadsheet-button.primary.active {\n  color: #fff;\n  background-color: #1678c2;\n}\n.x-spreadsheet-form-input {\n  font-size: 1em;\n  position: relative;\n  font-weight: 400;\n  display: inline-flex;\n  color: rgba(0, 0, 0, 0.87);\n}\n.x-spreadsheet-form-input input {\n  z-index: 1;\n  margin: 0;\n  max-width: 100%;\n  flex: 1 0 auto;\n  outline: 0;\n  -webkit-tap-highlight-color: rgba(255, 255, 255, 0);\n  text-align: left;\n  line-height: 30px;\n  height: 30px;\n  padding: 0 8px;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 3px;\n  transition: box-shadow 0.1s ease, border-color 0.1s ease;\n  box-shadow: inset 0 1px 2px hsla(0, 0%, 4%, 0.06);\n}\n.x-spreadsheet-form-input input:focus {\n  border-color: #4b89ff;\n  box-shadow: inset 0 1px 2px rgba(75, 137, 255, 0.2);\n}\n.x-spreadsheet-form-select {\n  position: relative;\n  display: inline-block;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 2px;\n  cursor: pointer;\n  color: rgba(0, 0, 0, 0.87);\n  user-select: none;\n  box-shadow: inset 0 1px 2px hsla(0, 0%, 4%, 0.06);\n}\n.x-spreadsheet-form-select .input-text {\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  min-width: 60px;\n  width: auto;\n  height: 30px;\n  line-height: 30px;\n  padding: 0 8px;\n}\n.x-spreadsheet-form-fields {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n.x-spreadsheet-form-fields .x-spreadsheet-form-field {\n  flex: 0 1 auto;\n}\n.x-spreadsheet-form-fields .x-spreadsheet-form-field .label {\n  display: inline-block;\n  margin: 0 10px 0 0;\n}\n.x-spreadsheet-form-field {\n  display: block;\n  vertical-align: middle;\n  margin-left: 10px;\n  margin-bottom: 10px;\n}\n.x-spreadsheet-form-field:first-child {\n  margin-left: 0;\n}\n.x-spreadsheet-form-field.error .x-spreadsheet-form-select,\n.x-spreadsheet-form-field.error input {\n  border-color: #f04134;\n}\n.x-spreadsheet-form-field .tip {\n  color: #f04134;\n  font-size: 0.9em;\n}\n.x-spreadsheet-dimmer {\n  display: none;\n  position: absolute;\n  top: 0 !important;\n  left: 0 !important;\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  vertical-align: middle;\n  background-color: rgba(0, 0, 0, 0.6);\n  opacity: 0;\n  -webkit-animation-fill-mode: both;\n  animation-fill-mode: both;\n  -webkit-animation-duration: 0.5s;\n  animation-duration: 0.5s;\n  transition: background-color 0.5s linear;\n  user-select: none;\n  z-index: 1000;\n}\n.x-spreadsheet-dimmer.active {\n  display: block;\n  opacity: 1;\n}\nform fieldset {\n  border: none;\n}\nform fieldset label {\n  display: block;\n  margin-bottom: 0.5em;\n  font-size: 1em;\n  color: #666;\n}\nform fieldset select {\n  font-size: 1.1em;\n  width: 100%;\n  background-color: #fff;\n  border: none;\n  border-bottom: 2px solid #ddd;\n  padding: 0.5em 0.85em;\n  border-radius: 2px;\n}\n.x-spreadsheet-modal,\n.x-spreadsheet-toast {\n  font-size: 13px;\n  position: fixed;\n  z-index: 1001;\n  text-align: left;\n  line-height: 1.25em;\n  min-width: 360px;\n  color: rgba(0, 0, 0, 0.87);\n  font-family: 'Lato', 'Source Sans Pro', Roboto, Helvetica, Arial, sans-serif;\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  background-color: #fff;\n  background-clip: padding-box;\n  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 8px;\n}\n.x-spreadsheet-toast {\n  background-color: rgba(255, 255, 255, 0.85);\n}\n.x-spreadsheet-modal-header,\n.x-spreadsheet-toast-header {\n  font-weight: 600;\n  background-clip: padding-box;\n  background-color: rgba(255, 255, 255, 0.85);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n  border-radius: 4px 4px 0 0;\n}\n.x-spreadsheet-modal-header .x-spreadsheet-icon,\n.x-spreadsheet-toast-header .x-spreadsheet-icon {\n  position: absolute;\n  right: 0.8em;\n  top: 0.65em;\n  border-radius: 18px;\n}\n.x-spreadsheet-modal-header .x-spreadsheet-icon:hover,\n.x-spreadsheet-toast-header .x-spreadsheet-icon:hover {\n  opacity: 1;\n  background: rgba(0, 0, 0, 0.08);\n}\n.x-spreadsheet-toast-header {\n  color: #F2711C;\n}\n.x-spreadsheet-modal-header {\n  border-bottom: 1px solid #e0e2e4;\n  background: rgba(0, 0, 0, 0.08);\n  font-size: 1.0785em;\n}\n.x-spreadsheet-modal-header,\n.x-spreadsheet-modal-content,\n.x-spreadsheet-toast-header,\n.x-spreadsheet-toast-content {\n  padding: 0.75em 1em;\n}\n@media screen and (min-width: 320px) and (max-width: 480px) {\n  .x-spreadsheet-toolbar {\n    display: none;\n  }\n}\n.x-spreadsheet-icon {\n  width: 18px;\n  height: 18px;\n  margin: 1px 1px 2px 1px;\n  text-align: center;\n  vertical-align: middle;\n  user-select: none;\n  overflow: hidden;\n  position: relative;\n  display: inline-block;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img {\n  background-image: url("+l+");\n  position: absolute;\n  width: 262px;\n  height: 444px;\n  opacity: 0.56;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.undo {\n  left: 0;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.redo {\n  left: -18px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.print {\n  left: -36px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.paintformat {\n  left: -54px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.clearformat {\n  left: -72px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.font-bold {\n  left: -90px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.font-italic {\n  left: -108px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.underline {\n  left: -126px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.strike {\n  left: -144px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.color {\n  left: -162px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.bgcolor {\n  left: -180px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.merge {\n  left: -198px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-left {\n  left: -216px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-center {\n  left: -234px;\n  top: 0;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-right {\n  left: 0;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-top {\n  left: -18px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-middle {\n  left: -36px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.align-bottom {\n  left: -54px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.textwrap {\n  left: -72px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.autofilter {\n  left: -90px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.formula {\n  left: -108px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-down {\n  left: -126px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.arrow-right {\n  left: -144px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.link {\n  left: -162px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chart {\n  left: -180px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.freeze {\n  left: -198px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.ellipsis {\n  left: -216px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.add {\n  left: -234px;\n  top: -18px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-all {\n  left: 0;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-inside {\n  left: -18px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-horizontal {\n  left: -36px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-vertical {\n  left: -54px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-outside {\n  left: -72px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-left {\n  left: -90px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-top {\n  left: -108px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-right {\n  left: -126px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-bottom {\n  left: -144px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.border-none {\n  left: -162px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.line-color {\n  left: -180px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.line-type {\n  left: -198px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.close {\n  left: -234px;\n  top: -36px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-down {\n  left: 0;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-up {\n  left: -18px;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-left {\n  left: -36px;\n  top: -54px;\n}\n.x-spreadsheet-icon .x-spreadsheet-icon-img.chevron-right {\n  left: -54px;\n  top: -54px;\n}\n",""]),e.exports=t},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",s=e[3];if(!s)return i;if(t&&"function"==typeof btoa){var n=(l=s,o=btoa(unescape(encodeURIComponent(JSON.stringify(l)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(a," */")),r=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[i].concat(r).concat([n]).join("\n")}var l,o,a;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,s){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(s)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(n[l]=!0)}for(var o=0;o<e.length;o++){var a=[].concat(e[o]);s&&n[a[0]]||(i&&(a[2]?a[2]="".concat(i," and ").concat(a[2]):a[2]=i),t.push(a))}},t}},417:e=>{"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},72:e=>{"use strict";var t=[];function i(e){for(var i=-1,s=0;s<t.length;s++)if(t[s].identifier===e){i=s;break}return i}function s(e,s){for(var r={},l=[],o=0;o<e.length;o++){var a=e[o],h=s.base?a[0]+s.base:a[0],c=r[h]||0,d="".concat(h," ").concat(c);r[h]=c+1;var g=i(d),u={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==g)t[g].references++,t[g].updater(u);else{var w=n(u,s);s.byIndex=o,t.splice(o,0,{identifier:d,updater:w,references:1})}l.push(d)}return l}function n(e,t){var i=t.domAPI(t);i.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var r=s(e=e||[],n=n||{});return function(e){e=e||[];for(var l=0;l<r.length;l++){var o=i(r[l]);t[o].references--}for(var a=s(e,n),h=0;h<r.length;h++){var c=i(r[h]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}r=a}}},659:e=>{"use strict";var t={};e.exports=function(e,i){var s=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,n&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var r=i.sourceMap;r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},164:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});const s="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjYycHgiIGhlaWdodD0iNzJweCIgdmlld0JveD0iMCAwIDI2MiA3MiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwwKSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTEuNTY1NjM5MSw0LjQzNDM2MDg4IEw5LDcgTDE2LDcgTDE2LDAgTDEzLjA0MTg0MjQsMi45NTgxNTc1OCBDMTEuNTkzNjc4NywxLjczNjM1OTU5IDkuNzIyNjA3NzUsMSA3LjY3OTU1MDgzLDEgQzQuMjIxMjYyNTgsMSAxLjI1NTc1NTk5LDMuMTA5ODQ5MDggMCw2IEwyLDcgQzIuOTM2NTg3NzUsNC42MDk3NDQwNiA1LjEyOTQzNjk3LDMuMDgwMTEyMjkgNy42Nzk1NTA4MywzIEM5LjE0ODgxMjQ3LDMuMDUyODc0NyAxMC40OTk0NzgzLDMuNTc4NjIwNTMgMTEuNTY1NjM5MSw0LjQzNDM2MDg4IFoiIHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDE3IDUpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOCwwKSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTEuNTY1NjM5MSw0LjQzNDM2MDg4IEw5LDcgTDE2LDcgTDE2LDAgTDEzLjA0MTg0MjQsMi45NTgxNTc1OCBDMTEuNTkzNjc4NywxLjczNjM1OTU5IDkuNzIyNjA3NzUsMSA3LjY3OTU1MDgzLDEgQzQuMjIxMjYyNTgsMSAxLjI1NTc1NTk5LDMuMTA5ODQ5MDggMCw2IEwyLDcgQzIuOTM2NTg3NzUsNC42MDk3NDQwNiA1LjEyOTQzNjk3LDMuMDgwMTEyMjkgNy42Nzk1NTA4MywzIEM5LjE0ODgxMjQ3LDMuMDUyODc0NyAxMC40OTk0NzgzLDMuNTc4NjIwNTMgMTEuNTY1NjM5MSw0LjQzNDM2MDg4IFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEgNSkiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDApIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMywxNCBMMywxNCBMMywxMSBMMCwxMSBMMCw2LjAwNTkxOTA1IEMwLDQuODk4MDgwNTUgMC44OTQ1MTM3NTYsNCAxLjk5NDA2MDI4LDQgTDE0LjAwNTkzOTcsNCBDMTUuMTA3MjI4OCw0IDE2LDQuODg2NTU0ODQgMTYsNi4wMDU5MTkwNSBMMTYsMTEgTDEzLDExIEwxMywxNCBaIE01LDkgTDExLDkgTDExLDEyIEw1LDEyIEw1LDkgWiBNMywwIEwxMywwIEwxMywzIEwzLDMgTDMsMCBaIE0xMiw2IEwxNCw2IEwxNCw4IEwxMiw4IEwxMiw2IFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEgMikiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0LDApIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05LDAgTDEsMCBDMC40NSwwIDAsMC40NSAwLDEgTDAsNCBDMCw0LjU1IDAuNDUsNSAxLDUgTDksNSBDOS41NSw1IDEwLDQuNTUgMTAsNCBMMTAsMyBMMTEsMyBMMTEsNiBMNCw2IEw0LDE0IEw2LDE0IEw2LDggTDEzLDggTDEzLDIgTDEwLDIgTDEwLDEgQzEwLDAuNDUgOS41NSwwIDksMCBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDIpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MiwwKSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMC4yNywxLjU1IEw1LjQzLDYuNyBMMywxMiBMNS41LDEyIEw3LjE0LDguNDIgTDExLjczLDEzIEwxMywxMS43MyBMMS41NSwwLjI3IEwwLjI3LDEuNTUgTDAuMjcsMS41NSBaIE0zLjgyLDAgTDUuODIsMiBMNy41OCwyIEw3LjAzLDMuMjEgTDguNzQsNC45MiBMMTAuMDgsMiBMMTQsMiBMMTQsMCBMMy44MiwwIEwzLjgyLDAgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAzKSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTAsMCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTksMy41IEM5LDEuNTcgNy40MywwIDUuNSwwIEwxLjc3NjM1Njg0ZS0xNSwwIEwxLjc3NjM1Njg0ZS0xNSwxMiBMNi4yNSwxMiBDOC4wNCwxMiA5LjUsMTAuNTQgOS41LDguNzUgQzkuNSw3LjQ1IDguNzMsNi4zNCA3LjYzLDUuODIgQzguNDYsNS4yNCA5LDQuMzggOSwzLjUgWiBNNSwyIEM1LjgyOTk5OTkyLDIgNi41LDIuNjcgNi41LDMuNSBDNi41LDQuMzMgNS44Mjk5OTk5Miw1IDUsNSBMMyw1IEwzLDIgTDUsMiBaIE0zLDEwIEwzLDcgTDUuNSw3IEM2LjMyOTk5OTkyLDcgNyw3LjY3IDcsOC41IEM3LDkuMzMgNi4zMjk5OTk5MiwxMCA1LjUsMTAgTDMsMTAgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNCAzKSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA4LDApIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHBvaW50cz0iNCAwIDQgMiA2LjU4IDIgMi45MiAxMCAwIDEwIDAgMTIgOCAxMiA4IDEwIDUuNDIgMTAgOS4wOCAyIDEyIDIgMTIgMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMyAzKSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTI2LDApIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNNiwxMiBDOC43NiwxMiAxMSw5Ljc2IDExLDcgTDExLDAgTDksMCBMOSw3IEM5LDguNzUwMjk5MTYgNy40OTkxMjgwNywxMCA2LDEwIEM0LjUwMDg3MTkzLDEwIDMsOC43NTgzNzQ4NiAzLDcgTDMsMCBMMSwwIEwxLDcgQzEsOS43NiAzLjI0LDEyIDYsMTIgWiBNMCwxMyBMMCwxNSBMMTIsMTUgTDEyLDEzIEwwLDEzIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0NCwwKSI+PHBhdGggZmlsbD0iIzAxMDEwMSIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMi44ODc1LDMuMDYgQzIuODg3NSwyLjYwMjUgMi45ODUsMi4xODYyNSAzLjE4Mzc1LDEuODA3NSBDMy4zODI1LDEuNDI4NzUgMy42NiwxLjEwNjI1IDQuMDIsMC44NCBDNC4zOCwwLjU3Mzc1IDQuODAzNzUsMC4zNjc1IDUuMjk4NzUsMC4yMjEyNSBDNS43OTM3NSwwLjA3NSA2LjMzMzc1LDAgNi45MjYyNSwwIEM3LjUzMzc1LDAgOC4wODUsMC4wODI1IDguNTgsMC4yNTEyNSBDOS4wNzUsMC40MiA5LjQ5ODc1LDAuNjUyNSA5Ljg1MTI1LDAuOTU2MjUgQzEwLjIwMzc1LDEuMjU2MjUgMTAuNDczNzUsMS42MTI1IDEwLjY2NSwyLjAyODc1IEMxMC44NTYyNSwyLjQ0MTI1IDEwLjk1LDIuODk1IDEwLjk1LDMuMzg2MjUgTDguNjkyNSwzLjM4NjI1IEM4LjY5MjUsMy4xNTc1IDguNjU1LDIuOTQzNzUgOC41ODM3NSwyLjc0ODc1IEM4LjUxMjUsMi41NSA4LjQsMi4zODEyNSA4LjI1LDIuMjQyNSBDOC4xLDIuMTAzNzUgNy45MTI1LDEuOTkxMjUgNy42ODc1LDEuOTE2MjUgQzcuNDYyNSwxLjgzNzUgNy4xOTYyNSwxLjggNi44ODg3NSwxLjggQzYuNTkyNSwxLjggNi4zMzc1LDEuODMzNzUgNi4xMTYyNSwxLjg5NzUgQzUuODk4NzUsMS45NjEyNSA1LjcxODc1LDIuMDUxMjUgNS41NzYyNSwyLjE2NzUgQzUuNDMzNzUsMi4yODM3NSA1LjMyNSwyLjQxODc1IDUuMjUzNzUsMi41NzI1IEM1LjE4MjUsMi43MjYyNSA1LjE0NSwyLjg5NSA1LjE0NSwzLjA2NzUgQzUuMTQ1LDMuNDI3NSA1LjMyODc1LDMuNzMxMjUgNS42OTYyNSwzLjk3NSBDNS43MTc4MDIwMywzLjk4OTA4MDY2IDUuNzM5NDIwMTIsNC4wMDMxMTcyOCA1Ljc2MTE4MzU3LDQuMDE3MzMzMTUgQzYuMDIzNDI5MjMsNC4xODg2MzE4NSA2LjUsNC41IDcsNSBMNCw1IEM0LDUgMy4yMTM3NSw0LjM3NjI1IDMuMTc2MjUsNC4zMDg3NSBDMi45ODUsMy45NTI1IDIuODg3NSwzLjUzNjI1IDIuODg3NSwzLjA2IFogTTE0LDYgTDAsNiBMMCw4IEw3LjIxODc1LDggQzcuMzUzNzUsOC4wNTI1IDcuNTE4NzUsOC4xMDUgNy42MzEyNSw4LjE1Mzc1IEM3LjkwODc1LDguMjc3NSA4LjEyNjI1LDguNDA4NzUgOC4yODM3NSw4LjUzNjI1IEM4LjQ0MTI1LDguNjY3NSA4LjU0NjI1LDguODEgOC42MDI1LDguOTYgQzguNjU4NzUsOS4xMTM3NSA4LjY4NSw5LjI4NjI1IDguNjg1LDkuNDczNzUgQzguNjg1LDkuNjUgOC42NTEyNSw5LjgxNSA4LjU4Mzc1LDkuOTY1IEM4LjUxNjI1LDEwLjExODc1IDguNDExMjUsMTAuMjUgOC4yNzI1LDEwLjM1ODc1IEM4LjEzMzc1LDEwLjQ2NzUgNy45NTM3NSwxMC41NTM3NSA3Ljc0LDEwLjYxNzUgQzcuNTIyNSwxMC42ODEyNSA3LjI3MTI1LDEwLjcxMTI1IDYuOTc4NzUsMTAuNzExMjUgQzYuNjUyNSwxMC43MTEyNSA2LjM1NjI1LDEwLjY3NzUgNi4wOSwxMC42MTM3NSBDNS44MjM3NSwxMC41NSA1LjU5ODc1LDEwLjQ0NSA1LjQxMTI1LDEwLjMwMjUgQzUuMjIzNzUsMTAuMTYgNS4wNzc1LDkuOTcyNSA0Ljk3MjUsOS43NDM3NSBDNC44Njc1LDkuNTE1IDQuNzgxMjUsOS4xNyA0Ljc4MTI1LDkgTDIuNTUsOSBDMi41NSw5LjI1MjUgMi42MSw5LjY4NzUgMi43MjYyNSwxMC4wMjUgQzIuODQyNSwxMC4zNjI1IDMuMDA3NSwxMC42NjYyNSAzLjIxMzc1LDEwLjkzMjUgQzMuNDIsMTEuMTk4NzUgMy42Njc1LDExLjQyNzUgMy45NDg3NSwxMS42MjI1IEM0LjIzLDExLjgxNzUgNC41MzM3NSwxMS45ODI1IDQuODYzNzUsMTIuMTEgQzUuMTkzNzUsMTIuMjQxMjUgNS41MzUsMTIuMzM4NzUgNS44OTg3NSwxMi4zOTg3NSBDNi4yNTg3NSwxMi40NjI1IDYuNjIyNSwxMi40OTI1IDYuOTgyNSwxMi40OTI1IEM3LjU4MjUsMTIuNDkyNSA4LjEzLDEyLjQyNSA4LjYxNzUsMTIuMjg2MjUgQzkuMTA1LDEyLjE0NzUgOS41MjUsMTEuOTQ4NzUgOS44NywxMS42OTM3NSBDMTAuMjE1LDExLjQzNSAxMC40ODEyNSwxMS4xMiAxMC42NzI1LDEwLjc0MTI1IEMxMC44NjM3NSwxMC4zNjI1IDEwLjk1Mzc1LDkuOTM1IDEwLjk1Mzc1LDkuNDU1IEMxMC45NTM3NSw5LjAwNSAxMC44NzUsOC42IDEwLjcyMTI1LDguMjQzNzUgQzEwLjY4Mzc1LDguMTU3NSAxMC42NDI1LDguMDc1IDEwLjU5Mzc1LDcuOTkyNSBMMTQsOCBMMTQsNiBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDMpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjIsMCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTcsMCBMNSwwIEwwLjUsMTIgTDIuNSwxMiBMMy42Miw5IEw4LjM3LDkgTDkuNDksMTIgTDExLjQ5LDEyIEw3LDAgTDcsMCBaIE00LjM4LDcgTDYsMi42NyBMNy42Miw3IEw0LjM4LDcgTDQuMzgsNyBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDEpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODAsMCkiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICA8cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNMTQuNSw4Ljg3IEMxNC41LDguODcgMTMsMTAuNDkgMTMsMTEuNDkgQzEzLDEyLjMyIDEzLjY3LDEyLjk5IDE0LjUsMTIuOTkgQzE1LjMzLDEyLjk5IDE2LDEyLjMyIDE2LDExLjQ5IEMxNiwxMC41IDE0LjUsOC44NyAxNC41LDguODcgTDE0LjUsOC44NyBaIE0xMi43MSw2Ljc5IEw1LjkxLDAgTDQuODUsMS4wNiBMNi40NCwyLjY1IEwyLjI5LDYuNzkgQzEuOSw3LjE4IDEuOSw3LjgxIDIuMjksOC4yIEw2Ljc5LDEyLjcgQzYuOTksMTIuOSA3LjI0LDEzIDcuNSwxMyBDNy43NiwxMyA4LjAxLDEyLjkgOC4yMSwxMi43MSBMMTIuNzEsOC4yMSBDMTMuMSw3LjgyIDEzLjEsNy4xOCAxMi43MSw2Ljc5IEwxMi43MSw2Ljc5IFogTTQuMjEsNyBMNy41LDMuNzEgTDEwLjc5LDcgTDQuMjEsNyBMNC4yMSw3IFoiLz4KICA8L2c+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTgsMCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTMsNiBMMSw2IEwxLDIgTDgsMiBMOCw0IEwzLDQgTDMsNiBaIE0xMCw0IEwxMCwyIEwxNywyIEwxNyw2IEwxNSw2IEwxNSw0IEwxMCw0IFogTTEwLDE0IEwxNSwxNCBMMTUsMTIgTDE3LDEyIEwxNywxNiBMMTAsMTYgTDEwLDE0IFogTTEsMTIgTDMsMTIgTDMsMTQgTDgsMTQgTDgsMTYgTDEsMTYgTDEsMTIgWiBNMSw4IEw1LDggTDUsNiBMOCw5IEw1LDEyIEw1LDEwIEwxLDEwIEwxLDggWiBNMTAsOSBMMTMsNiBMMTMsOCBMMTcsOCBMMTcsMTAgTDEzLDEwIEwxMywxMiBMMTAsOSBaIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTYsMCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTAsMTQgTDEwLDE0IEwxMCwxMiBMMCwxMiBMMCwxNCBaIE0xMCw0IEwwLDQgTDAsNiBMMTAsNiBMMTAsNCBaIE0wLDAgTDAsMiBMMTQsMiBMMTQsMCBMMCwwIFogTTAsMTAgTDE0LDEwIEwxNCw4IEwwLDggTDAsMTAgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAyKSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjM0LDApIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yLDEyIEwyLDE0IEwxMiwxNCBMMTIsMTIgTDIsMTIgWiBNMiw0IEwyLDYgTDEyLDYgTDEyLDQgTDIsNCBaIE0wLDEwIEwxNCwxMCBMMTQsOCBMMCw4IEwwLDEwIFogTTAsMCBMMCwyIEwxNCwyIEwxNCwwIEwwLDAgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAyKSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwxOCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTQsMTQgTDE0LDE0IEwxNCwxMiBMNCwxMiBMNCwxNCBaIE0wLDEwIEwxNCwxMCBMMTQsOCBMMCw4IEwwLDEwIFogTTAsMCBMMCwyIEwxNCwyIEwxNCwwIEwwLDAgWiBNNCw2IEwxNCw2IEwxNCw0IEw0LDQgTDQsNiBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOCwxOCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTAsMCBMMCwyIEwxMiwyIEwxMiwwIEwwLDAgTDAsMCBaIE0yLjUsNyBMNSw3IEw1LDE0IEw3LDE0IEw3LDcgTDkuNSw3IEw2LDMuNSBMMi41LDcgTDIuNSw3IFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMikiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDE4KSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOS41LDMgTDcsMyBMNywwIEw1LDAgTDUsMyBMMi41LDMgTDYsNi41IEw5LjUsMyBMOS41LDMgWiBNMCw4IEwwLDEwIEwxMiwxMCBMMTIsOCBMMCw4IEwwLDggWiBNMi41LDE1IEw1LDE1IEw1LDE4IEw3LDE4IEw3LDE1IEw5LjUsMTUgTDYsMTEuNSBMMi41LDE1IEwyLjUsMTUgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMykiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0LDE4KSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOS41LDcgTDcsNyBMNywwIEw1LDAgTDUsNyBMMi41LDcgTDYsMTAuNSBMOS41LDcgTDkuNSw3IFogTTAsMTIgTDAsMTQgTDEyLDE0IEwxMiwxMiBMMCwxMiBMMCwxMiBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDIpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MiwxOCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE0LDAgTDAsMCBMMCwyIEwxNCwyIEwxNCwwIFogTTAsMTIgTDQsMTIgTDQsMTAgTDAsMTAgTDAsMTIgWiBNMTEuNSw1IEwwLDUgTDAsNyBMMTEuNzUsNyBDMTIuNTgsNyAxMy4yNSw3LjY3IDEzLjI1LDguNSBDMTMuMjUsOS4zMyAxMi41OCwxMCAxMS43NSwxMCBMOSwxMCBMOSw4IEw2LDExIEw5LDE0IEw5LDEyIEwxMS41LDEyIEMxMy40MywxMiAxNSwxMC40MyAxNSw4LjUgQzE1LDYuNTcgMTMuNDMsNSAxMS41LDUgWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAzKSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTAsMTgpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLDAgTDAsMSBMNiw3IEw2LDEyIEw4LDExIEw4LDcgTDE0LDEgTDE0LDAgTDAsMCBaIE00LDMgTDEwLDMgTDcsNiBMNCwzIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMykiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwOCwxOCkiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgcG9pbnRzPSIxMCAwIDAgMCAwIDEuOCA1LjUgNyAwIDEyLjIgMCAxNCAxMCAxNCAxMCAxMiAzLjEgMTIgOCA3IDMuMSAyIDEwIDIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQgMikiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyNiwxOCkiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgcG9pbnRzPSIwIDAgNCA0IDggMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNSA3KSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQ0LDE4KSI+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9Ii0yIDIgMiA2IDYgMiIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDggMykiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MiwxOCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTEuOSw0IEMxLjksMi44NCAyLjg0LDEuOSA0LDEuOSBMOCwxLjkgTDgsMCBMNCwwIEMxLjc5LDAgMCwxLjc5IDAsNCBDMCw2LjIxIDEuNzksOCA0LDggTDgsOCBMOCw2LjEgTDQsNi4xIEMyLjg0LDYuMSAxLjksNS4xNiAxLjksNCBMMS45LDQgWiBNMTQsMCBMMTAsMCBMMTAsMS45IEwxNCwxLjkgQzE1LjE2LDEuOSAxNi4xLDIuODQgMTYuMSw0IEMxNi4xLDUuMTYgMTUuMTYsNi4xIDE0LDYuMSBMMTAsNi4xIEwxMCw4IEwxNCw4IEMxNi4yMSw4IDE4LDYuMjEgMTgsNCBDMTgsMS43OSAxNi4yMSwwIDE0LDAgTDE0LDAgWiBNNiw1IEwxMiw1IEwxMiwzIEw2LDMgTDYsNSBMNiw1IFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgNSkiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MCwxOCkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE1LDAgQzE1LjU1LDAgMTYsMC40NSAxNiwxIEwxNiwxNSBDMTYsMTUuNTUgMTUuNTUsMTYgMTUsMTYgTDEsMTYgQzAuNDUsMTYgMCwxNS41NSAwLDE1IEwwLDEgQzAsMC40NSAwLjQ1LDAgMSwwIEwxNSwwIFogTTIsMiBMMiwxNCBMMTQsMTQgTDE0LDIgTDIsMiBaIE02LDEyIEw0LDEyIEw0LDcgTDYsNyBMNiwxMiBMNiwxMiBaIE05LDEyIEw3LDEyIEw3LDQgTDksNCBMOSwxMiBMOSwxMiBaIE0xMiwxMiBMMTAsMTIgTDEwLDggTDEyLDggTDEyLDEyIEwxMiwxMiBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTgsMTgpIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgPHBhdGggc3Ryb2tlPSIjMDAwMDAwIiBkPSJNMS41IDMuNUgxNi41VjE1LjVIMS41eiIvPgogICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTYgOEg3VjE1SDZ6Ii8+CiAgICA8cGF0aCBmaWxsPSIjRDhEOEQ4IiBkPSJNMiA0SDE2VjdIMnoiLz4KICAgIDxwYXRoIGZpbGw9IiMwMDAwMDAiIGQ9Ik0yIDdIMTZWOEgyek0yIDExSDE2VjEySDJ6Ii8+CiAgPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE2LDE4KSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMiwwLjUgQzEuMTcsMC41IDAuNSwxLjE3IDAuNSwyIEMwLjUsMi44MyAxLjE3LDMuNSAyLDMuNSBDMi44MywzLjUgMy41LDIuODMgMy41LDIgQzMuNSwxLjE3IDIuODMsMC41IDIsMC41IEwyLDAuNSBaIE0xMiwwLjUgQzExLjE3LDAuNSAxMC41LDEuMTcgMTAuNSwyIEMxMC41LDIuODMgMTEuMTcsMy41IDEyLDMuNSBDMTIuODMsMy41IDEzLjUsMi44MyAxMy41LDIgQzEzLjUsMS4xNyAxMi44MywwLjUgMTIsMC41IEwxMiwwLjUgWiBNNywwLjUgQzYuMTcsMC41IDUuNSwxLjE3IDUuNSwyIEM1LjUsMi44MyA2LjE3LDMuNSA3LDMuNSBDNy44MywzLjUgOC41LDIuODMgOC41LDIgQzguNSwxLjE3IDcuODMsMC41IDcsMC41IEw3LDAuNSBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDcpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMzQsMTgpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LDQgTDYsMCBMNCwwIEw0LDQgTDAsNCBMMCw2IEw0LDYgTDQsMTAgTDYsMTAgTDYsNiBMMTAsNiBMMTAsNCBMNiw0IFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsMzYpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLDAgTDAsMTQgTDE0LDE0IEwxNCwwIEwwLDAgTDAsMCBaIE02LDEyIEwyLDEyIEwyLDggTDYsOCBMNiwxMiBMNiwxMiBaIE02LDYgTDIsNiBMMiwyIEw2LDIgTDYsNiBMNiw2IFogTTEyLDEyIEw4LDEyIEw4LDggTDEyLDggTDEyLDEyIEwxMiwxMiBaIE0xMiw2IEw4LDYgTDgsMiBMMTIsMiBMMTIsNiBMMTIsNiBaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOCwzNikiPgogIDxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAyKSI+CiAgICA8cGF0aCBkPSJNMCwxNCBMMiwxNCBMMiwxMiBMMCwxMiBMMCwxNCBMMCwxNCBaIE0yLDMgTDAsMyBMMCw1IEwyLDUgTDIsMyBMMiwzIFogTTMsMTQgTDUsMTQgTDUsMTIgTDMsMTIgTDMsMTQgTDMsMTQgWiBNMTEsMCBMOSwwIEw5LDIgTDExLDIgTDExLDAgTDExLDAgWiBNMiwwIEwwLDAgTDAsMiBMMiwyIEwyLDAgTDIsMCBaIE01LDAgTDMsMCBMMywyIEw1LDIgTDUsMCBMNSwwIFogTTAsMTEgTDIsMTEgTDIsOSBMMCw5IEwwLDExIEwwLDExIFogTTksMTQgTDExLDE0IEwxMSwxMiBMOSwxMiBMOSwxNCBMOSwxNCBaIE0xMiwwIEwxMiwyIEwxNCwyIEwxNCwwIEwxMiwwIEwxMiwwIFogTTEyLDUgTDE0LDUgTDE0LDMgTDEyLDMgTDEyLDUgTDEyLDUgWiBNMTIsMTQgTDE0LDE0IEwxNCwxMiBMMTIsMTIgTDEyLDE0IEwxMiwxNCBaIE0xMiwxMSBMMTQsMTEgTDE0LDkgTDEyLDkgTDEyLDExIEwxMiwxMSBaIiBvcGFjaXR5PSIuNTQiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iOCAwIDYgMCA2IDYgMCA2IDAgOCA2IDggNiAxNCA4IDE0IDggOCAxNCA4IDE0IDYgOCA2Ii8+CiAgPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzYsMzYpIj4KICA8ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMikiPgogICAgPHBhdGggZD0iTTYsMTQgTDgsMTQgTDgsMTIgTDYsMTIgTDYsMTQgTDYsMTQgWiBNMywyIEw1LDIgTDUsMCBMMywwIEwzLDIgTDMsMiBaIE02LDExIEw4LDExIEw4LDkgTDYsOSBMNiwxMSBMNiwxMSBaIE0zLDE0IEw1LDE0IEw1LDEyIEwzLDEyIEwzLDE0IEwzLDE0IFogTTAsNSBMMiw1IEwyLDMgTDAsMyBMMCw1IEwwLDUgWiBNMCwxNCBMMiwxNCBMMiwxMiBMMCwxMiBMMCwxNCBMMCwxNCBaIE0wLDIgTDIsMiBMMiwwIEwwLDAgTDAsMiBMMCwyIFogTTAsMTEgTDIsMTEgTDIsOSBMMCw5IEwwLDExIEwwLDExIFogTTEyLDExIEwxNCwxMSBMMTQsOSBMMTIsOSBMMTIsMTEgTDEyLDExIFogTTEyLDE0IEwxNCwxNCBMMTQsMTIgTDEyLDEyIEwxMiwxNCBMMTIsMTQgWiBNMTIsNSBMMTQsNSBMMTQsMyBMMTIsMyBMMTIsNSBMMTIsNSBaIE0xMiwwIEwxMiwyIEwxNCwyIEwxNCwwIEwxMiwwIEwxMiwwIFogTTYsMiBMOCwyIEw4LDAgTDYsMCBMNiwyIEw2LDIgWiBNOSwyIEwxMSwyIEwxMSwwIEw5LDAgTDksMiBMOSwyIFogTTYsNSBMOCw1IEw4LDMgTDYsMyBMNiw1IEw2LDUgWiBNOSwxNCBMMTEsMTQgTDExLDEyIEw5LDEyIEw5LDE0IEw5LDE0IFoiIG9wYWNpdHk9Ii41NCIvPgogICAgPHBvbHlnb24gcG9pbnRzPSIwIDggMTQgOCAxNCA2IDAgNiIvPgogIDwvZz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0LDM2KSI+CiAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgIDxwYXRoIGQ9Ik0zLDE0IEw1LDE0IEw1LDEyIEwzLDEyIEwzLDE0IEwzLDE0IFogTTAsNSBMMiw1IEwyLDMgTDAsMyBMMCw1IEwwLDUgWiBNMCwyIEwyLDIgTDIsMCBMMCwwIEwwLDIgTDAsMiBaIE0zLDggTDUsOCBMNSw2IEwzLDYgTDMsOCBMMyw4IFogTTMsMiBMNSwyIEw1LDAgTDMsMCBMMywyIEwzLDIgWiBNMCwxNCBMMiwxNCBMMiwxMiBMMCwxMiBMMCwxNCBMMCwxNCBaIE0wLDggTDIsOCBMMiw2IEwwLDYgTDAsOCBMMCw4IFogTTAsMTEgTDIsMTEgTDIsOSBMMCw5IEwwLDExIEwwLDExIFogTTEyLDAgTDEyLDIgTDE0LDIgTDE0LDAgTDEyLDAgTDEyLDAgWiBNMTIsOCBMMTQsOCBMMTQsNiBMMTIsNiBMMTIsOCBMMTIsOCBaIE0xMiwxNCBMMTQsMTQgTDE0LDEyIEwxMiwxMiBMMTIsMTQgTDEyLDE0IFogTTEyLDUgTDE0LDUgTDE0LDMgTDEyLDMgTDEyLDUgTDEyLDUgWiBNMTIsMTEgTDE0LDExIEwxNCw5IEwxMiw5IEwxMiwxMSBMMTIsMTEgWiBNOSwxNCBMMTEsMTQgTDExLDEyIEw5LDEyIEw5LDE0IEw5LDE0IFogTTksOCBMMTEsOCBMMTEsNiBMOSw2IEw5LDggTDksOCBaIE05LDIgTDExLDIgTDExLDAgTDksMCBMOSwyIEw5LDIgWiIgb3BhY2l0eT0iLjU0Ii8+CiAgICA8cG9seWdvbiBwb2ludHM9IjYgMTQgOCAxNCA4IDAgNiAwIi8+CiAgPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzIsMzYpIj4KICA8ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMikiPgogICAgPHBhdGggZD0iTTgsMyBMNiwzIEw2LDUgTDgsNSBMOCwzIEw4LDMgWiBNMTEsNiBMOSw2IEw5LDggTDExLDggTDExLDYgTDExLDYgWiBNOCw2IEw2LDYgTDYsOCBMOCw4IEw4LDYgTDgsNiBaIE04LDkgTDYsOSBMNiwxMSBMOCwxMSBMOCw5IEw4LDkgWiBNNSw2IEwzLDYgTDMsOCBMNSw4IEw1LDYgTDUsNiBaIiBvcGFjaXR5PSIuNTQiLz4KICAgIDxwYXRoIGQ9Ik0wLDAgTDE0LDAgTDE0LDE0IEwwLDE0IEwwLDAgWiBNMTIsMTIgTDEyLDIgTDIsMiBMMiwxMiBMMTIsMTIgWiIvPgogIDwvZz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwLDM2KSI+CiAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgIDxwYXRoIGQ9Ik02LDggTDgsOCBMOCw2IEw2LDYgTDYsOCBMNiw4IFogTTYsNSBMOCw1IEw4LDMgTDYsMyBMNiw1IEw2LDUgWiBNNiwxMSBMOCwxMSBMOCw5IEw2LDkgTDYsMTEgTDYsMTEgWiBNNiwxNCBMOCwxNCBMOCwxMiBMNiwxMiBMNiwxNCBMNiwxNCBaIE0zLDE0IEw1LDE0IEw1LDEyIEwzLDEyIEwzLDE0IEwzLDE0IFogTTMsMiBMNSwyIEw1LDAgTDMsMCBMMywyIEwzLDIgWiBNMyw4IEw1LDggTDUsNiBMMyw2IEwzLDggTDMsOCBaIE0xMiwxNCBMMTQsMTQgTDE0LDEyIEwxMiwxMiBMMTIsMTQgTDEyLDE0IFogTTEyLDggTDE0LDggTDE0LDYgTDEyLDYgTDEyLDggTDEyLDggWiBNMTIsMTEgTDE0LDExIEwxNCw5IEwxMiw5IEwxMiwxMSBMMTIsMTEgWiBNMTIsNSBMMTQsNSBMMTQsMyBMMTIsMyBMMTIsNSBMMTIsNSBaIE02LDIgTDgsMiBMOCwwIEw2LDAgTDYsMiBMNiwyIFogTTEyLDAgTDEyLDIgTDE0LDIgTDE0LDAgTDEyLDAgTDEyLDAgWiBNOSwxNCBMMTEsMTQgTDExLDEyIEw5LDEyIEw5LDE0IEw5LDE0IFogTTksOCBMMTEsOCBMMTEsNiBMOSw2IEw5LDggTDksOCBaIE05LDIgTDExLDIgTDExLDAgTDksMCBMOSwyIEw5LDIgWiIgb3BhY2l0eT0iLjU0Ii8+CiAgICA8cG9seWdvbiBwb2ludHM9IjAgMTQgMiAxNCAyIDAgMCAwIi8+CiAgPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA4LDM2KSI+CiAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgIDxwYXRoIGQ9Ik0zLDggTDUsOCBMNSw2IEwzLDYgTDMsOCBMMyw4IFogTTAsMTQgTDIsMTQgTDIsMTIgTDAsMTIgTDAsMTQgTDAsMTQgWiBNNiwxNCBMOCwxNCBMOCwxMiBMNiwxMiBMNiwxNCBMNiwxNCBaIE02LDExIEw4LDExIEw4LDkgTDYsOSBMNiwxMSBMNiwxMSBaIE0zLDE0IEw1LDE0IEw1LDEyIEwzLDEyIEwzLDE0IEwzLDE0IFogTTAsMTEgTDIsMTEgTDIsOSBMMCw5IEwwLDExIEwwLDExIFogTTYsOCBMOCw4IEw4LDYgTDYsNiBMNiw4IEw2LDggWiBNMCw1IEwyLDUgTDIsMyBMMCwzIEwwLDUgTDAsNSBaIE0wLDggTDIsOCBMMiw2IEwwLDYgTDAsOCBMMCw4IFogTTEyLDggTDE0LDggTDE0LDYgTDEyLDYgTDEyLDggTDEyLDggWiBNMTIsMTEgTDE0LDExIEwxNCw5IEwxMiw5IEwxMiwxMSBMMTIsMTEgWiBNMTIsNSBMMTQsNSBMMTQsMyBMMTIsMyBMMTIsNSBMMTIsNSBaIE02LDUgTDgsNSBMOCwzIEw2LDMgTDYsNSBMNiw1IFogTTksMTQgTDExLDE0IEwxMSwxMiBMOSwxMiBMOSwxNCBMOSwxNCBaIE05LDggTDExLDggTDExLDYgTDksNiBMOSw4IEw5LDggWiBNMTIsMTQgTDE0LDE0IEwxNCwxMiBMMTIsMTIgTDEyLDE0IEwxMiwxNCBaIiBvcGFjaXR5PSIuNTQiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMCAwIDAgMiAxNCAyIDE0IDAiLz4KICA8L2c+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjYsMzYpIj4KICA8ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMikiPgogICAgPHBhdGggZD0iTTAsMiBMMiwyIEwyLDAgTDAsMCBMMCwyIEwwLDIgWiBNMywyIEw1LDIgTDUsMCBMMywwIEwzLDIgTDMsMiBaIE0zLDggTDUsOCBMNSw2IEwzLDYgTDMsOCBMMyw4IFogTTMsMTQgTDUsMTQgTDUsMTIgTDMsMTIgTDMsMTQgTDMsMTQgWiBNMCw1IEwyLDUgTDIsMyBMMCwzIEwwLDUgTDAsNSBaIE0wLDggTDIsOCBMMiw2IEwwLDYgTDAsOCBMMCw4IFogTTAsMTQgTDIsMTQgTDIsMTIgTDAsMTIgTDAsMTQgTDAsMTQgWiBNMCwxMSBMMiwxMSBMMiw5IEwwLDkgTDAsMTEgTDAsMTEgWiBNOSw4IEwxMSw4IEwxMSw2IEw5LDYgTDksOCBMOSw4IFogTTYsMTQgTDgsMTQgTDgsMTIgTDYsMTIgTDYsMTQgTDYsMTQgWiBNOSwxNCBMMTEsMTQgTDExLDEyIEw5LDEyIEw5LDE0IEw5LDE0IFogTTYsMiBMOCwyIEw4LDAgTDYsMCBMNiwyIEw2LDIgWiBNOSwyIEwxMSwyIEwxMSwwIEw5LDAgTDksMiBMOSwyIFogTTYsMTEgTDgsMTEgTDgsOSBMNiw5IEw2LDExIEw2LDExIFogTTYsNSBMOCw1IEw4LDMgTDYsMyBMNiw1IEw2LDUgWiBNNiw4IEw4LDggTDgsNiBMNiw2IEw2LDggTDYsOCBaIiBvcGFjaXR5PSIuNTQiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMTIgMCAxMiAxNCAxNCAxNCAxNCAwIi8+CiAgPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQ0LDM2KSI+CiAgPGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIj4KICAgIDxwYXRoIGQ9Ik01LDAgTDMsMCBMMywyIEw1LDIgTDUsMCBMNSwwIFogTTgsNiBMNiw2IEw2LDggTDgsOCBMOCw2IEw4LDYgWiBNOCw5IEw2LDkgTDYsMTEgTDgsMTEgTDgsOSBMOCw5IFogTTExLDYgTDksNiBMOSw4IEwxMSw4IEwxMSw2IEwxMSw2IFogTTUsNiBMMyw2IEwzLDggTDUsOCBMNSw2IEw1LDYgWiBNMTEsMCBMOSwwIEw5LDIgTDExLDIgTDExLDAgTDExLDAgWiBNOCwzIEw2LDMgTDYsNSBMOCw1IEw4LDMgTDgsMyBaIE04LDAgTDYsMCBMNiwyIEw4LDIgTDgsMCBMOCwwIFogTTIsOSBMMCw5IEwwLDExIEwyLDExIEwyLDkgTDIsOSBaIE0xMiwxMSBMMTQsMTEgTDE0LDkgTDEyLDkgTDEyLDExIEwxMiwxMSBaIE0xMiw1IEwxNCw1IEwxNCwzIEwxMiwzIEwxMiw1IEwxMiw1IFogTTEyLDggTDE0LDggTDE0LDYgTDEyLDYgTDEyLDggTDEyLDggWiBNMTIsMCBMMTIsMiBMMTQsMiBMMTQsMCBMMTIsMCBMMTIsMCBaIE0yLDAgTDAsMCBMMCwyIEwyLDIgTDIsMCBMMiwwIFogTTIsMyBMMCwzIEwwLDUgTDIsNSBMMiwzIEwyLDMgWiBNMiw2IEwwLDYgTDAsOCBMMiw4IEwyLDYgTDIsNiBaIiBvcGFjaXR5PSIuNTQiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMCAxNCAxNCAxNCAxNCAxMiAwIDEyIi8+CiAgPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYyLDM2KSI+PHBhdGggZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNNiwxNCBMOCwxNCBMOCwxMiBMNiwxMiBMNiwxNCBMNiwxNCBaIE0zLDggTDUsOCBMNSw2IEwzLDYgTDMsOCBMMyw4IFogTTMsMiBMNSwyIEw1LDAgTDMsMCBMMywyIEwzLDIgWiBNNiwxMSBMOCwxMSBMOCw5IEw2LDkgTDYsMTEgTDYsMTEgWiBNMywxNCBMNSwxNCBMNSwxMiBMMywxMiBMMywxNCBMMywxNCBaIE0wLDUgTDIsNSBMMiwzIEwwLDMgTDAsNSBMMCw1IFogTTAsMTQgTDIsMTQgTDIsMTIgTDAsMTIgTDAsMTQgTDAsMTQgWiBNMCwyIEwyLDIgTDIsMCBMMCwwIEwwLDIgTDAsMiBaIE0wLDggTDIsOCBMMiw2IEwwLDYgTDAsOCBMMCw4IFogTTYsOCBMOCw4IEw4LDYgTDYsNiBMNiw4IEw2LDggWiBNMCwxMSBMMiwxMSBMMiw5IEwwLDkgTDAsMTEgTDAsMTEgWiBNMTIsMTEgTDE0LDExIEwxNCw5IEwxMiw5IEwxMiwxMSBMMTIsMTEgWiBNMTIsMTQgTDE0LDE0IEwxNCwxMiBMMTIsMTIgTDEyLDE0IEwxMiwxNCBaIE0xMiw4IEwxNCw4IEwxNCw2IEwxMiw2IEwxMiw4IEwxMiw4IFogTTEyLDUgTDE0LDUgTDE0LDMgTDEyLDMgTDEyLDUgTDEyLDUgWiBNMTIsMCBMMTIsMiBMMTQsMiBMMTQsMCBMMTIsMCBMMTIsMCBaIE02LDIgTDgsMiBMOCwwIEw2LDAgTDYsMiBMNiwyIFogTTksMiBMMTEsMiBMMTEsMCBMOSwwIEw5LDIgTDksMiBaIE02LDUgTDgsNSBMOCwzIEw2LDMgTDYsNSBMNiw1IFogTTksMTQgTDExLDE0IEwxMSwxMiBMOSwxMiBMOSwxNCBMOSwxNCBaIE05LDggTDExLDggTDExLDYgTDksNiBMOSw4IEw5LDggWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAyKSIgb3BhY2l0eT0iLjU0Ii8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODAsMzYpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjUsMy42MiBMMCwxMC4xMiBMMCwxMyBMMi44OCwxMyBMOS4zOCw2LjUgTDYuNSwzLjYyIFogTTExLjg1LDQuMDIgQzEyLjA1LDMuODIgMTIuMDUsMy41MSAxMS44NSwzLjMxIEw5LjY4LDEuMTQgQzkuNDgsMC45NCA5LjE3LDAuOTQgOC45NywxLjE0IEw3LjYyLDIuNSBMMTAuNSw1LjM4IEwxMS44NSw0LjAyIEwxMS44NSw0LjAyIFoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTgsMzYpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLDAgTDE0LDAgTDE0LDIgTDAsMiBMMCwwIFogTTAsNCBMNiw0IEw2LDYgTDAsNiBMMCw0IFogTTAsOCBMMiw4IEwyLDEwIEwwLDEwIEwwLDggWiBNOCw0IEwxNCw0IEwxNCw2IEw4LDYgTDgsNCBaIE00LDggTDYsOCBMNiwxMCBMNCwxMCBMNCw4IFogTTgsOCBMMTAsOCBMMTAsMTAgTDgsMTAgTDgsOCBaIE0xMiw4IEwxNCw4IEwxNCwxMCBMMTIsMTAgTDEyLDggWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiA0KSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE2LDM2KSI+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9Ii0yIDIgMiA2IDYgMiIgdHJhbnNmb3JtPSJyb3RhdGUoOTAgMyAxMCkiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIzNCwzNikiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgcG9pbnRzPSI3LjUzIDEuNTMgNi40NyAuNDcgNCAyLjk0IDEuNTMgLjQ3IC40NyAxLjUzIDIuOTQgNCAuNDcgNi40NyAxLjUzIDcuNTMgNCA1LjA2IDYuNDcgNy41MyA3LjUzIDYuNDcgNS4wNiA0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1IDUpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDU0KSI+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjguNDQgLjQ0IDUgMy44OCAxLjU2IC40NCAuNSAxLjUgNSA2IDkuNSAxLjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNikiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4LDU0KSI+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjUgMCAuNSA0LjUgMS41NiA1LjU2IDUgMi4xMiA4LjQ0IDUuNTYgOS41IDQuNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNCA2KSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzYsNTQpIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHBvaW50cz0iOC40NCAuNDQgNSAzLjg4IDEuNTYgLjQ0IC41IDEuNSA1IDYgOS41IDEuNSIgdHJhbnNmb3JtPSJyb3RhdGUoOTAgNCA4KSIvPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTQsNTQpIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHBvaW50cz0iNSAwIC41IDQuNSAxLjU2IDUuNTYgNSAyLjEyIDguNDQgNS41NiA5LjUgNC41IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA0IDgpIi8+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3Miw1NCkiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgcG9pbnRzPSIxMiA1IDMuMTI1IDUgNy4wNiAxLjA2IDYgMCAwIDYgNiAxMiA3LjA2IDEwLjk0IDMuMTI1IDcgMTIgNyIgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMTUgMykiLz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkwLDU0KSI+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBwb2ludHM9IjEyIDUgMy4xMjUgNSA3LjA2IDEuMDYgNiAwIDAgNiA2IDEyIDcuMDYgMTAuOTQgMy4xMjUgNyAxMiA3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDMpIi8+CjwvZz4KPC9zdmc+Cg=="},262:(e,t)=>{"use strict";t.A=(e,t)=>{const i=e.__vccOpts||e;for(const[e,s]of t)i[e]=s;return i}},387:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__esModule:()=>n.B,default:()=>r});var s=i(617),n=i(232);const r=(0,i(262).A)(n.A,[["render",s.X]])},585:()=>{!function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}({3:function(e,t,i){"use strict";i.r(t);const s={toolbar:{undo:"\u64a4\u9500",redo:"\u6062\u590d",print:"\u6253\u5370",paintformat:"\u683c\u5f0f\u5237",clearformat:"\u6e05\u9664\u683c\u5f0f",format:"\u6570\u636e\u683c\u5f0f",fontName:"\u5b57\u4f53",fontSize:"\u5b57\u53f7",fontBold:"\u52a0\u7c97",fontItalic:"\u503e\u659c",underline:"\u4e0b\u5212\u7ebf",strike:"\u5220\u9664\u7ebf",color:"\u5b57\u4f53\u989c\u8272",bgcolor:"\u586b\u5145\u989c\u8272",border:"\u8fb9\u6846",merge:"\u5408\u5e76\u5355\u5143\u683c",align:"\u6c34\u5e73\u5bf9\u9f50",valign:"\u5782\u76f4\u5bf9\u9f50",textwrap:"\u81ea\u52a8\u6362\u884c",freeze:"\u51bb\u7ed3",autofilter:"\u81ea\u52a8\u7b5b\u9009",formula:"\u51fd\u6570",more:"\u66f4\u591a"},contextmenu:{copy:"\u590d\u5236",cut:"\u526a\u5207",paste:"\u7c98\u8d34",pasteValue:"\u7c98\u8d34\u6570\u636e",pasteFormat:"\u7c98\u8d34\u683c\u5f0f",hide:"\u9690\u85cf",insertRow:"\u63d2\u5165\u884c",insertColumn:"\u63d2\u5165\u5217",deleteSheet:"\u5220\u9664",deleteRow:"\u5220\u9664\u884c",deleteColumn:"\u5220\u9664\u5217",deleteCell:"\u5220\u9664",deleteCellText:"\u5220\u9664\u6570\u636e",validation:"\u6570\u636e\u9a8c\u8bc1",cellprintable:"\u53ef\u6253\u5370",cellnonprintable:"\u4e0d\u53ef\u6253\u5370",celleditable:"\u53ef\u7f16\u8f91",cellnoneditable:"\u4e0d\u53ef\u7f16\u8f91"},print:{size:"\u7eb8\u5f20\u5927\u5c0f",orientation:"\u65b9\u5411",orientations:["\u6a2a\u5411","\u7eb5\u5411"]},format:{normal:"\u6b63\u5e38",text:"\u6587\u672c",number:"\u6570\u503c",percent:"\u767e\u5206\u6bd4",rmb:"\u4eba\u6c11\u5e01",usd:"\u7f8e\u5143",eur:"\u6b27\u5143",date:"\u77ed\u65e5\u671f",time:"\u65f6\u95f4",datetime:"\u957f\u65e5\u671f",duration:"\u6301\u7eed\u65f6\u95f4"},formula:{sum:"\u6c42\u548c",average:"\u6c42\u5e73\u5747\u503c",max:"\u6c42\u6700\u5927\u503c",min:"\u6c42\u6700\u5c0f\u503c",concat:"\u5b57\u7b26\u62fc\u63a5",_if:"\u6761\u4ef6\u5224\u65ad",and:"\u548c",or:"\u6216"},validation:{required:"\u6b64\u503c\u5fc5\u586b",notMatch:"\u6b64\u503c\u4e0d\u5339\u914d\u9a8c\u8bc1\u89c4\u5219",between:"\u6b64\u503c\u5e94\u5728 {} \u548c {} \u4e4b\u95f4",notBetween:"\u6b64\u503c\u4e0d\u5e94\u5728 {} \u548c {} \u4e4b\u95f4",notIn:"\u6b64\u503c\u4e0d\u5728\u5217\u8868\u4e2d",equal:"\u6b64\u503c\u5e94\u8be5\u7b49\u4e8e {}",notEqual:"\u6b64\u503c\u4e0d\u5e94\u8be5\u7b49\u4e8e {}",lessThan:"\u6b64\u503c\u5e94\u8be5\u5c0f\u4e8e {}",lessThanEqual:"\u6b64\u503c\u5e94\u8be5\u5c0f\u4e8e\u7b49\u4e8e {}",greaterThan:"\u6b64\u503c\u5e94\u8be5\u5927\u4e8e {}",greaterThanEqual:"\u6b64\u503c\u5e94\u8be5\u5927\u4e8e\u7b49\u4e8e {}"},error:{pasteForMergedCell:"\u65e0\u6cd5\u5bf9\u5408\u5e76\u7684\u5355\u5143\u683c\u6267\u884c\u6b64\u64cd\u4f5c"},calendar:{weeks:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],months:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"]},button:{next:"\u4e0b\u4e00\u6b65",cancel:"\u53d6\u6d88",remove:"\u5220\u9664",save:"\u4fdd\u5b58",ok:"\u786e\u8ba4"},sort:{desc:"\u964d\u5e8f",asc:"\u5347\u5e8f"},filter:{empty:"\u7a7a\u767d"},dataValidation:{mode:"\u6a21\u5f0f",range:"\u5355\u5143\u533a\u95f4",criteria:"\u6761\u4ef6",modeType:{cell:"\u5355\u5143\u683c",column:"\u5217\u6a21\u5f0f",row:"\u884c\u6a21\u5f0f"},type:{list:"\u5217\u8868",number:"\u6570\u5b57",date:"\u65e5\u671f",phone:"\u624b\u673a\u53f7",email:"\u7535\u5b50\u90ae\u4ef6"},operator:{be:"\u5728\u533a\u95f4",nbe:"\u4e0d\u5728\u533a\u95f4",lt:"\u5c0f\u4e8e",lte:"\u5c0f\u4e8e\u7b49\u4e8e",gt:"\u5927\u4e8e",gte:"\u5927\u4e8e\u7b49\u4e8e",eq:"\u7b49\u4e8e",neq:"\u4e0d\u7b49\u4e8e"}}};window&&window.x_spreadsheet&&(window.x_spreadsheet.$messages=window.x_spreadsheet.$messages||{},window.x_spreadsheet.$messages["zh-cn"]=s),t.default=s}})},853:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Zs,spreadsheet:()=>Os});class s{constructor(e,t=""){"string"==typeof e?(this.el=document.createElement(e),this.el.className=t):this.el=e,this.data={}}data(e,t){return void 0!==t?(this.data[e]=t,this):this.data[e]}on(e,t){const[i,...s]=e.split(".");let n=i;return"mousewheel"===n&&/Firefox/i.test(window.navigator.userAgent)&&(n="DOMMouseScroll"),this.el.addEventListener(n,(e=>{t(e);for(let t=0;t<s.length;t+=1){const i=s[t];if("left"===i&&0!==e.button)return;if("right"===i&&2!==e.button)return;"stop"===i&&e.stopPropagation()}})),this}offset(e){if(void 0!==e)return Object.keys(e).forEach((t=>{this.css(t,`${e[t]}px`)})),this;const{offsetTop:t,offsetLeft:i,offsetHeight:s,offsetWidth:n}=this.el;return{top:t,left:i,height:s,width:n}}scroll(e){const{el:t}=this;return void 0!==e&&(void 0!==e.left&&(t.scrollLeft=e.left),void 0!==e.top&&(t.scrollTop=e.top)),{left:t.scrollLeft,top:t.scrollTop}}box(){return this.el.getBoundingClientRect()}parent(){return new s(this.el.parentNode)}children(...e){return 0===arguments.length?this.el.childNodes:(e.forEach((e=>this.child(e))),this)}removeChild(e){this.el.removeChild(e)}child(e){let t=e;return"string"==typeof e?t=document.createTextNode(e):e instanceof s&&(t=e.el),this.el.appendChild(t),this}contains(e){return this.el.contains(e)}className(e){return void 0!==e?(this.el.className=e,this):this.el.className}addClass(e){return this.el.classList.add(e),this}hasClass(e){return this.el.classList.contains(e)}removeClass(e){return this.el.classList.remove(e),this}toggle(e="active"){return this.toggleClass(e)}toggleClass(e){return this.el.classList.toggle(e)}active(e=!0,t="active"){return e?this.addClass(t):this.removeClass(t),this}checked(e=!0){return this.active(e,"checked"),this}disabled(e=!0){return e?this.addClass("disabled"):this.removeClass("disabled"),this}attr(e,t){if(void 0!==t)this.el.setAttribute(e,t);else{if("string"==typeof e)return this.el.getAttribute(e);Object.keys(e).forEach((t=>{this.el.setAttribute(t,e[t])}))}return this}removeAttr(e){return this.el.removeAttribute(e),this}html(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}val(e){return void 0!==e?(this.el.value=e,this):this.el.value}focus(){this.el.focus()}cssRemoveKeys(...e){return e.forEach((e=>this.el.style.removeProperty(e))),this}css(e,t){return void 0===t&&"string"!=typeof e?(Object.keys(e).forEach((t=>{this.el.style[t]=e[t]})),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}computedStyle(){return window.getComputedStyle(this.el,null)}show(){return this.css("display","block"),this}hide(){return this.css("display","none"),this}}const n=(e,t="")=>new s(e,t),r=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function l(e){let t="",i=e;for(;i>=r.length;)i/=r.length,i-=1,t+=r[parseInt(i,10)%r.length];const s=e%r.length;return t+=r[s],t}function o(e){let t=0;for(let i=0;i<e.length-1;i+=1){const s=e.charCodeAt(i)-65,n=e.length-1-i;t+=r.length**n+r.length*s}return t+=e.charCodeAt(e.length-1)-65,t}function a(e){let t="",i="";for(let s=0;s<e.length;s+=1)e.charAt(s)>="0"&&e.charAt(s)<="9"?i+=e.charAt(s):t+=e.charAt(s);return[o(t),parseInt(i,10)-1]}function h(e,t){return`${l(e)}${t+1}`}function c(e,t,i,s=(()=>!0)){if(0===t&&0===i)return e;const[n,r]=a(e);return s(n,r)?h(n+t,r+i):e}class d{constructor(e,t,i,s,n=0,r=0){this.sri=e,this.sci=t,this.eri=i,this.eci=s,this.w=n,this.h=r}set(e,t,i,s){this.sri=e,this.sci=t,this.eri=i,this.eci=s}multiple(){return this.eri-this.sri>0||this.eci-this.sci>0}includes(...e){let[t,i]=[0,0];1===e.length?[i,t]=a(e[0]):2===e.length&&([t,i]=e);const{sri:s,sci:n,eri:r,eci:l}=this;return s<=t&&t<=r&&n<=i&&i<=l}each(e,t=(()=>!0)){const{sri:i,sci:s,eri:n,eci:r}=this;for(let l=i;l<=n;l+=1)if(t(l))for(let t=s;t<=r;t+=1)e(l,t)}contains(e){return this.sri<=e.sri&&this.sci<=e.sci&&this.eri>=e.eri&&this.eci>=e.eci}within(e){return this.sri>=e.sri&&this.sci>=e.sci&&this.eri<=e.eri&&this.eci<=e.eci}disjoint(e){return this.sri>e.eri||this.sci>e.eci||e.sri>this.eri||e.sci>this.eci}intersects(e){return this.sri<=e.eri&&this.sci<=e.eci&&e.sri<=this.eri&&e.sci<=this.eci}union(e){const{sri:t,sci:i,eri:s,eci:n}=this;return new d(e.sri<t?e.sri:t,e.sci<i?e.sci:i,e.eri>s?e.eri:s,e.eci>n?e.eci:n)}difference(e){const t=[],i=(e,i,s,n)=>{t.push(new d(e,i,s,n))},{sri:s,sci:n,eri:r,eci:l}=this,o=e.sri-s,a=e.sci-n,h=r-e.eri,c=l-e.eci;return o>0?(i(s,n,e.sri-1,l),h>0?(i(e.eri+1,n,r,l),a>0&&i(e.sri,n,e.eri,e.sci-1),c>0&&i(e.sri,e.eci+1,e.eri,l)):(a>0&&i(e.sri,n,r,e.sci-1),c>0&&i(e.sri,e.eci+1,r,l))):h>0&&(i(e.eri+1,n,r,l),a>0&&i(s,n,e.eri,e.sci-1),c>0&&i(s,e.eci+1,e.eri,l)),a>0?(i(s,n,r,e.sci-1),c>0?(i(s,e.eri+1,r,l),o>0&&i(s,e.sci,e.sri-1,e.eci),h>0&&i(e.sri+1,e.sci,r,e.eci)):(o>0&&i(s,e.sci,e.sri-1,l),h>0&&i(e.sri+1,e.sci,r,l))):c>0&&(i(r,e.eci+1,r,l),o>0&&i(s,n,e.sri-1,e.eci),h>0&&i(e.eri+1,n,r,e.eci)),t}size(){return[this.eri-this.sri+1,this.eci-this.sci+1]}toString(){const{sri:e,sci:t,eri:i,eci:s}=this;let n=h(t,e);return this.multiple()&&(n=`${n}:${h(s,i)}`),n}clone(){const{sri:e,sci:t,eri:i,eci:s,w:n,h:r}=this;return new d(e,t,i,s,n,r)}equals(e){return this.eri===e.eri&&this.eci===e.eci&&this.sri===e.sri&&this.sci===e.sci}static valueOf(e){const t=e.split(":"),[i,s]=a(t[0]);let[n,r]=[s,i];return t.length>1&&([r,n]=a(t[1])),new d(s,i,n,r)}}class g{constructor(){this.range=new d(0,0,0,0),this.ri=0,this.ci=0}multiple(){return this.range.multiple()}setIndexes(e,t){this.ri=e,this.ci=t}size(){return this.range.size()}}class u{constructor(){this.x=0,this.y=0,this.ri=0,this.ci=0}}class w{constructor(){this.undoItems=[],this.redoItems=[]}add(e){this.undoItems.push(JSON.stringify(e)),this.redoItems=[]}canUndo(){return this.undoItems.length>0}canRedo(){return this.redoItems.length>0}undo(e,t){const{undoItems:i,redoItems:s}=this;this.canUndo()&&(s.push(JSON.stringify(e)),t(JSON.parse(i.pop())))}redo(e,t){const{undoItems:i,redoItems:s}=this;this.canRedo()&&(i.push(JSON.stringify(e)),t(JSON.parse(s.pop())))}}class M{constructor(){this.range=null,this.state="clear"}copy(e){return this.range=e,this.state="copy",this}cut(e){return this.range=e,this.state="cut",this}isCopy(){return"copy"===this.state}isCut(){return"cut"===this.state}isClear(){return"clear"===this.state}clear(){this.range=null,this.state="clear"}}class p{constructor(e,t,i){this.ci=e,this.operator=t,this.value=i}set(e,t){this.operator=e,this.value=t}includes(e){const{operator:t,value:i}=this;return"all"===t||"in"===t&&i.includes(e)}vlength(){const{operator:e,value:t}=this;return"in"===e?t.length:0}getData(){const{ci:e,operator:t,value:i}=this;return{ci:e,operator:t,value:i}}}class x{constructor(e,t){this.ci=e,this.order=t}asc(){return"asc"===this.order}desc(){return"desc"===this.order}}class f{constructor(){this.ref=null,this.filters=[],this.sort=null}setData({ref:e,filters:t,sort:i}){null!=e&&(this.ref=e,this.filters=t.map((e=>new p(e.ci,e.operator,e.value))),i&&(this.sort=new x(i.ci,i.order)))}getData(){if(this.active()){const{ref:e,filters:t,sort:i}=this;return{ref:e,filters:t.map((e=>e.getData())),sort:i}}return{}}addFilter(e,t,i){const s=this.getFilter(e);null==s?this.filters.push(new p(e,t,i)):s.set(t,i)}setSort(e,t){this.sort=t?new x(e,t):null}includes(e,t){return!!this.active()&&this.hrange().includes(e,t)}getSort(e){const{sort:t}=this;return t&&t.ci===e?t:null}getFilter(e){const{filters:t}=this;for(let i=0;i<t.length;i+=1)if(t[i].ci===e)return t[i];return null}filteredRows(e){const t=new Set,i=new Set;if(this.active()){const{sri:s,eri:n}=this.range(),{filters:r}=this;for(let l=s+1;l<=n;l+=1)for(let s=0;s<r.length;s+=1){const n=r[s],o=e(l,n.ci),a=o?o.text:"";if(!n.includes(a)){t.add(l);break}i.add(l)}}return{rset:t,fset:i}}items(e,t){const i={};if(this.active()){const{sri:s,eri:n}=this.range();for(let r=s+1;r<=n;r+=1){const s=t(r,e);if(null===s||/^\s*$/.test(s.text))i[""]=(i[""]||0)+1;else{const e=s.text,t=(i[e]||0)+1;i[e]=t}}}return i}range(){return d.valueOf(this.ref)}hrange(){const e=this.range();return e.eri=e.sri,e}clear(){this.ref=null,this.filters=[],this.sort=null}active(){return null!==this.ref}}class D{constructor(e=[]){this._=e}forEach(e){this._.forEach(e)}deleteWithin(e){this._=this._.filter((t=>!t.within(e)))}getFirstIncludes(e,t){for(let i=0;i<this._.length;i+=1){const s=this._[i];if(s.includes(e,t))return s}return null}filterIntersects(e){return new D(this._.filter((t=>t.intersects(e))))}intersects(e){for(let t=0;t<this._.length;t+=1){if(this._[t].intersects(e))return!0}return!1}union(e){let t=e;return this._.forEach((e=>{e.intersects(t)&&(t=e.union(t))})),t}add(e){this.deleteWithin(e),this._.push(e)}shift(e,t,i,s){this._.forEach((n=>{const{sri:r,sci:l,eri:o,eci:a}=n,h=n;"row"===e?r>=t?(h.sri+=i,h.eri+=i):r<t&&t<=o&&(h.eri+=i,s(r,l,i,0)):"column"===e&&(l>=t?(h.sci+=i,h.eci+=i):l<t&&t<=a&&(h.eci+=i,s(r,l,0,i)))}))}move(e,t,i){this._.forEach((s=>{const n=s;n.within(e)&&(n.eri+=t,n.sri+=t,n.sci+=i,n.eci+=i)}))}setData(e){return this._=e.map((e=>d.valueOf(e))),this}getData(){return this._.map((e=>e.toString()))}}const I=(e={},...t)=>(t.forEach((t=>{Object.keys(t).forEach((i=>{const s=t[i];"string"==typeof s||"number"==typeof s||"boolean"==typeof s?e[i]=s:"function"!=typeof s&&!Array.isArray(s)&&s instanceof Object?(e[i]=e[i]||{},I(e[i],s)):e[i]=s}))})),e);function m(e){const t=`${e}`;let i=0,s=!1;for(let e=0;e<t.length;e+=1)!0===s&&(i+=1),"."===t.charAt(e)&&(s=!0);return i}function b(e,t,i){if(Number.isNaN(t)||Number.isNaN(i))return t+e+i;const s=m(t),n=m(i),r=Number(t),l=Number(i);let o=0;if("-"===e)o=r-l;else if("+"===e)o=r+l;else if("*"===e)o=r*l;else if("/"===e)return o=r/l,m(o)>5?o.toFixed(2):o;return o.toFixed(Math.max(s,n))}const y={cloneDeep:function(e){return JSON.parse(JSON.stringify(e))},merge:(...e)=>I({},...e),equals:function e(t,i){const s=Object.keys(t);if(s.length!==Object.keys(i).length)return!1;for(let n=0;n<s.length;n+=1){const r=s[n],l=t[r],o=i[r];if(void 0===o)return!1;if("string"==typeof l||"number"==typeof l||"boolean"==typeof l){if(l!==o)return!1}else if(Array.isArray(l)){if(l.length!==o.length)return!1;for(let t=0;t<l.length;t+=1)if(!e(l[t],o[t]))return!1}else if("function"!=typeof l&&!Array.isArray(l)&&l instanceof Object&&!e(l,o))return!1}return!0},arrayEquals:function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i+=1)if(e[i]!==t[i])return!1;return!0},sum:(e,t=(e=>e))=>{let i=0,s=0;return Object.keys(e).forEach((n=>{i+=t(e[n],n),s+=1})),[i,s]},rangeEach:function(e,t,i){for(let s=e;s<t;s+=1)i(s)},rangeSum:function(e,t,i){let s=0;for(let n=e;n<t;n+=1)s+=i(n);return s},rangeReduceIf:function(e,t,i,s,n,r){let l=i,o=s,a=e;for(;a<t&&!(l>n);a+=1)o=r(a),l+=o;return[a,l-o,o]},deleteProperty:function(e,t){const i=e[`${t}`];return delete e[`${t}`],i},numberCalc:b};class E{constructor({len:e,height:t}){this._={},this.len=e,this.height=t}getHeight(e){if(this.isHide(e))return 0;const t=this.get(e);return t&&t.height?t.height:this.height}setHeight(e,t){this.getOrNew(e).height=t}unhide(e){let t=e;for(;t>0&&(t-=1,this.isHide(t));)this.setHide(t,!1)}isHide(e){const t=this.get(e);return t&&t.hide}setHide(e,t){const i=this.getOrNew(e);!0===t?i.hide=!0:delete i.hide}setStyle(e,t){this.getOrNew(e).style=t}sumHeight(e,t,i){return y.rangeSum(e,t,(e=>i&&i.has(e)?0:this.getHeight(e)))}totalHeight(){return this.sumHeight(0,this.len)}get(e){return this._[e]}getOrNew(e){return this._[e]=this._[e]||{cells:{}},this._[e]}getCell(e,t){const i=this.get(e);return void 0!==i&&void 0!==i.cells&&void 0!==i.cells[t]?i.cells[t]:null}getCellMerge(e,t){const i=this.getCell(e,t);return i&&i.merge?i.merge:[0,0]}getCellOrNew(e,t){const i=this.getOrNew(e);return i.cells[t]=i.cells[t]||{},i.cells[t]}setCell(e,t,i,s="all"){const n=this.getOrNew(e);"all"===s?n.cells[t]=i:"text"===s?(n.cells[t]=n.cells[t]||{},n.cells[t].text=i.text):"format"===s&&(n.cells[t]=n.cells[t]||{},n.cells[t].style=i.style,i.merge&&(n.cells[t].merge=i.merge))}setCellText(e,t,i){const s=this.getCellOrNew(e,t);!1!==s.editable&&(s.text=i)}copyPaste(e,t,i,s=!1,n=(()=>{})){const{sri:r,sci:l,eri:o,eci:a}=e,h=t.sri,d=t.sci,g=t.eri,u=t.eci,[w,M]=e.size(),[p,x]=t.size();let f=!0,D=0;(g<r||u<l)&&(f=!1,D=g<r?p:x);for(let e=r;e<=o;e+=1)if(this._[e])for(let t=l;t<=a;t+=1)if(this._[e].cells&&this._[e].cells[t])for(let p=h;p<=g;p+=w)for(let x=d;x<=u;x+=M){const I=p+(e-r),m=x+(t-l),b=y.cloneDeep(this._[e].cells[t]);if(s&&b&&b.text&&b.text.length>0){const{text:e}=b;let t=x-d+(p-h)+2;if(f||(t-=D+1),"="===e[0])b.text=e.replace(/[a-zA-Z]{1,3}\d+/g,(e=>{let[i,s]=[0,0];return r===h?i=t-1:s=t-1,/^\d+$/.test(e)?e:c(e,i,s)}));else if(w<=1&&M>1&&(h>o||g<r)||M<=1&&w>1&&(d>a||u<l)||w<=1&&M<=1){const i=/[\\.\d]+$/.exec(e);if(null!==i){const s=Number(i[0])+t-1;b.text=e.substring(0,i.index)+s}}}this.setCell(I,m,b,i),n(I,m,b)}}cutPaste(e,t){const i={};this.each((s=>{this.eachCells(s,(n=>{let r=parseInt(s,10),l=parseInt(n,10);e.includes(s,n)&&(r=t.sri+(r-e.sri),l=t.sci+(l-e.sci)),i[r]=i[r]||{cells:{}},i[r].cells[l]=this._[s].cells[n]}))})),this._=i}paste(e,t){if(e.length<=0)return;const{sri:i,sci:s}=t;e.forEach(((e,t)=>{const n=i+t;e.forEach(((e,t)=>{const i=s+t;this.setCellText(n,i,e)}))}))}insert(e,t=1){const i={};this.each(((s,n)=>{let r=parseInt(s,10);r>=e&&(r+=t,this.eachCells(s,((i,s)=>{s.text&&"="===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\d+/g,(i=>c(i,0,t,((t,i)=>i>=e)))))}))),i[r]=n})),this._=i,this.len+=t}delete(e,t){const i=t-e+1,s={};this.each(((n,r)=>{const l=parseInt(n,10);l<e?s[l]=r:n>t&&(s[l-i]=r,this.eachCells(n,((e,s)=>{s.text&&"="===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\d+/g,(e=>c(e,0,-i,((e,i)=>i>t)))))})))})),this._=s,this.len-=i}insertColumn(e,t=1){this.each(((i,s)=>{const n={};this.eachCells(i,((i,s)=>{let r=parseInt(i,10);r>=e&&(r+=t,s.text&&"="===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\d+/g,(i=>c(i,t,0,(t=>t>=e)))))),n[r]=s})),s.cells=n}))}deleteColumn(e,t){const i=t-e+1;this.each(((s,n)=>{const r={};this.eachCells(s,((s,n)=>{const l=parseInt(s,10);l<e?r[l]=n:l>t&&(r[l-i]=n,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(e=>c(e,-i,0,(e=>e>t))))))})),n.cells=r}))}deleteCells(e,t="all"){e.each(((e,i)=>{this.deleteCell(e,i,t)}))}deleteCell(e,t,i="all"){const s=this.get(e);if(null!==s){const n=this.getCell(e,t);null!==n&&!1!==n.editable&&("all"===i?delete s.cells[t]:"text"===i?(n.text&&delete n.text,n.value&&delete n.value):"format"===i?(void 0!==n.style&&delete n.style,n.merge&&delete n.merge):"merge"===i&&n.merge&&delete n.merge)}}maxCell(){const e=Object.keys(this._),t=e[e.length-1],i=this._[t];if(i){const{cells:e}=i,s=Object.keys(e),n=s[s.length-1];return[parseInt(t,10),parseInt(n,10)]}return[0,0]}each(e){Object.entries(this._).forEach((([t,i])=>{e(t,i)}))}eachCells(e,t){this._[e]&&this._[e].cells&&Object.entries(this._[e].cells).forEach((([e,i])=>{t(e,i)}))}setData(e){e.len&&(this.len=e.len,delete e.len),this._=e}getData(){const{len:e}=this;return Object.assign({len:e},this._)}}class T{constructor({len:e,width:t,indexWidth:i,minWidth:s}){this._={},this.len=e,this.width=t,this.indexWidth=i,this.minWidth=s}setData(e){e.len&&(this.len=e.len,delete e.len),this._=e}getData(){const{len:e}=this;return Object.assign({len:e},this._)}getWidth(e){if(this.isHide(e))return 0;const t=this._[e];return t&&t.width?t.width:this.width}getOrNew(e){return this._[e]=this._[e]||{},this._[e]}setWidth(e,t){this.getOrNew(e).width=t}unhide(e){let t=e;for(;t>0&&(t-=1,this.isHide(t));)this.setHide(t,!1)}isHide(e){const t=this._[e];return t&&t.hide}setHide(e,t){const i=this.getOrNew(e);!0===t?i.hide=!0:delete i.hide}setStyle(e,t){this.getOrNew(e).style=t}sumWidth(e,t){return y.rangeSum(e,t,(e=>this.getWidth(e)))}totalWidth(){return this.sumWidth(0,this.len)}}let N=["en"];const L={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function C(e,t){if(t)for(const i of N){if(!t[i])break;let s=t[i];const n=e.match(/(?:\\.|[^.])+/g);for(let e=0;e<n.length;e+=1){const t=s[n[e]];if(!t)break;if(e===n.length-1)return t;s=t}}}function v(e){let t=C(e,L);return!t&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(t=C(e,window.x_spreadsheet.$messages)),t||""}function S(e){return()=>v(e)}function A(e,t,i=!1){i?N=[e]:N.unshift(e),t&&(L[e]=t)}const z={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function B(e,t,...i){let s="";return e||(s=v(`validation.${t}`,...i)),[e,s]}class k{constructor(e,t,i,s){this.required=t,this.value=i,this.type=e,this.operator=s,this.message=""}parseValue(e){const{type:t}=this;return"date"===t?new Date(e):"number"===t?Number(e):e}equals(e){let t=this.type===e.type&&this.required===e.required&&this.operator===e.operator;return t&&(t=Array.isArray(this.value)?y.arrayEquals(this.value,e.value):this.value===e.value),t}values(){return this.value.split(",")}validate(e){const{required:t,operator:i,value:s,type:n}=this;if(t&&/^\s*$/.test(e))return B(!1,"required");if(/^\s*$/.test(e))return[!0];if(z[n]&&!z[n].test(e))return B(!1,"notMatch");if("list"===n)return B(this.values().includes(e),"notIn");if(i){const t=this.parseValue(e);if("be"===i){const[e,i]=s;return B(t>=this.parseValue(e)&&t<=this.parseValue(i),"between",e,i)}if("nbe"===i){const[e,i]=s;return B(t<this.parseValue(e)||t>this.parseValue(i),"notBetween",e,i)}if("eq"===i)return B(t===this.parseValue(s),"equal",s);if("neq"===i)return B(t!==this.parseValue(s),"notEqual",s);if("lt"===i)return B(t<this.parseValue(s),"lessThan",s);if("lte"===i)return B(t<=this.parseValue(s),"lessThanEqual",s);if("gt"===i)return B(t>this.parseValue(s),"greaterThan",s);if("gte"===i)return B(t>=this.parseValue(s),"greaterThanEqual",s)}return[!0]}}class j{constructor(e,t,i){this.refs=t,this.mode=e,this.validator=i}includes(e,t){const{refs:i}=this;for(let s=0;s<i.length;s+=1){if(d.valueOf(i[s]).includes(e,t))return!0}return!1}addRef(e){this.remove(d.valueOf(e)),this.refs.push(e)}remove(e){const t=[];this.refs.forEach((i=>{const s=d.valueOf(i);if(s.intersects(e)){s.difference(e).forEach((e=>t.push(e.toString())))}else t.push(i)})),this.refs=t}getData(){const{refs:e,mode:t,validator:i}=this,{type:s,required:n,operator:r,value:l}=i;return{refs:e,mode:t,type:s,required:n,operator:r,value:l}}static valueOf({refs:e,mode:t,type:i,required:s,operator:n,value:r}){return new j(t,e,new k(i,s,r,n))}}class O{constructor(){this._=[],this.errors=new Map}getError(e,t){return this.errors.get(`${e}_${t}`)}validate(e,t,i){const s=this.get(e,t),n=`${e}_${t}`,{errors:r}=this;if(null!==s){const[e,t]=s.validator.validate(i);e?r.delete(n):r.set(n,t)}else r.delete(n);return!0}add(e,t,{type:i,required:s,value:n,operator:r}){const l=new k(i,s,n,r),o=this.getByValidator(l);null!==o?o.addRef(t):this._.push(new j(e,[t],l))}getByValidator(e){for(let t=0;t<this._.length;t+=1){const i=this._[t];if(i.validator.equals(e))return i}return null}get(e,t){for(let i=0;i<this._.length;i+=1){const s=this._[i];if(s.includes(e,t))return s}return null}remove(e){this.each((t=>{t.remove(e)}))}each(e){this._.forEach((t=>e(t)))}getData(){return this._.filter((e=>e.refs.length>0)).map((e=>e.getData()))}setData(e){this._=e.map((e=>j.valueOf(e)))}}const Z={mode:"edit",view:{height:()=>document.documentElement.clientHeight,width:()=>document.documentElement.clientWidth},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}},U=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function R(e,t,i=(()=>{})){const{merges:s}=this,n=t.clone(),[r,l]=e.size(),[o,a]=t.size();return r>o&&(n.eri=t.sri+r-1),l>a&&(n.eci=t.sci+l-1),!s.intersects(n)||(i(v("error.pasteForMergedCell")),!1)}function Y(e,t,i,s=!1){const{rows:n,merges:r}=this;"all"!==i&&"format"!==i||(n.deleteCells(t,i),r.deleteWithin(t)),n.copyPaste(e,t,i,s,((e,t,i)=>{if(i&&i.merge){const[s,n]=i.merge;if(s<=0&&n<=0)return;r.add(new d(e,t,e+s,t+n))}}))}function H(e,t){const{clipboard:i,rows:s,merges:n}=this;s.cutPaste(e,t),n.move(e,t.sri-e.sri,t.sci-e.sci),i.clear()}function W(e,t,i){const{styles:s,rows:n}=this,r=n.getCellOrNew(e,t);let l={};void 0!==r.style&&(l=y.cloneDeep(s[r.style])),l=y.merge(l,{border:i}),r.style=this.addStyle(l)}function P({mode:e,style:t,color:i}){const{styles:s,selector:n,rows:r}=this,{sri:l,sci:o,eri:a,eci:h}=n.range,c=!this.isSignleSelected();if(c||"inside"!==e&&"horizontal"!==e&&"vertical"!==e)if("outside"!==e||c){if("none"===e)n.range.each(((e,t)=>{const i=r.getCell(e,t);if(i&&void 0!==i.style){const e=y.cloneDeep(s[i.style]);delete e.border,i.style=this.addStyle(e)}}));else if("all"===e||"inside"===e||"outside"===e||"horizontal"===e||"vertical"===e){const s=[];for(let n=l;n<=a;n+=1)for(let d=o;d<=h;d+=1){const g=[];for(let e=0;e<s.length;e+=1){const[t,i,r,l]=s[e];if(n===t+r+1&&g.push(e),t<=n&&n<=t+r&&d===i){d+=l+1;break}}if(g.forEach((e=>s.splice(e,1))),d>h)break;const u=r.getCell(n,d);let[w,M]=[0,0];u&&u.merge&&([w,M]=u.merge,s.push([n,d,w,M]));const p=w>0&&n+w===a,x=M>0&&d+M===h;let f={};"all"===e?f={bottom:[t,i],top:[t,i],left:[t,i],right:[t,i]}:"inside"===e?(!x&&d<h&&(f.right=[t,i]),!p&&n<a&&(f.bottom=[t,i])):"horizontal"===e?!p&&n<a&&(f.bottom=[t,i]):"vertical"===e?!x&&d<h&&(f.right=[t,i]):"outside"===e&&c&&(l===n&&(f.top=[t,i]),(p||a===n)&&(f.bottom=[t,i]),o===d&&(f.left=[t,i]),(x||h===d)&&(f.right=[t,i])),Object.keys(f).length>0&&W.call(this,n,d,f),d+=M}}else if("top"===e||"bottom"===e)for(let s=o;s<=h;s+=1)"top"===e&&(W.call(this,l,s,{top:[t,i]}),s+=r.getCellMerge(l,s)[1]),"bottom"===e&&(W.call(this,a,s,{bottom:[t,i]}),s+=r.getCellMerge(a,s)[1]);else if("left"===e||"right"===e)for(let s=l;s<=a;s+=1)"left"===e&&(W.call(this,s,o,{left:[t,i]}),s+=r.getCellMerge(s,o)[0]),"right"===e&&(W.call(this,s,h,{right:[t,i]}),s+=r.getCellMerge(s,h)[0])}else W.call(this,l,o,{top:[t,i],bottom:[t,i],left:[t,i],right:[t,i]})}function G(e,t){const{rows:i}=this,s=this.freezeTotalHeight();let n=i.height;s+i.height<e&&(n-=t);const r=this.exceptRowSet;let l=0,o=n,{height:a}=i;for(;l<i.len&&!(o>e);l+=1)r.has(l)||(a=i.getHeight(l),o+=a);return o-=a,o<=0?{ri:-1,top:0,height:a}:{ri:l-1,top:o,height:a}}function F(e,t){const{cols:i}=this,s=this.freezeTotalWidth();let n=i.indexWidth;s+i.indexWidth<e&&(n-=t);const[r,l,o]=y.rangeReduceIf(0,i.len,n,i.indexWidth,e,(e=>i.getWidth(e)));return l<=0?{ci:-1,left:0,width:i.indexWidth}:{ci:r-1,left:l,width:o}}class Q{constructor(e,t){this.settings=y.merge(Z,t||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new D,this.rows=new E(this.settings.row),this.cols=new T(this.settings.col),this.validations=new O,this.hyperlinks={},this.comments={},this.selector=new g,this.scroll=new u,this.history=new w,this.clipboard=new M,this.autoFilter=new f,this.change=()=>{},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}addValidation(e,t,i){this.changeData((()=>{this.validations.add(e,t,i)}))}removeValidation(){const{range:e}=this.selector;this.changeData((()=>{this.validations.remove(e)}))}getSelectedValidator(){const{ri:e,ci:t}=this.selector,i=this.validations.get(e,t);return i?i.validator:null}getSelectedValidation(){const{ri:e,ci:t,range:i}=this.selector,s=this.validations.get(e,t),n={ref:i.toString()};return null!==s&&(n.mode=s.mode,n.validator=s.validator),n}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}undo(){this.history.undo(this.getData(),(e=>{this.setData(e)}))}redo(){this.history.redo(this.getData(),(e=>{this.setData(e)}))}copy(){this.clipboard.copy(this.selector.range)}copyToSystemClipboard(){if(void 0===navigator.clipboard)return;let e="";const t=this.rows.getData();for(let i=this.selector.range.sri;i<=this.selector.range.eri;i+=1){if(U(t,i)){for(let s=this.selector.range.sci;s<=this.selector.range.eci;s+=1)if(s>this.selector.range.sci&&(e+="\t"),U(t[i].cells,s)){const n=String(t[i].cells[s].text);-1===n.indexOf("\n")&&-1===n.indexOf("\t")&&-1===n.indexOf('"')?e+=n:e+=`"${n}"`}}else for(let t=this.selector.range.sci;t<=this.selector.range.eci;t+=1)e+="\t";e+="\n"}navigator.clipboard.writeText(e).then((()=>{}),(e=>{}))}cut(){this.clipboard.cut(this.selector.range)}paste(e="all",t=(()=>{})){const{clipboard:i,selector:s}=this;return!i.isClear()&&(!!R.call(this,i.range,s.range,t)&&(this.changeData((()=>{i.isCopy()?Y.call(this,i.range,s.range,e):i.isCut()&&H.call(this,i.range,s.range)})),!0))}pasteFromText(e){const t=e.split("\r\n").map((e=>e.replace(/"/g,"").split("\t")));t.length>0&&(t.length-=1);const{rows:i,selector:s}=this;this.changeData((()=>{i.paste(t,s.range)}))}autofill(e,t,i=(()=>{})){const s=this.selector.range;return!!R.call(this,s,e,i)&&(this.changeData((()=>{Y.call(this,s,e,t,!0)})),!0)}clearClipboard(){this.clipboard.clear()}calSelectedRangeByEnd(e,t){const{selector:i,rows:s,cols:n,merges:r}=this;let{sri:l,sci:o,eri:a,eci:h}=i.range;const c=i.ri,g=i.ci;let[u,w]=[e,t];return e<0&&(u=s.len-1),t<0&&(w=n.len-1),[l,a]=u>c?[c,u]:[u,c],[o,h]=w>g?[g,w]:[w,g],i.range=r.union(new d(l,o,a,h)),i.range=r.union(i.range),i.range}calSelectedRangeByStart(e,t){const{selector:i,rows:s,cols:n,merges:r}=this;let l=r.getFirstIncludes(e,t);return null===l&&(l=new d(e,t,e,t),-1===e&&(l.sri=0,l.eri=s.len-1),-1===t&&(l.sci=0,l.eci=n.len-1)),i.range=l,l}setSelectedCellAttr(e,t){this.changeData((()=>{const{selector:i,styles:s,rows:n}=this;if("merge"===e)t?this.merge():this.unmerge();else if("border"===e)P.call(this,t);else if("formula"===e){const{ri:e,ci:s,range:r}=i;if(i.multiple()){const[s,l]=i.size(),{sri:o,sci:a,eri:c,eci:d}=r;if(s>1)for(let e=a;e<=d;e+=1){n.getCellOrNew(c+1,e).text=`=${t}(${h(e,o)}:${h(e,c)})`}else if(l>1){n.getCellOrNew(e,d+1).text=`=${t}(${h(a,e)}:${h(d,e)})`}}else{n.getCellOrNew(e,s).text=`=${t}()`}}else i.range.each(((i,r)=>{const l=n.getCellOrNew(i,r);let o={};if(void 0!==l.style&&(o=y.cloneDeep(s[l.style])),"format"===e)o.format=t,l.style=this.addStyle(o);else if("font-bold"===e||"font-italic"===e||"font-name"===e||"font-size"===e){const i={};i[e.split("-")[1]]=t,o.font=Object.assign(o.font||{},i),l.style=this.addStyle(o)}else"strike"===e||"textwrap"===e||"underline"===e||"align"===e||"valign"===e||"color"===e||"bgcolor"===e?(o[e]=t,l.style=this.addStyle(o)):l[e]=t}))}))}setSelectedCellText(e,t="input"){const{autoFilter:i,selector:s,rows:n}=this,{ri:r,ci:l}=s;let o=r;this.unsortedRowMap.has(r)&&(o=this.unsortedRowMap.get(r));const a=n.getCell(o,l),h=a?a.text:"";if(this.setCellText(o,l,e,t),i.active()){const t=i.getFilter(l);if(t){const i=t.value.findIndex((e=>e===h));i>=0&&t.value.splice(i,1,e)}}}getSelectedCell(){const{ri:e,ci:t}=this.selector;let i=e;return this.unsortedRowMap.has(e)&&(i=this.unsortedRowMap.get(e)),this.rows.getCell(i,t)}xyInSelectedRect(e,t){const{left:i,top:s,width:n,height:r}=this.getSelectedRect(),l=e-this.cols.indexWidth,o=t-this.rows.height;return l>i&&l<i+n&&o>s&&o<s+r}getSelectedRect(){return this.getRect(this.selector.range)}getClipboardRect(){const{clipboard:e}=this;return e.isClear()?{left:-100,top:-100}:this.getRect(e.range)}getRect(e){const{scroll:t,rows:i,cols:s,exceptRowSet:n}=this,{sri:r,sci:l,eri:o,eci:a}=e;if(r<0&&l<0)return{left:0,l:0,top:0,t:0,scroll:t};const h=s.sumWidth(0,l),c=i.sumHeight(0,r,n),d=i.sumHeight(r,o+1,n),g=s.sumWidth(l,a+1);let u=h-t.x,w=c-t.y;const M=this.freezeTotalHeight(),p=this.freezeTotalWidth();return p>0&&p>h&&(u=h),M>0&&M>c&&(w=c),{l:h,t:c,left:u,top:w,height:d,width:g,scroll:t}}getCellRectByXY(e,t){const{scroll:i,merges:s,rows:n,cols:r}=this;let{ri:l,top:o,height:a}=G.call(this,t,i.y),{ci:h,left:c,width:d}=F.call(this,e,i.x);if(-1===h&&(d=r.totalWidth()),-1===l&&(a=n.totalHeight()),l>=0||h>=0){const e=s.getFirstIncludes(l,h);e&&(l=e.sri,h=e.sci,({left:c,top:o,width:d,height:a}=this.cellRect(l,h)))}return{ri:l,ci:h,left:c,top:o,width:d,height:a}}isSignleSelected(){const{sri:e,sci:t,eri:i,eci:s}=this.selector.range,n=this.getCell(e,t);if(n&&n.merge){const[r,l]=n.merge;if(e+r===i&&t+l===s)return!0}return!this.selector.multiple()}canUnmerge(){const{sri:e,sci:t,eri:i,eci:s}=this.selector.range,n=this.getCell(e,t);if(n&&n.merge){const[r,l]=n.merge;if(e+r===i&&t+l===s)return!0}return!1}merge(){const{selector:e,rows:t}=this;if(this.isSignleSelected())return;const[i,s]=e.size();if(i>1||s>1){const{sri:n,sci:r}=e.range;this.changeData((()=>{const l=t.getCellOrNew(n,r);l.merge=[i-1,s-1],this.merges.add(e.range),this.rows.deleteCells(e.range),this.rows.setCell(n,r,l)}))}}unmerge(){const{selector:e}=this;if(!this.isSignleSelected())return;const{sri:t,sci:i}=e.range;this.changeData((()=>{this.rows.deleteCell(t,i,"merge"),this.merges.deleteWithin(e.range)}))}canAutofilter(){return!this.autoFilter.active()}autofilter(){const{autoFilter:e,selector:t}=this;this.changeData((()=>{e.active()?(e.clear(),this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map):e.ref=t.range.toString()}))}setAutoFilter(e,t,i,s){const{autoFilter:n}=this;n.addFilter(e,i,s),n.setSort(e,t),this.resetAutoFilter()}resetAutoFilter(){const{autoFilter:e,rows:t}=this;if(!e.active())return;const{sort:i}=e,{rset:s,fset:n}=e.filteredRows(((e,i)=>t.getCell(e,i))),r=Array.from(n),l=Array.from(n);i&&r.sort(((e,t)=>"asc"===i.order?e-t:"desc"===i.order?t-e:0)),this.exceptRowSet=s,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,r.forEach(((e,t)=>{this.sortedRowMap.set(l[t],e),this.unsortedRowMap.set(e,l[t])}))}deleteCell(e="all"){const{selector:t}=this;this.changeData((()=>{this.rows.deleteCells(t.range,e),"all"!==e&&"format"!==e||this.merges.deleteWithin(t.range)}))}insert(e,t=1){this.changeData((()=>{const{sri:i,sci:s}=this.selector.range,{rows:n,merges:r,cols:l}=this;let o=i;"row"===e?n.insert(i,t):"column"===e&&(n.insertColumn(s,t),o=s,l.len+=1),r.shift(e,o,t,((e,t,i,s)=>{const r=n.getCell(e,t);r.merge[0]+=i,r.merge[1]+=s}))}))}delete(e){this.changeData((()=>{const{rows:t,merges:i,selector:s,cols:n}=this,{range:r}=s,{sri:l,sci:o,eri:a,eci:h}=s.range,[c,d]=s.range.size();let g=l,u=c;"row"===e?t.delete(l,a):"column"===e&&(t.deleteColumn(o,h),g=r.sci,u=d,n.len-=1),i.shift(e,g,-u,((e,i,s,n)=>{const r=t.getCell(e,i);r.merge[0]+=s,r.merge[1]+=n,0===r.merge[0]&&0===r.merge[1]&&delete r.merge}))}))}scrollx(e,t){const{scroll:i,freeze:s,cols:n}=this,[,r]=s,[l,o,a]=y.rangeReduceIf(r,n.len,0,0,e,(e=>n.getWidth(e)));let h=o;e>0&&(h+=a),i.x!==h&&(i.ci=e>0?l:0,i.x=h,t())}scrolly(e,t){const{scroll:i,freeze:s,rows:n}=this,[r]=s,[l,o,a]=y.rangeReduceIf(r,n.len,0,0,e,(e=>n.getHeight(e)));let h=o;e>0&&(h+=a),i.y!==h&&(i.ri=e>0?l:0,i.y=h,t())}cellRect(e,t){const{rows:i,cols:s}=this,n=s.sumWidth(0,t),r=i.sumHeight(0,e),l=i.getCell(e,t);let o=s.getWidth(t),a=i.getHeight(e);if(null!==l&&l.merge){const[n,r]=l.merge;if(n>0)for(let t=1;t<=n;t+=1)a+=i.getHeight(e+t);if(r>0)for(let e=1;e<=r;e+=1)o+=s.getWidth(t+e)}return{left:n,top:r,width:o,height:a,cell:l}}getCell(e,t){return this.rows.getCell(e,t)}getCellTextOrDefault(e,t){const i=this.getCell(e,t);return i&&i.text?i.text:""}getCellStyle(e,t){const i=this.getCell(e,t);return i&&void 0!==i.style?this.styles[i.style]:null}getCellStyleOrDefault(e,t){const{styles:i,rows:s}=this,n=s.getCell(e,t),r=n&&void 0!==n.style?i[n.style]:{};return y.merge(this.defaultStyle(),r)}getSelectedCellStyle(){const{ri:e,ci:t}=this.selector;return this.getCellStyleOrDefault(e,t)}setCellText(e,t,i,s){const{rows:n,history:r,validations:l}=this;"finished"===s?(n.setCellText(e,t,""),r.add(this.getData()),n.setCellText(e,t,i)):(n.setCellText(e,t,i),this.change(this.getData())),l.validate(e,t,i)}freezeIsActive(){const[e,t]=this.freeze;return e>0||t>0}setFreeze(e,t){this.changeData((()=>{this.freeze=[e,t]}))}freezeTotalWidth(){return this.cols.sumWidth(0,this.freeze[1])}freezeTotalHeight(){return this.rows.sumHeight(0,this.freeze[0])}setRowHeight(e,t){this.changeData((()=>{this.rows.setHeight(e,t)}))}setColWidth(e,t){this.changeData((()=>{this.cols.setWidth(e,t)}))}viewHeight(){const{view:e,showToolbar:t,showBottomBar:i}=this.settings;let s=e.height();return i&&(s-=41),t&&(s-=41),s}viewWidth(){return this.settings.view.width()}freezeViewRange(){const[e,t]=this.freeze;return new d(0,0,e-1,t-1,this.freezeTotalWidth(),this.freezeTotalHeight())}contentRange(){const{rows:e,cols:t}=this,[i,s]=e.maxCell(),n=e.sumHeight(0,i+1),r=t.sumWidth(0,s+1);return new d(0,0,i,s,r,n)}exceptRowTotalHeight(e,t){const{exceptRowSet:i,rows:s}=this,n=Array.from(i);let r=0;return n.forEach((i=>{if(i<e||i>t){const e=s.getHeight(i);r+=e}})),r}viewRange(){const{scroll:e,rows:t,cols:i,freeze:s,exceptRowSet:n}=this;let{ri:r,ci:l}=e;r<=0&&([r]=s),l<=0&&([,l]=s);let[o,a]=[0,0],[h,c]=[t.len,i.len];for(let e=r;e<t.len&&(n.has(e)||(a+=t.getHeight(e),h=e),!(a>this.viewHeight()));e+=1);for(let e=l;e<i.len&&(o+=i.getWidth(e),c=e,!(o>this.viewWidth()));e+=1);return new d(r,l,h,c,o,a)}eachMergesInView(e,t){this.merges.filterIntersects(e).forEach((e=>t(e)))}hideRowsOrCols(){const{rows:e,cols:t,selector:i}=this,[s,n]=i.size(),{sri:r,sci:l,eri:o,eci:a}=i.range;if(s===e.len)for(let e=l;e<=a;e+=1)t.setHide(e,!0);else if(n===t.len)for(let t=r;t<=o;t+=1)e.setHide(t,!0)}unhideRowsOrCols(e,t){this[`${e}s`].unhide(t)}rowEach(e,t,i){let s=0;const{rows:n}=this,r=this.exceptRowSet,l=[...r];let o=0;for(let t=0;t<l.length;t+=1)l[t]<e&&(o+=1);for(let l=e+o;l<=t+o;l+=1)if(r.has(l))o+=1;else{const e=n.getHeight(l);if(e>0&&(i(l,s,e),s+=e,s>this.viewHeight()))break}}colEach(e,t,i){let s=0;const{cols:n}=this;for(let r=e;r<=t;r+=1){const e=n.getWidth(r);if(e>0&&(i(r,s,e),s+=e,s>this.viewWidth()))break}}defaultStyle(){return this.settings.style}addStyle(e){const{styles:t}=this;for(let i=0;i<t.length;i+=1){const s=t[i];if(y.equals(s,e))return i}return t.push(e),t.length-1}changeData(e){this.history.add(this.getData()),e(),this.change(this.getData())}setData(e){return Object.keys(e).forEach((t=>{if("merges"===t||"rows"===t||"cols"===t||"validations"===t)this[t].setData(e[t]);else if("freeze"===t){const[i,s]=a(e[t]);this.freeze=[s,i]}else"autofilter"===t?this.autoFilter.setData(e[t]):void 0!==e[t]&&(this[t]=e[t])})),this}getData(){const{name:e,freeze:t,styles:i,merges:s,rows:n,cols:r,validations:l,autoFilter:o}=this;return{name:e,freeze:h(t[1],t[0]),styles:i,merges:s.getData(),rows:n.getData(),cols:r.getData(),validations:l.getData(),autofilter:o.getData()}}}function J(e,t,i){e.addEventListener(t,i)}function V(e,t,i){e.removeEventListener(t,i)}function K(e){e.xclickoutside&&(V(window.document.body,"click",e.xclickoutside),delete e.xclickoutside)}function X(e,t){e.xclickoutside=i=>{2===i.detail||e.contains(i.target)||(t?t(e):(e.hide(),K(e)))},J(window.document.body,"click",e.xclickoutside)}function _(e,t,i){J(e,"mousemove",t);e.xEvtUp=s=>{V(e,"mousemove",t),V(e,"mouseup",e.xEvtUp),i(s)},J(e,"mouseup",e.xEvtUp)}function q(e,t,i,s){let n="";Math.abs(e)>Math.abs(t)?(n=e>0?"right":"left",s(n,e,i)):(n=t>0?"down":"up",s(n,t,i))}const ee="x-spreadsheet";window.devicePixelRatio;class te{constructor(e=!1,t){this.moving=!1,this.vertical=e,this.el=n("div",`${ee}-resizer ${e?"vertical":"horizontal"}`).children(this.unhideHoverEl=n("div",`${ee}-resizer-hover`).on("dblclick.stop",(e=>this.mousedblclickHandler(e))).css("position","absolute").hide(),this.hoverEl=n("div",`${ee}-resizer-hover`).on("mousedown.stop",(e=>this.mousedownHandler(e))),this.lineEl=n("div",`${ee}-resizer-line`).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=t,this.unhideFn=()=>{}}showUnhide(e){this.unhideIndex=e,this.unhideHoverEl.show()}hideUnhide(){this.unhideHoverEl.hide()}show(e,t){const{moving:i,vertical:s,hoverEl:n,lineEl:r,el:l,unhideHoverEl:o}=this;if(i)return;this.cRect=e;const{left:a,top:h,width:c,height:d}=e;l.offset({left:s?a+c-5:a,top:s?h:h+d-5}).show(),n.offset({width:s?5:c,height:s?d:5}),r.offset({width:s?0:t.width,height:s?t.height:0}),o.offset({left:s?5-c:a,top:s?h:5-d,width:s?5:c,height:s?d:5})}hide(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}mousedblclickHandler(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}mousedownHandler(e){let t=e;const{el:i,lineEl:s,cRect:n,vertical:r,minDistance:l}=this;let o=r?n.width:n.height;s.show(),_(window,(e=>{this.moving=!0,null!==t&&1===e.buttons&&(r?(o+=e.movementX,o>l&&i.css("left",`${n.left+o}px`)):(o+=e.movementY,o>l&&i.css("top",`${n.top+o}px`)),t=e)}),(()=>{t=null,s.hide(),this.moving=!1,this.hide(),this.finishedFn&&(o<l&&(o=l),this.finishedFn(n,o))}))}}class ie{constructor(e){this.vertical=e,this.moveFn=null,this.el=n("div",`${ee}-scrollbar ${e?"vertical":"horizontal"}`).child(this.contentEl=n("div","")).on("mousemove.stop",(()=>{})).on("scroll.stop",(e=>{const{scrollTop:t,scrollLeft:i}=e.target;this.moveFn&&this.moveFn(this.vertical?t:i,e)}))}move(e){return this.el.scroll(e),this}scroll(){return this.el.scroll()}set(e,t){const i=e-1;if(t>i){const e=this.vertical?"height":"width";this.el.css(e,i-15+"px").show(),this.contentEl.css(this.vertical?"width":"height","1px").css(e,`${t}px`)}else this.el.hide();return this}}let se=10;class ne{constructor(e=!1){this.useHideInput=e,this.inputChange=()=>{},this.cornerEl=n("div",`${ee}-selector-corner`),this.areaEl=n("div",`${ee}-selector-area`).child(this.cornerEl).hide(),this.clipboardEl=n("div",`${ee}-selector-clipboard`).hide(),this.autofillEl=n("div",`${ee}-selector-autofill`).hide(),this.el=n("div",`${ee}-selector`).css("z-index",`${se}`).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),e&&(this.hideInput=n("input","").on("compositionend",(e=>{this.inputChange(e.target.value)})),this.el.child(this.hideInputDiv=n("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=n("div","hide-input").child(this.hideInput))),se+=1}setOffset(e){return this.el.offset(e).show(),this}hide(){return this.el.hide(),this}setAreaOffset(e){const{left:t,top:i,width:s,height:n}=e,r={width:s-3+.8,height:n-3+.8,left:t-.8,top:i-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.hideInput.val("").focus())}setClipboardOffset(e){const{left:t,top:i,width:s,height:n}=e;this.clipboardEl.offset({left:t,top:i,width:s-5,height:n-5})}showAutofill(e){const{left:t,top:i,width:s,height:n}=e;this.autofillEl.offset({width:s-3,height:n-3,left:t,top:i}).show()}hideAutofill(){this.autofillEl.hide()}showClipboard(){this.clipboardEl.show()}hideClipboard(){this.clipboardEl.hide()}}function re(e){const{data:t}=this,{left:i,top:s,width:n,height:r,scroll:l,l:o,t:a}=e,h=t.freezeTotalWidth(),c=t.freezeTotalHeight();let d=i-h;h>o&&(d-=l.x);let g=s-c;return c>a&&(g-=l.y),{left:d,top:g,width:n,height:r}}function le(e){const{data:t}=this,{left:i,width:s,height:n,l:r,t:l,scroll:o}=e,a=t.freezeTotalWidth();let h=i-a;return a>r&&(h-=o.x),{left:h,top:l,width:s,height:n}}function oe(e){const{data:t}=this,{top:i,width:s,height:n,l:r,t:l,scroll:o}=e,a=t.freezeTotalHeight();let h=i-a;return a>l&&(h-=o.y),{left:r,top:h,width:s,height:n}}function ae(e){const{br:t}=this;t.setAreaOffset(re.call(this,e))}function he(e){const{tl:t}=this;t.setAreaOffset(e)}function ce(e){const{t}=this;t.setAreaOffset(le.call(this,e))}function de(e){const{l:t}=this;t.setAreaOffset(oe.call(this,e))}function ge(e){const{l:t}=this;t.setClipboardOffset(oe.call(this,e))}function ue(e){const{br:t}=this;t.setClipboardOffset(re.call(this,e))}function we(e){const{tl:t}=this;t.setClipboardOffset(e)}function Me(e){const{t}=this;t.setClipboardOffset(le.call(this,e))}function pe(e){ae.call(this,e),he.call(this,e),ce.call(this,e),de.call(this,e)}function xe(e){ue.call(this,e),we.call(this,e),Me.call(this,e),ge.call(this,e)}class fe{constructor(e){this.inputChange=()=>{},this.data=e,this.br=new ne(!0),this.t=new ne,this.l=new ne,this.tl=new ne,this.br.inputChange=e=>{this.inputChange(e)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=n("div",`${ee}-selectors`).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,se+=1}resetData(e){this.data=e,this.range=e.selector.range,this.resetAreaOffset()}hide(){this.el.hide()}resetOffset(){const{data:e,tl:t,t:i,l:s,br:n}=this,r=e.freezeTotalHeight(),l=e.freezeTotalWidth();r>0||l>0?(t.setOffset({width:l,height:r}),i.setOffset({left:l,height:r}),s.setOffset({top:r,width:l}),n.setOffset({left:l,top:r})):(t.hide(),i.hide(),s.hide(),n.setOffset({left:0,top:0}))}resetAreaOffset(){const e=this.data.getSelectedRect(),t=this.data.getClipboardRect();pe.call(this,e),xe.call(this,t),this.resetOffset()}resetBRTAreaOffset(){const e=this.data.getSelectedRect(),t=this.data.getClipboardRect();ae.call(this,e),ce.call(this,e),ue.call(this,t),Me.call(this,t),this.resetOffset()}resetBRLAreaOffset(){const e=this.data.getSelectedRect(),t=this.data.getClipboardRect();ae.call(this,e),de.call(this,e),ue.call(this,t),ge.call(this,t),this.resetOffset()}set(e,t,i=!0){const{data:s}=this,n=s.calSelectedRangeByStart(e,t),{sri:r,sci:l}=n;if(i){let[i,n]=[e,t];e<0&&(i=0),t<0&&(n=0),s.selector.setIndexes(i,n),this.indexes=[i,n]}this.moveIndexes=[r,l],this.range=n,this.resetAreaOffset(),this.el.show()}setEnd(e,t,i=!0){const{data:s,lastri:n,lastci:r}=this;if(i){if(e===n&&t===r)return;this.lastri=e,this.lastci=t}this.range=s.calSelectedRangeByEnd(e,t),pe.call(this,this.data.getSelectedRect())}reset(){const{eri:e,eci:t}=this.data.selector.range;this.setEnd(e,t)}showAutofill(e,t){if(-1===e&&-1===t)return;const{sri:i,sci:s,eri:n,eci:r}=this.range,[l,o]=[e,t],a=i-e,h=n-e,c=r-t;if(s-t>0)this.arange=new d(i,o,n,s-1);else if(a>0)this.arange=new d(l,s,i-1,r);else if(c<0)this.arange=new d(i,r+1,n,o);else{if(!(h<0))return void(this.arange=null);this.arange=new d(n+1,s,l,r)}if(null!==this.arange){const e=this.data.getRect(this.arange);e.width+=2,e.height+=2;const{br:t,l:i,t:s,tl:n}=this;t.showAutofill(re.call(this,e)),i.showAutofill(oe.call(this,e)),s.showAutofill(le.call(this,e)),n.showAutofill(e)}}hideAutofill(){["br","l","t","tl"].forEach((e=>{this[e].hideAutofill()}))}showClipboard(){const e=this.data.getClipboardRect();xe.call(this,e),["br","l","t","tl"].forEach((e=>{this[e].showClipboard()}))}hideClipboard(){["br","l","t","tl"].forEach((e=>{this[e].hideClipboard()}))}}function De(e){e.preventDefault(),e.stopPropagation();const{filterItems:t}=this;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1),t[this.itemIndex].toggle())}function Ie(e){e.stopPropagation();const{filterItems:t}=this;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0),t[this.itemIndex].toggle())}function me(e){e.preventDefault();const{filterItems:t}=this;t.length<=0||(e.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),t[this.itemIndex].el.click(),this.hide())}function be(e){const{keyCode:t}=e;switch(e.ctrlKey&&e.stopPropagation(),t){case 37:case 39:default:e.stopPropagation();break;case 38:De.call(this,e);break;case 40:Ie.call(this,e);break;case 13:case 9:me.call(this,e)}}class ye{constructor(e,t,i="200px"){this.filterItems=[],this.items=e,this.el=n("div",`${ee}-suggest`).css("width",i).hide(),this.itemClick=t,this.itemIndex=-1}setOffset(e){this.el.cssRemoveKeys("top","bottom").offset(e)}hide(){const{el:e}=this;this.filterItems=[],this.itemIndex=-1,e.hide(),K(this.el.parent())}setItems(e){this.items=e}search(e){let{items:t}=this;if(/^\s*$/.test(e)||(t=t.filter((t=>(t.key||t).startsWith(e.toUpperCase())))),t=t.map((e=>{let{title:t}=e;t?"function"==typeof t&&(t=t()):t=e;const i=n("div",`${ee}-item`).child(t).on("click.stop",(()=>{this.itemClick(e),this.hide()}));return e.label&&i.child(n("div","label").html(e.label)),i})),this.filterItems=t,t.length<=0)return;const{el:i}=this;i.html("").children(...t).show(),X(i.parent(),(()=>{this.hide()}))}bindInputEvents(e){e.on("keydown",(e=>be.call(this,e)))}}class Ee extends s{constructor(e){super("div",`${ee}-icon`),this.iconNameEl=n("div",`${ee}-icon-img ${e}`),this.child(this.iconNameEl)}setName(e){this.iconNameEl.className(`${ee}-icon-img ${e}`)}}function Te(e,t){e.setMonth(e.getMonth()+t)}function Ne(e,t){const i=new Date(e);return i.setDate(t-e.getDay()+1),i}class Le{constructor(e){this.value=e,this.cvalue=new Date(e),this.headerLeftEl=n("div","calendar-header-left"),this.bodyEl=n("tbody",""),this.buildAll(),this.el=n("div","x-spreadsheet-calendar").children(n("div","calendar-header").children(this.headerLeftEl,n("div","calendar-header-right").children(n("a","calendar-prev").on("click.stop",(()=>this.prev())).child(new Ee("chevron-left")),n("a","calendar-next").on("click.stop",(()=>this.next())).child(new Ee("chevron-right")))),n("table","calendar-body").children(n("thead","").child(n("tr","").children(...v("calendar.weeks").map((e=>n("th","cell").child(e))))),this.bodyEl)),this.selectChange=()=>{}}setValue(e){this.value=e,this.cvalue=new Date(e),this.buildAll()}prev(){const{value:e}=this;Te(e,-1),this.buildAll()}next(){const{value:e}=this;Te(e,1),this.buildAll()}buildAll(){this.buildHeaderLeft(),this.buildBody()}buildHeaderLeft(){const{value:e}=this;this.headerLeftEl.html(`${v("calendar.months")[e.getMonth()]} ${e.getFullYear()}`)}buildBody(){const{value:e,cvalue:t,bodyEl:i}=this,s=function(e,t,i){const s=new Date(e,t,1,23,59,59),n=[[],[],[],[],[],[]];for(let e=0;e<6;e+=1)for(let r=0;r<7;r+=1){const l=Ne(s,7*e+r),o=l.getMonth()!==t,a=l.getMonth()===i.getMonth()&&l.getDate()===i.getDate();n[e][r]={d:l,disabled:o,active:a}}return n}(e.getFullYear(),e.getMonth(),t).map((e=>{const t=e.map((e=>{let t="cell";return e.disabled&&(t+=" disabled"),e.active&&(t+=" active"),n("td","").child(n("div",t).on("click.stop",(()=>{this.selectChange(e.d)})).child(e.d.getDate().toString()))}));return n("tr","").children(...t)}));i.html("").children(...s)}}class Ce{constructor(){this.calendar=new Le(new Date),this.el=n("div",`${ee}-datepicker`).child(this.calendar.el).hide()}setValue(e){const{calendar:t}=this;return"string"==typeof e?/^\d{4}-\d{1,2}-\d{1,2}$/.test(e)&&t.setValue(new Date(e.replace(new RegExp("-","g"),"/"))):e instanceof Date&&t.setValue(e),this}change(e){this.calendar.selectChange=t=>{e(t),this.hide()}}show(){this.el.show()}hide(){this.el.hide()}}function ve(){const{inputText:e}=this;if(!/^\s*$/.test(e)){const{textlineEl:t,textEl:i,areaOffset:s}=this,n=e.split("\n"),r=Math.max(...n.map((e=>e.length))),l=t.offset().width/e.length,o=(r+1)*l+5,a=this.viewFn().width-s.left-l;let h=n.length;if(o>s.width){let e=o;o>a&&(e=a,h+=parseInt(o/a,10),h+=o%a>0?1:0),i.css("width",`${e}px`)}h*=this.rowHeight,h>s.height&&i.css("height",`${h}px`)}}function Se({target:e},t){const{value:i,selectionEnd:s}=e,n=`${i.slice(0,s)}${t}${i.slice(s)}`;e.value=n,e.setSelectionRange(s+1,s+1),this.inputText=n,this.textlineEl.html(n),ve.call(this)}function Ae(e){const{keyCode:t,altKey:i}=e;13!==t&&9!==t&&e.stopPropagation(),13===t&&i&&(Se.call(this,e,"\n"),e.stopPropagation()),13!==t||i||e.preventDefault()}function ze(e){const t=e.target.value,{suggest:i,textlineEl:s,validator:n}=this,{cell:r}=this;if(null!==r)if("editable"in r&&!0===r.editable||void 0===r.editable){if(this.inputText=t,n)"list"===n.type?i.search(t):i.hide();else{const e=t.lastIndexOf("=");-1!==e?i.search(t.substring(e+1)):i.hide()}s.html(t),ve.call(this),this.change("input",t)}else e.target.value=r.text;else{if(this.inputText=t,n)"list"===n.type?i.search(t):i.hide();else{const e=t.lastIndexOf("=");-1!==e?i.search(t.substring(e+1)):i.hide()}s.html(t),ve.call(this),this.change("input",t)}}function Be(e){const{el:t}=this.textEl;setTimeout((()=>{t.focus(),t.setSelectionRange(e,e)}),0)}function ke(e,t){const{textEl:i,textlineEl:s}=this;i.el.blur(),i.val(e),s.html(e),Be.call(this,t)}function je(e){const{inputText:t,validator:i}=this;let s=0;if(i&&"list"===i.type)this.inputText=e,s=this.inputText.length;else{const i=t.lastIndexOf("="),n=t.substring(0,i+1);let r=t.substring(i+1);r=-1!==r.indexOf(")")?r.substring(r.indexOf(")")):"",this.inputText=`${n+e.key}(`,s=this.inputText.length,this.inputText+=`)${r}`}ke.call(this,this.inputText,s)}function Oe(){this.suggest.setItems(this.formulas)}class Ze{constructor(e,t,i){this.viewFn=t,this.rowHeight=i,this.formulas=e,this.suggest=new ye(e,(e=>{je.call(this,e)})),this.datepicker=new Ce,this.datepicker.change((e=>{this.setText(function(e){let t=e.getMonth()+1,i=e.getDate();return t<10&&(t=`0${t}`),i<10&&(i=`0${i}`),`${e.getFullYear()}-${t}-${i}`}(e)),this.clear()})),this.areaEl=n("div",`${ee}-editor-area`).children(this.textEl=n("textarea","").on("input",(e=>ze.call(this,e))).on("paste.stop",(()=>{})).on("keydown",(e=>Ae.call(this,e))),this.textlineEl=n("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(()=>{})).on("mousedown.stop",(()=>{})),this.el=n("div",`${ee}-editor`).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=()=>{}}setFreezeLengths(e,t){this.freeze.w=e,this.freeze.h=t}clear(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Oe.call(this),this.datepicker.hide()}setOffset(e,t="top"){const{textEl:i,areaEl:s,suggest:n,freeze:r,el:l}=this;if(e){this.areaOffset=e;const{left:o,top:a,width:h,height:c,l:d,t:g}=e,u={left:0,top:0};r.w>d&&r.h>g||(r.w<d&&r.h<g?(u.left=r.w,u.top=r.h):r.w>d?u.top=r.h:r.h>g&&(u.left=r.w)),l.offset(u),s.offset({left:o-u.left-.8,top:a-u.top-.8}),i.offset({width:h-9+.8,height:c-3+.8});const w={left:0};w[t]=c,n.setOffset(w),n.hide()}}setCell(e,t){const{el:i,datepicker:s,suggest:n}=this;i.show(),this.cell=e;const r=e&&e.text||"";if(this.setText(r),this.validator=t,t){const{type:e}=t;"date"===e&&(s.show(),/^\s*$/.test(r)||s.setValue(r)),"list"===e&&(n.setItems(t.values()),n.search(""))}}setText(e){this.inputText=e,ke.call(this,e,e.length),ve.call(this)}}class Ue extends s{constructor(e,t=""){super("div",`${ee}-button ${t}`),this.child(v(`button.${e}`))}}function Re(){return window.devicePixelRatio||1}function Ye(){return Re()-.5}function He(e){return parseInt(e*Re(),10)}function We(e){const t=He(e);return t>0?t-.5:.5}class Pe{constructor(e,t,i,s,n=0){this.x=e,this.y=t,this.width=i,this.height=s,this.padding=n,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}setBorders({top:e,bottom:t,left:i,right:s}){e&&(this.borderTop=e),s&&(this.borderRight=s),t&&(this.borderBottom=t),i&&(this.borderLeft=i)}innerWidth(){return this.width-2*this.padding-2}innerHeight(){return this.height-2*this.padding-2}textx(e){const{width:t,padding:i}=this;let{x:s}=this;return"left"===e?s+=i:"center"===e?s+=t/2:"right"===e&&(s+=t-i),s}texty(e,t){const{height:i,padding:s}=this;let{y:n}=this;return"top"===e?n+=s:"middle"===e?n+=i/2-t/2:"bottom"===e&&(n+=i-s-t),n}topxys(){const{x:e,y:t,width:i}=this;return[[e,t],[e+i,t]]}rightxys(){const{x:e,y:t,width:i,height:s}=this;return[[e+i,t],[e+i,t+s]]}bottomxys(){const{x:e,y:t,width:i,height:s}=this;return[[e,t+s],[e+i,t+s]]}leftxys(){const{x:e,y:t,height:i}=this;return[[e,t],[e,t+i]]}}function Ge(e,t,i,s,n,r,l){const o={x:0,y:0};"underline"===e?o.y="bottom"===n?0:"top"===n?-(r+2):-r/2:"strike"===e&&("bottom"===n?o.y=r/2:"top"===n&&(o.y=-(r/2+2))),"center"===s?o.x=l/2:"right"===s&&(o.x=l),this.line([t-o.x,i-o.y],[t-o.x+l,i-o.y])}class Fe{constructor(e,t,i){this.el=e,this.ctx=e.getContext("2d"),this.resize(t,i),this.ctx.scale(Re(),Re())}resize(e,t){this.el.style.width=`${e}px`,this.el.style.height=`${t}px`,this.el.width=He(e),this.el.height=He(t)}clear(){const{width:e,height:t}=this.el;return this.ctx.clearRect(0,0,e,t),this}attr(e){return Object.assign(this.ctx,e),this}save(){return this.ctx.save(),this.ctx.beginPath(),this}restore(){return this.ctx.restore(),this}beginPath(){return this.ctx.beginPath(),this}translate(e,t){return this.ctx.translate(He(e),He(t)),this}scale(e,t){return this.ctx.scale(e,t),this}clearRect(e,t,i,s){return this.ctx.clearRect(e,t,i,s),this}fillRect(e,t,i,s){return this.ctx.fillRect(He(e)-.5,He(t)-.5,He(i),He(s)),this}fillText(e,t,i){return this.ctx.fillText(e,He(t),He(i)),this}text(e,t,i={},s=!0){const{ctx:n}=this,{align:r,valign:l,font:o,color:a,strike:h,underline:c}=i,d=t.textx(r);n.save(),n.beginPath(),this.attr({textAlign:r,textBaseline:l,font:`${o.italic?"italic":""} ${o.bold?"bold":""} ${He(o.size)}px ${o.name}`,fillStyle:a,strokeStyle:a});const g=`${e}`.split("\n"),u=t.innerWidth(),w=[];g.forEach((e=>{const t=n.measureText(e).width;if(s&&t>He(u)){let t={w:0,len:0,start:0};for(let i=0;i<e.length;i+=1)t.w>=He(u)&&(w.push(e.substr(t.start,t.len)),t={w:0,len:0,start:i}),t.len+=1,t.w+=n.measureText(e[i]).width+1;t.len>0&&w.push(e.substr(t.start,t.len))}else w.push(e)}));const M=(w.length-1)*(o.size+2);let p=t.texty(l,M);return w.forEach((e=>{const t=n.measureText(e).width;this.fillText(e,d,p),h&&Ge.call(this,"strike",d,p,r,l,o.size,t),c&&Ge.call(this,"underline",d,p,r,l,o.size,t),p+=o.size+2})),n.restore(),this}border(e,t){const{ctx:i}=this;return i.lineWidth=Ye,i.strokeStyle=t,"medium"===e?i.lineWidth=He(2)-.5:"thick"===e?i.lineWidth=He(3):"dashed"===e?i.setLineDash([He(3),He(2)]):"dotted"===e?i.setLineDash([He(1),He(1)]):"double"===e&&i.setLineDash([He(2),0]),this}line(...e){const{ctx:t}=this;if(e.length>1){t.beginPath();const[i,s]=e[0];t.moveTo(We(i),We(s));for(let i=1;i<e.length;i+=1){const[s,n]=e[i];t.lineTo(We(s),We(n))}t.stroke()}return this}strokeBorders(e){const{ctx:t}=this;t.save();const{borderTop:i,borderRight:s,borderBottom:n,borderLeft:r}=e;i&&(this.border(...i),this.line(...e.topxys())),s&&(this.border(...s),this.line(...e.rightxys())),n&&(this.border(...n),this.line(...e.bottomxys())),r&&(this.border(...r),this.line(...e.leftxys())),t.restore()}dropdown(e){const{ctx:t}=this,{x:i,y:s,width:n,height:r}=e,l=i+n-15,o=s+r-15;t.save(),t.beginPath(),t.moveTo(He(l),He(o)),t.lineTo(He(l+8),He(o)),t.lineTo(He(l+4),He(o+6)),t.closePath(),t.fillStyle="rgba(0, 0, 0, .45)",t.fill(),t.restore()}error(e){const{ctx:t}=this,{x:i,y:s,width:n}=e,r=i+n-1;t.save(),t.beginPath(),t.moveTo(He(r-8),He(s-1)),t.lineTo(He(r),He(s-1)),t.lineTo(He(r),He(s+8)),t.closePath(),t.fillStyle="rgba(255, 0, 0, .65)",t.fill(),t.restore()}frozen(e){const{ctx:t}=this,{x:i,y:s,width:n}=e,r=i+n-1;t.save(),t.beginPath(),t.moveTo(He(r-8),He(s-1)),t.lineTo(He(r),He(s-1)),t.lineTo(He(r),He(s+8)),t.closePath(),t.fillStyle="rgba(0, 255, 0, .85)",t.fill(),t.restore()}rect(e,t){const{ctx:i}=this,{x:s,y:n,width:r,height:l,bgcolor:o}=e;i.save(),i.beginPath(),i.fillStyle=o||"#fff",i.rect(We(s+1),We(n+1),He(r-2),He(l-2)),i.clip(),i.fill(),t(),i.restore()}}const Qe=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Je=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];const $e=(e,t)=>{const[i]=e;let s=e;if('"'===i)return e.substring(1);let n=1;if("-"===i&&(s=e.substring(1),n=-1),s[0]>="0"&&s[0]<="9")return n*Number(s);const[r,l]=a(s);return n*t(r,l)},Ve=(e,t,i,s=[])=>{if("="===e[0]){const n=(e=>{const t=[],i=[];let s=[],n=0,r="",l=1,o="";for(let c=0;c<e.length;c+=1){const d=e.charAt(c);if(" "!==d){if(d>="a"&&d<="z")s.push(d.toUpperCase());else if(d>="0"&&d<="9"||d>="A"&&d<="Z"||"."===d)s.push(d);else if('"'===d){for(c+=1;'"'!==e.charAt(c);)s.push(e.charAt(c)),c+=1;i.push(`"${s.join("")}`),s=[]}else if("-"===d&&/[+\-*/,(]/.test(o))s.push(d);else{if("("!==d&&s.length>0&&i.push(s.join("")),")"===d){let e=t.pop();if(2===n)try{const[t,s]=a(i.pop()),[n,r]=a(i.pop());let l=0;for(let e=n;e<=t;e+=1)for(let t=r;t<=s;t+=1)i.push(h(e,t)),l+=1;i.push([e,l])}catch(e){}else if(1===n||3===n)3===n&&i.push(r),i.push([e,l]),l=1;else for(;"("!==e&&(i.push(e),!(t.length<=0));)e=t.pop();n=0}else if("="===d||">"===d||"<"===d){const t=e.charAt(c+1);r=d,"="!==t&&"-"!==t||(r+=t,c+=1),n=3}else if(":"===d)n=2;else if(","===d)3===n&&i.push(r),n=1,l+=1;else if("("===d&&s.length>0)t.push(s.join(""));else{if(t.length>0&&("+"===d||"-"===d)){let e=t[t.length-1];if("("!==e&&i.push(t.pop()),"*"===e||"/"===e)for(;t.length>0&&(e=t[t.length-1],"("!==e);)i.push(t.pop())}else if(t.length>0){const e=t[t.length-1];"*"!==e&&"/"!==e||i.push(t.pop())}t.push(d)}s=[]}o=d}}for(s.length>0&&i.push(s.join(""));t.length>0;)i.push(t.pop());return i})(e.substring(1));return n.length<=0?e:((e,t,i,s)=>{const n=[];for(let r=0;r<e.length;r+=1){const l=e[r],o=l[0];if("+"===l){const e=n.pop();n.push(b("+",n.pop(),e))}else if("-"===l)if(1===n.length){const e=n.pop();n.push(b("*",e,-1))}else{const e=n.pop();n.push(b("-",n.pop(),e))}else if("*"===l)n.push(b("*",n.pop(),n.pop()));else if("/"===l){const e=n.pop();n.push(b("/",n.pop(),e))}else if("="===o||">"===o||"<"===o){let e=n.pop();Number.isNaN(e)||(e=Number(e));let t=n.pop();Number.isNaN(t)||(t=Number(t));let i=!1;"="===o?i=t===e:">"===l?i=t>e:">="===l?i=t>=e:"<"===l?i=t<e:"<="===l&&(i=t<=e),n.push(i)}else if(Array.isArray(l)){const[e,i]=l,s=[];for(let e=0;e<i;e+=1)s.push(n.pop());n.push(t[e].render(s.reverse()))}else{if(s.includes(l))return 0;(o>="a"&&o<="z"||o>="A"&&o<="Z")&&s.push(l),n.push($e(l,i)),s.pop()}}return n[0]})(n,t,((e,n)=>Ve(i(e,n),t,i,s)),s)}return e},Ke={render:Ve},Xe=[{key:"SUM",title:S("formula.sum"),render:e=>e.reduce(((e,t)=>b("+",e,t)),0)},{key:"AVERAGE",title:S("formula.average"),render:e=>e.reduce(((e,t)=>Number(e)+Number(t)),0)/e.length},{key:"MAX",title:S("formula.max"),render:e=>Math.max(...e.map((e=>Number(e))))},{key:"MIN",title:S("formula.min"),render:e=>Math.min(...e.map((e=>Number(e))))},{key:"IF",title:S("formula._if"),render:([e,t,i])=>e?t:i},{key:"AND",title:S("formula.and"),render:e=>e.every((e=>e))},{key:"OR",title:S("formula.or"),render:e=>e.some((e=>e))},{key:"CONCAT",title:S("formula.concat"),render:e=>e.join("")}],_e=Xe,qe={};Xe.forEach((e=>{qe[e.key]=e}));const et=e=>e,tt=e=>{if(/^(-?\d*.?\d*)$/.test(e)){const t=Number(e).toFixed(2).toString(),[i,...s]=t.split("\\.");return[i.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),...s]}return e},it=[{key:"normal",title:S("format.normal"),type:"string",render:et},{key:"text",title:S("format.text"),type:"string",render:et},{key:"number",title:S("format.number"),type:"number",label:"1,000.12",render:tt},{key:"percent",title:S("format.percent"),type:"number",label:"10.12%",render:e=>`${e}%`},{key:"rmb",title:S("format.rmb"),type:"number",label:"\uffe510.00",render:e=>`\uffe5${tt(e)}`},{key:"usd",title:S("format.usd"),type:"number",label:"$10.00",render:e=>`$${tt(e)}`},{key:"eur",title:S("format.eur"),type:"number",label:"\u20ac10.00",render:e=>`\u20ac${tt(e)}`},{key:"date",title:S("format.date"),type:"date",label:"26/09/2008",render:et},{key:"time",title:S("format.time"),type:"date",label:"15:59:00",render:et},{key:"datetime",title:S("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:et},{key:"duration",title:S("format.duration"),type:"date",label:"24:01:00",render:et}],st={};it.forEach((e=>{st[e.key]=e}));const nt=5,rt={fillStyle:"#f4f5f8"},lt={fillStyle:"#fff",lineWidth:Ye,strokeStyle:"#e6e6e6"};function ot(e,t,i,s=0){const{left:n,top:r,width:l,height:o}=e.cellRect(t,i);return new Pe(n,r+s,l,o,nt)}function at(e,t,i,s,n=0){const{sortedRowMap:r,rows:l,cols:o}=t;if(l.isHide(i)||o.isHide(s))return;let a=i;r.has(i)&&(a=r.get(i));const h=t.getCell(a,s);if(null===h)return;let c=!1;"editable"in h&&!1===h.editable&&(c=!0);const d=t.getCellStyleOrDefault(a,s),g=ot(t,i,s,n);g.bgcolor=d.bgcolor,void 0!==d.border&&(g.setBorders(d.border),e.strokeBorders(g)),e.rect(g,(()=>{let n="";n=t.settings.evalPaused?h.text||"":Ke.render(h.text||"",qe,((e,i)=>t.getCellTextOrDefault(i,e))),d.format&&(n=st[d.format].render(n));const r=Object.assign({},d.font);r.size=function(e){for(let t=0;t<Je.length;t+=1){const i=Je[t];if(i.pt===e)return i.px}return e}(r.size),e.text(n,g,{align:d.align,valign:d.valign,font:r,color:d.color,strike:d.strike,underline:d.underline},d.textwrap);t.validations.getError(i,s)&&e.error(g),c&&e.frozen(g)}))}function ht(e){const{data:t,draw:i}=this;if(e){const{autoFilter:s}=t;if(!s.active())return;const n=s.hrange();e.intersects(n)&&n.each(((e,s)=>{const n=ot(t,e,s);i.dropdown(n)}))}}function ct(e,t,i,s,n){const{draw:r,data:l}=this;r.save(),r.translate(t,i).translate(s,n);const{exceptRowSet:o}=l,a=l.exceptRowTotalHeight(e.sri,e.eri);r.save(),r.translate(0,-a),e.each(((e,t)=>{at(r,l,e,t)}),(e=>(e=>{const t=o.has(e);if(t){const t=l.rows.getHeight(e);r.translate(0,-t)}return!t})(e))),r.restore();const h=new Set;r.save(),r.translate(0,-a),l.eachMergesInView(e,(({sri:e,sci:t,eri:i})=>{if(o.has(e)){if(!h.has(e)){h.add(e);const t=l.rows.sumHeight(e,i+1);r.translate(0,-t)}}else at(r,l,e,t)})),r.restore(),ht.call(this,e),r.restore()}function dt(e,t,i,s){const{draw:n}=this;n.save(),n.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(e,t,i,s),n.restore()}function gt(e,t,i,s,n,r){const{draw:o,data:a}=this,h=t.h,c=t.w,d=r+s,g=n+i;o.save(),o.attr(rt),"all"!==e&&"left"!==e||o.fillRect(0,d,i,h),"all"!==e&&"top"!==e||o.fillRect(g,0,c,s);const{sri:u,sci:w,eri:M,eci:p}=a.selector.range;o.attr({textAlign:"center",textBaseline:"middle",font:`500 ${He(12)}px Source Sans Pro`,fillStyle:"#585757",lineWidth:Ye(),strokeStyle:"#e6e6e6"}),"all"!==e&&"left"!==e||(a.rowEach(t.sri,t.eri,((e,t,s)=>{const n=d+t,r=e;o.line([0,n],[i,n]),u<=r&&r<M+1&&dt.call(this,0,n,i,s),o.fillText(r+1,i/2,n+s/2),e>0&&a.rows.isHide(e-1)&&(o.save(),o.attr({strokeStyle:"#c6c6c6"}),o.line([5,n+5],[i-5,n+5]),o.restore())})),o.line([0,h+d],[i,h+d]),o.line([i,d],[i,h+d])),"all"!==e&&"top"!==e||(a.colEach(t.sci,t.eci,((e,t,i)=>{const n=g+t,r=e;o.line([n,0],[n,s]),w<=r&&r<p+1&&dt.call(this,n,0,i,s),o.fillText(l(r),n+i/2,s/2),e>0&&a.cols.isHide(e-1)&&(o.save(),o.attr({strokeStyle:"#c6c6c6"}),o.line([n+5,5],[n+5,s-5]),o.restore())})),o.line([c+g,0],[c+g,s]),o.line([0,s],[c+g,s])),o.restore()}function ut(e,t){const{draw:i}=this;i.save(),i.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,e,t),i.restore()}function wt({sri:e,sci:t,eri:i,eci:s,w:n,h:r},l,o,a,h){const{draw:c,data:d}=this,{settings:g}=d;c.save(),c.attr(lt).translate(l+a,o+h),g.showGrid?(d.rowEach(e,i,((t,s,r)=>{t!==e&&c.line([0,s],[n,s]),t===i&&c.line([0,s+r],[n,s+r])})),d.colEach(t,s,((e,i,n)=>{e!==t&&c.line([i,0],[i,r]),e===s&&c.line([i+n,0],[i+n,r])})),c.restore()):c.restore()}function Mt(e,t,i,s){const{draw:n,data:r}=this,l=r.viewWidth()-e,o=r.viewHeight()-t;n.save().translate(e,t).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),n.line([0,s],[l,s]),n.line([i,0],[i,o]),n.restore()}const pt=class{constructor(e,t){this.el=e,this.draw=new Fe(e,t.viewWidth(),t.viewHeight()),this.data=t}resetData(e){this.data=e,this.render()}render(){const{data:e}=this,{rows:t,cols:i}=e,s=i.indexWidth,n=t.height;this.draw.resize(e.viewWidth(),e.viewHeight()),this.clear();const r=e.viewRange(),l=e.freezeTotalWidth(),o=e.freezeTotalHeight(),{x:a,y:h}=e.scroll;wt.call(this,r,s,n,l,o),ct.call(this,r,s,n,-a,-h),gt.call(this,"all",r,s,n,l,o),ut.call(this,s,n);const[c,d]=e.freeze;if(c>0||d>0){if(c>0){const e=r.clone();e.sri=0,e.eri=c-1,e.h=o,wt.call(this,e,s,n,l,0),ct.call(this,e,s,n,-a,0),gt.call(this,"top",e,s,n,l,0)}if(d>0){const e=r.clone();e.sci=0,e.eci=d-1,e.w=l,wt.call(this,e,s,n,0,o),gt.call(this,"left",e,s,n,0,o),ct.call(this,e,s,n,0,-h)}const t=e.freezeViewRange();wt.call(this,t,s,n,0,0),gt.call(this,"all",t,s,n,0,0),ct.call(this,t,s,n,0,0),Mt.call(this,s,n,l,o)}}clear(){this.draw.clear()}},xt=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],ft=["landscape","portrait"];function Dt(e){return parseInt(96*e,10)}function It(e){"cancel"===e?this.el.hide():this.toPrint()}function mt(e){const{paper:t}=this,{value:i}=e.target,s=xt[i];t.w=Dt(s[1]),t.h=Dt(s[2]),this.preview()}function bt(e){const{paper:t}=this,{value:i}=e.target,s=ft[i];t.orientation=s,this.preview()}class yt{constructor(e){this.paper={w:Dt(xt[0][1]),h:Dt(xt[0][2]),padding:50,orientation:ft[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=n("div",`${ee}-print`).children(n("div",`${ee}-print-bar`).children(n("div","-title").child("Print settings"),n("div","-right").children(n("div",`${ee}-buttons`).children(new Ue("cancel").on("click",It.bind(this,"cancel")),new Ue("next","primary").on("click",It.bind(this,"next"))))),n("div",`${ee}-print-content`).children(this.contentEl=n("div","-content"),n("div","-sider").child(n("form","").children(n("fieldset","").children(n("label","").child(`${v("print.size")}`),n("select","").children(...xt.map(((e,t)=>n("option","").attr("value",t).child(`${e[0]} ( ${e[1]}''x${e[2]}'' )`)))).on("change",mt.bind(this))),n("fieldset","").children(n("label","").child(`${v("print.orientation")}`),n("select","").children(...ft.map(((e,t)=>n("option","").attr("value",t).child(`${v("print.orientations")[t]}`)))).on("change",bt.bind(this))))))).hide()}resetData(e){this.data=e}preview(){const{data:e,paper:t}=this,{width:i,height:s,padding:r}=t,l=i-2*r,o=s-2*r,a=e.contentRange(),h=parseInt(a.h/o,10)+1,c=l/a.w;let d=r;const g=r;c>1&&(d+=(l-a.w)/2);let u=0,w=0;this.contentEl.html(""),this.canvases=[];const M={sri:0,sci:0,eri:0,eci:0};for(let t=0;t<h;t+=1){let t=0,r=0;const l=n("div",`${ee}-canvas-card`),h=n("canvas",`${ee}-canvas`);this.canvases.push(h.el);const p=new Fe(h.el,i,s);for(p.save(),p.translate(d,g),c<1&&p.scale(c,c);u<=a.eri;u+=1){const i=e.rows.getHeight(u);if(t+=i,!(t<o)){r=-(t-i);break}for(let t=0;t<=a.eci;t+=1)at(p,e,u,t,w),M.eci=t}M.eri=u,p.restore(),p.save(),p.translate(d,g),c<1&&p.scale(c,c);const x=w;e.eachMergesInView(M,(({sri:t,sci:i})=>{at(p,e,t,i,x)})),p.restore(),M.sri=M.eri,M.sci=M.eci,w+=r,this.contentEl.child(n("div",`${ee}-canvas-card-wraper`).child(l.child(h)))}this.el.show()}toPrint(){this.el.hide();const{paper:e}=this,t=n("iframe","").hide(),{el:i}=t;window.document.body.appendChild(i);const{contentWindow:s}=i,r=s.document,l=document.createElement("style");l.innerHTML=`\n      @page { size: ${e.width}px ${e.height}px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    `,r.head.appendChild(l),this.canvases.forEach((e=>{const t=e.cloneNode(!1);t.getContext("2d").drawImage(e,0,0),r.body.appendChild(t)})),s.print()}}const Et=[{key:"copy",title:S("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:S("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:S("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:S("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:S("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:S("contextmenu.insertRow")},{key:"insert-column",title:S("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:S("contextmenu.deleteRow")},{key:"delete-column",title:S("contextmenu.deleteColumn")},{key:"delete-cell-text",title:S("contextmenu.deleteCellText")},{key:"hide",title:S("contextmenu.hide")},{key:"divider"},{key:"validation",title:S("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:S("contextmenu.cellprintable")},{key:"cell-non-printable",title:S("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:S("contextmenu.celleditable")},{key:"cell-non-editable",title:S("contextmenu.cellnoneditable")}];function Tt(e){return"divider"===e.key?n("div",`${ee}-item divider`):n("div",`${ee}-item`).on("click",(()=>{this.itemClick(e.key),this.hide()})).children(e.title(),n("div","label").child(e.label||""))}function Nt(){return Et.map((e=>Tt.call(this,e)))}class Lt{constructor(e,t=!1){this.menuItems=Nt.call(this),this.el=n("div",`${ee}-contextmenu`).children(...this.menuItems).hide(),this.viewFn=e,this.itemClick=()=>{},this.isHide=t,this.setMode("range")}setMode(e){const t=this.menuItems[12];"row-col"===e?t.show():t.hide()}hide(){const{el:e}=this;e.hide(),K(e)}setPosition(e,t){if(this.isHide)return;const{el:i}=this,{width:s}=i.show().offset(),n=this.viewFn(),r=n.height/2;let l=e;n.width-e<=s&&(l-=s),i.css("left",`${l}px`),t>r?i.css("bottom",n.height-t+"px").css("max-height",`${t}px`).css("top","auto"):i.css("top",`${t}px`).css("max-height",n.height-t+"px").css("bottom","auto"),X(i)}}class Ct{constructor(e,t,i){this.tip=v(`toolbar.${e.replace(/-[a-z]/g,(e=>e[1].toUpperCase()))}`),t&&(this.tip+=` (${t})`),this.tag=e,this.shortcut=t,this.value=i,this.el=this.element(),this.change=()=>{}}element(){const{tip:e}=this;return n("div",`${ee}-toolbar-btn`).on("mouseenter",(t=>{!function(e,t){if(t.classList.contains("active"))return;const{left:i,top:s,width:r,height:l}=t.getBoundingClientRect(),o=n("div",`${ee}-tooltip`).html(e).show();document.body.appendChild(o.el);const a=o.box();o.css("left",i+r/2-a.width/2+"px").css("top",`${s+l+2}px`),J(t,"mouseleave",(()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)})),J(t,"click",(()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)}))}(e,t.target)})).attr("data-tooltip",e)}setState(){}}class vt extends Ct{dropdown(){}getValue(e){return e}element(){const{tag:e}=this;return this.dd=this.dropdown(),this.dd.change=t=>this.change(e,this.getValue(t)),super.element().child(this.dd)}setState(e){e&&(this.value=e,this.dd.setTitle(e))}}class St extends s{constructor(e,t,i,s,...r){super("div",`${ee}-dropdown ${s}`),this.title=e,this.change=()=>{},this.headerClick=()=>{},"string"==typeof e?this.title=n("div",`${ee}-dropdown-title`).child(e):i&&this.title.addClass("arrow-left"),this.contentEl=n("div",`${ee}-dropdown-content`).css("width",t).hide(),this.setContentChildren(...r),this.headerEl=n("div",`${ee}-dropdown-header`),this.headerEl.on("click",(()=>{"block"!==this.contentEl.css("display")?this.show():this.hide()})).children(this.title,i?n("div",`${ee}-icon arrow-right`).child(n("div",`${ee}-icon-img arrow-down`)):""),this.children(this.headerEl,this.contentEl)}setContentChildren(...e){this.contentEl.html(""),e.length>0&&this.contentEl.children(...e)}setTitle(e){this.title.html(e),this.hide()}show(){const{contentEl:e}=this;e.show(),this.parent().active(),X(this.parent(),(()=>{this.hide()}))}hide(){this.parent().active(!1),this.contentEl.hide(),K(this.parent())}}class At extends St{constructor(e,t){super(new Ee(`align-${t}`),"auto",!0,"bottom-left",...e.map((e=>{return(t=`align-${e}`,n("div",`${ee}-item`).child(new Ee(t))).on("click",(()=>{this.setTitle(e),this.change(e)}));var t})))}setTitle(e){this.title.setName(`align-${e}`),this.hide()}}class zt extends vt{constructor(e){super("align","",e)}dropdown(){const{value:e}=this;return new At(["left","center","right"],e)}}class Bt extends vt{constructor(e){super("valign","",e)}dropdown(){const{value:e}=this;return new At(["top","middle","bottom"],e)}}class kt extends Ct{element(){const{tag:e}=this;return super.element().child(new Ee(e)).on("click",(()=>this.click()))}click(){this.change(this.tag,this.toggle())}setState(e){this.el.active(e)}toggle(){return this.el.toggle()}active(){return this.el.hasClass("active")}}class jt extends kt{constructor(){super("autofilter")}setState(){}}class Ot extends kt{constructor(){super("font-bold","Ctrl+B")}}class Zt extends kt{constructor(){super("font-italic","Ctrl+I")}}class Ut extends kt{constructor(){super("strike","Ctrl+U")}}class Rt extends kt{constructor(){super("underline","Ctrl+U")}}const Yt=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Ht=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Wt=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function Pt(e){return n("td","").child(n("div",`${ee}-color-palette-cell`).on("click.stop",(()=>this.change(e))).css("background-color",e))}class Gt{constructor(){this.el=n("div",`${ee}-color-palette`),this.change=()=>{};const e=n("table","").children(n("tbody","").children(n("tr",`${ee}-theme-color-placeholders`).children(...Yt.map((e=>Pt.call(this,e)))),...Ht.map((e=>n("tr",`${ee}-theme-colors`).children(...e.map((e=>Pt.call(this,e)))))),n("tr",`${ee}-standard-colors`).children(...Wt.map((e=>Pt.call(this,e))))));this.el.child(e)}}class Ft extends St{constructor(e,t){const i=new Ee(e).css("height","16px").css("border-bottom",`3px solid ${t}`),s=new Gt;s.change=e=>{this.setTitle(e),this.change(e)},super(i,"auto",!1,"bottom-left",s.el)}setTitle(e){this.title.css("border-color",e),this.hide()}}const Qt=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']];class Jt extends St{constructor(e){const t=new Ee("line-type");let i=0;const s=Qt.map(((t,r)=>n("div",`${ee}-item state ${e===t[0]?"checked":""}`).on("click",(()=>{s[i].toggle("checked"),s[r].toggle("checked"),i=r,this.hide(),this.change(t)})).child(n("div",`${ee}-line-type`).html(t[1]))));super(t,"auto",!1,"bottom-left",...s)}}function $t(...e){return n("table","").child(n("tbody","").children(...e))}function Vt(e){return n("td","").child(n("div",`${ee}-border-palette-cell`).child(new Ee(`border-${e}`)).on("click",(()=>{this.mode=e;const{mode:t,style:i,color:s}=this;this.change({mode:t,style:i,color:s})})))}class Kt{constructor(){this.color="#000",this.style="thin",this.mode="all",this.change=()=>{},this.ddColor=new Ft("line-color",this.color),this.ddColor.change=e=>{this.color=e},this.ddType=new Jt(this.style),this.ddType.change=([e])=>{this.style=e},this.el=n("div",`${ee}-border-palette`);const e=$t(n("tr","").children(n("td",`${ee}-border-palette-left`).child($t(n("tr","").children(...["all","inside","horizontal","vertical","outside"].map((e=>Vt.call(this,e)))),n("tr","").children(...["left","top","right","bottom","none"].map((e=>Vt.call(this,e)))))),n("td",`${ee}-border-palette-right`).children(n("div",`${ee}-toolbar-btn`).child(this.ddColor.el),n("div",`${ee}-toolbar-btn`).child(this.ddType.el))));this.el.child(e)}}class Xt extends St{constructor(){const e=new Ee("border-all"),t=new Kt;t.change=e=>{this.change(e),this.hide()},super(e,"auto",!1,"bottom-left",t.el)}}class _t extends vt{constructor(){super("border")}dropdown(){return new Xt}}class qt extends Ct{element(){return super.element().child(new Ee(this.tag)).on("click",(()=>this.change(this.tag)))}setState(e){this.el.disabled(e)}}class ei extends qt{constructor(){super("clearformat")}}class ti extends kt{constructor(){super("paintformat")}setState(){}}class ii extends vt{constructor(e){super("color",void 0,e)}dropdown(){const{tag:e,value:t}=this;return new Ft(e,t)}}class si extends vt{constructor(e){super("bgcolor",void 0,e)}dropdown(){const{tag:e,value:t}=this;return new Ft(e,t)}}class ni extends St{constructor(){super("10","60px",!0,"bottom-left",...Je.map((e=>n("div",`${ee}-item`).on("click",(()=>{this.setTitle(`${e.pt}`),this.change(e)})).child(`${e.pt}`))))}}class ri extends vt{constructor(){super("font-size")}getValue(e){return e.pt}dropdown(){return new ni}}class li extends St{constructor(){const e=Qe.map((e=>n("div",`${ee}-item`).on("click",(()=>{this.setTitle(e.title),this.change(e)})).child(e.title)));super(Qe[0].title,"160px",!0,"bottom-left",...e)}}class oi extends vt{constructor(){super("font-name")}getValue(e){return e.key}dropdown(){return new li}}class ai extends St{constructor(){let e=it.slice(0);e.splice(2,0,{key:"divider"}),e.splice(8,0,{key:"divider"}),e=e.map((e=>{const t=n("div",`${ee}-item`);return"divider"===e.key?t.addClass("divider"):(t.child(e.title()).on("click",(()=>{this.setTitle(e.title()),this.change(e)})),e.label&&t.child(n("div","label").html(e.label))),t})),super("Normal","220px",!0,"bottom-left",...e)}setTitle(e){for(let t=0;t<it.length;t+=1)it[t].key===e&&this.title.html(it[t].title());this.hide()}}class hi extends vt{constructor(){super("format")}getValue(e){return e.key}dropdown(){return new ai}}class ci extends St{constructor(){const e=Xe.map((e=>n("div",`${ee}-item`).on("click",(()=>{this.hide(),this.change(e)})).child(e.key)));super(new Ee("formula"),"180px",!0,"bottom-left",...e)}}class di extends vt{constructor(){super("formula")}getValue(e){return e.key}dropdown(){return new ci}}class gi extends kt{constructor(){super("freeze")}}class ui extends kt{constructor(){super("merge")}setState(e,t){this.el.active(e).disabled(t)}}class wi extends qt{constructor(){super("redo","Ctrl+Y")}}class Mi extends qt{constructor(){super("undo","Ctrl+Z")}}class pi extends qt{constructor(){super("print","Ctrl+P")}}class xi extends kt{constructor(){super("textwrap")}}class fi extends St{constructor(){const e=new Ee("ellipsis"),t=n("div",`${ee}-toolbar-more`);super(e,"auto",!1,"bottom-right",t),this.moreBtns=t,this.contentEl.css("max-width","420px")}}class Di extends vt{constructor(){super("more"),this.el.hide()}dropdown(){return new fi}show(){this.el.show()}hide(){this.el.hide()}}function Ii(){return n("div",`${ee}-toolbar-divider`)}function mi(){this.btns2=[],this.items.forEach((e=>{if(Array.isArray(e))e.forEach((({el:e})=>{const t=e.box(),{marginLeft:i,marginRight:s}=e.computedStyle();this.btns2.push([e,t.width+parseInt(i,10)+parseInt(s,10)])}));else{const t=e.box(),{marginLeft:i,marginRight:s}=e.computedStyle();this.btns2.push([e,t.width+parseInt(i,10)+parseInt(s,10)])}}))}function bi(){const{el:e,btns:t,moreEl:i,btns2:s}=this,{moreBtns:n,contentEl:r}=i.dd;e.css("width",this.widthFn()-60+"px");const l=e.box();let o=160,a=12;const h=[],c=[];s.forEach((([e,t],i)=>{o+=t,i===s.length-1||o<l.width?h.push(e):(a+=t,c.push(e))})),t.html("").children(...h),n.html("").children(...c),r.css("width",`${a}px`),c.length>0?i.show():i.hide()}class yi{constructor(e,t,i=!1){this.data=e,this.change=()=>{},this.widthFn=t,this.isHide=i;const s=e.defaultStyle();this.items=[[this.undoEl=new Mi,this.redoEl=new wi,new pi,this.paintformatEl=new ti,this.clearformatEl=new ei],Ii(),[this.formatEl=new hi],Ii(),[this.fontEl=new oi,this.fontSizeEl=new ri],Ii(),[this.boldEl=new Ot,this.italicEl=new Zt,this.underlineEl=new Rt,this.strikeEl=new Ut,this.textColorEl=new ii(s.color)],Ii(),[this.fillColorEl=new si(s.bgcolor),this.borderEl=new _t,this.mergeEl=new ui],Ii(),[this.alignEl=new zt(s.align),this.valignEl=new Bt(s.valign),this.textwrapEl=new xi],Ii(),[this.freezeEl=new gi,this.autofilterEl=new jt,this.formulaEl=new di,this.moreEl=new Di]],this.el=n("div",`${ee}-toolbar`),this.btns=n("div",`${ee}-toolbar-btns`),this.items.forEach((e=>{Array.isArray(e)?e.forEach((e=>{this.btns.child(e.el),e.change=(...e)=>{this.change(...e)}})):this.btns.child(e.el)})),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout((()=>{mi.call(this),bi.call(this)}),0),J(window,"resize",(()=>{bi.call(this)})))}paintformatActive(){return this.paintformatEl.active()}paintformatToggle(){this.paintformatEl.toggle()}trigger(e){this[`${e}El`].click()}resetData(e){this.data=e,this.reset()}reset(){if(this.isHide)return;const{data:e}=this,t=e.getSelectedCellStyle();this.undoEl.setState(!e.canUndo()),this.redoEl.setState(!e.canRedo()),this.mergeEl.setState(e.canUnmerge(),!e.selector.multiple()),this.autofilterEl.setState(!e.canAutofilter());const{font:i,format:s}=t;this.formatEl.setState(s),this.fontEl.setState(i.name),this.fontSizeEl.setState(i.size),this.boldEl.setState(i.bold),this.italicEl.setState(i.italic),this.underlineEl.setState(t.underline),this.strikeEl.setState(t.strike),this.textColorEl.setState(t.color),this.fillColorEl.setState(t.bgcolor),this.alignEl.setState(t.align),this.valignEl.setState(t.valign),this.textwrapEl.setState(t.textwrap),this.freezeEl.setState(e.freezeIsActive())}}class Ei{constructor(e,t,i="600px"){this.title=e,this.el=n("div",`${ee}-modal`).css("width",i).children(n("div",`${ee}-modal-header`).children(new Ee("close").on("click.stop",(()=>this.hide())),this.title),n("div",`${ee}-modal-content`).children(...t)).hide()}show(){this.dimmer=n("div",`${ee}-dimmer active`),document.body.appendChild(this.dimmer.el);const{width:e,height:t}=this.el.show().box(),{clientHeight:i,clientWidth:s}=document.documentElement;this.el.offset({left:(s-e)/2,top:(i-t)/3}),window.xkeydownEsc=e=>{27===e.keyCode&&this.hide()},J(window,"keydown",window.xkeydownEsc)}hide(){this.el.hide(),document.body.removeChild(this.dimmer.el),V(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}class Ti{constructor(e,t){this.vchange=()=>{},this.el=n("div",`${ee}-form-input`),this.input=n("input","").css("width",e).on("input",(e=>this.vchange(e))).attr("placeholder",t),this.el.child(this.input)}focus(){setTimeout((()=>{this.input.el.focus()}),10)}hint(e){this.input.attr("placeholder",e)}val(e){return this.input.val(e)}}class Ni{constructor(e,t,i,s=(e=>e),r=(()=>{})){this.key=e,this.getTitle=s,this.vchange=()=>{},this.el=n("div",`${ee}-form-select`),this.suggest=new ye(t.map((e=>({key:e,title:this.getTitle(e)}))),(e=>{this.itemClick(e.key),r(e.key),this.vchange(e.key)}),i,this.el),this.el.children(this.itemEl=n("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(()=>this.show()))}show(){this.suggest.search("")}itemClick(e){this.key=e,this.itemEl.html(this.getTitle(e))}val(e){return void 0!==e?(this.key=e,this.itemEl.html(this.getTitle(e)),this):this.key}}const Li={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/};class Ci{constructor(e,t,i,s){this.label="",this.rule=t,i&&(this.label=n("label","label").css("width",`${s}px`).html(i)),this.tip=n("div","tip").child("tip").hide(),this.input=e,this.input.vchange=()=>this.validate(),this.el=n("div",`${ee}-form-field`).children(this.label,e.el,this.tip)}isShow(){return"none"!==this.el.css("display")}show(){this.el.show()}hide(){return this.el.hide(),this}val(e){return this.input.val(e)}hint(e){this.input.hint(e)}validate(){const{input:e,rule:t,tip:i,el:s}=this,n=e.val();if(t.required&&/^\s*$/.test(n))return i.html(v("validation.required")),s.addClass("error"),!1;if(t.type||t.pattern){if(!(t.pattern||Li[t.type]).test(n))return i.html(v("validation.notMatch")),s.addClass("error"),!1}return s.removeClass("error"),!0}}class vi extends Ei{constructor(){const e=new Ci(new Ni("cell",["cell"],"100%",(e=>v(`dataValidation.modeType.${e}`))),{required:!0},`${v("dataValidation.range")}:`,100),t=new Ci(new Ti("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new Ci(new Ni("list",["list","number","date","phone","email"],"100%",(e=>v(`dataValidation.type.${e}`)),(e=>this.criteriaSelected(e))),{required:!0},`${v("dataValidation.criteria")}:`,100),s=new Ci(new Ni("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(e=>v(`dataValidation.operator.${e}`)),(e=>this.criteriaOperatorSelected(e))),{required:!0}).hide(),r=new Ci(new Ti("70px","10"),{required:!0}).hide(),l=new Ci(new Ti("70px","100"),{required:!0,type:"number"}).hide(),o=new Ci(new Ti("120px","a,b,c"),{required:!0}),a=new Ci(new Ti("70px","10"),{required:!0,type:"number"}).hide();super(v("contextmenu.validation"),[n("div",`${ee}-form-fields`).children(e.el,t.el),n("div",`${ee}-form-fields`).children(i.el,s.el,r.el,l.el,a.el,o.el),n("div",`${ee}-buttons`).children(new Ue("cancel").on("click",(()=>this.btnClick("cancel"))),new Ue("remove").on("click",(()=>this.btnClick("remove"))),new Ue("save","primary").on("click",(()=>this.btnClick("save"))))]),this.mf=e,this.rf=t,this.cf=i,this.of=s,this.minvf=r,this.maxvf=l,this.vf=a,this.svf=o,this.change=()=>{}}showVf(e){const t="date"===e?"2018-11-12":"10",{vf:i}=this;i.input.hint(t),i.show()}criteriaSelected(e){const{of:t,minvf:i,maxvf:s,vf:n,svf:r}=this;"date"===e||"number"===e?(t.show(),i.rule.type=e,s.rule.type=e,"date"===e?(i.hint("2018-11-12"),s.hint("2019-11-12")):(i.hint("10"),s.hint("100")),i.show(),s.show(),n.hide(),r.hide()):("list"===e?r.show():r.hide(),n.hide(),t.hide(),i.hide(),s.hide())}criteriaOperatorSelected(e){if(!e)return;const{minvf:t,maxvf:i,vf:s}=this;if("be"===e||"nbe"===e)t.show(),i.show(),s.hide();else{const e=this.cf.val();s.rule.type=e,"date"===e?s.hint("2018-11-12"):s.hint("10"),s.show(),t.hide(),i.hide()}}btnClick(e){if("cancel"===e)this.hide();else if("remove"===e)this.change("remove"),this.hide();else if("save"===e){const e=["mf","rf","cf","of","svf","vf","minvf","maxvf"];for(let t=0;t<e.length;t+=1){const i=this[e[t]];if(i.isShow()&&!i.validate())return}const t=this.mf.val(),i=this.rf.val(),s=this.cf.val(),n=this.of.val();let r=this.svf.val();"number"!==s&&"date"!==s||(r="be"===n||"nbe"===n?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",t,i,{type:s,operator:n,required:!1,value:r}),this.hide()}}setValue(e){if(e){const{mf:t,rf:i,cf:s,of:n,svf:r,vf:l,minvf:o,maxvf:a}=this,{mode:h,ref:c,validator:d}=e,{type:g,operator:u,value:w}=d||{type:"list"};t.val(h||"cell"),i.val(c),s.val(g),n.val(u),Array.isArray(w)?(o.val(w[0]),a.val(w[1])):(r.val(w||""),l.val(w||"")),this.criteriaSelected(g),this.criteriaOperatorSelected(u)}this.show()}}function Si(e){return n("div",`${ee}-item ${e}`)}function Ai(e){return Si("state").child(v(`sort.${e}`)).on("click.stop",(()=>this.itemClick(e)))}function zi(e){const{filterbEl:t,filterValues:i}=this;t.html("");Object.keys(e).forEach(((s,r)=>{const l=e[s],o=i.includes(s)?"checked":"";t.child(n("div",`${ee}-item state ${o}`).on("click.stop",(()=>this.filterClick(r,s))).children(""===s?v("filter.empty"):s,n("div","label").html(`(${l})`)))}))}function Bi(){const{filterhEl:e,filterValues:t,values:i}=this;e.html(`${t.length} / ${i.length}`),e.checked(t.length===i.length)}class ki{constructor(){this.filterbEl=n("div",`${ee}-body`),this.filterhEl=n("div",`${ee}-header state`).on("click.stop",(()=>this.filterClick(0,"all"))),this.el=n("div",`${ee}-sort-filter`).children(this.sortAscEl=Ai.call(this,"asc"),this.sortDescEl=Ai.call(this,"desc"),Si("divider"),n("div",`${ee}-filter`).children(this.filterhEl,this.filterbEl),n("div",`${ee}-buttons`).children(new Ue("cancel").on("click",(()=>this.btnClick("cancel"))),new Ue("ok","primary").on("click",(()=>this.btnClick("ok"))))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}btnClick(e){if("ok"===e){const{ci:e,sort:t,filterValues:i}=this;this.ok&&this.ok(e,t,"in",i)}this.hide()}itemClick(e){this.sort=e;const{sortAscEl:t,sortDescEl:i}=this;t.checked("asc"===e),i.checked("desc"===e)}filterClick(e,t){const{filterbEl:i,filterValues:s,values:r}=this,l=i.children();if("all"===t)l.length===s.length?(this.filterValues=[],l.forEach((e=>n(e).checked(!1)))):(this.filterValues=Array.from(r),l.forEach((e=>n(e).checked(!0))));else{n(l[e]).toggle("checked")?s.push(t):s.splice(s.findIndex((e=>e===t)),1)}Bi.call(this)}set(e,t,i,s){this.ci=e;const{sortAscEl:n,sortDescEl:r}=this;null!==s?(this.sort=s.order,n.checked(s.asc()),r.checked(s.desc())):(this.sortDesc=null,n.checked(!1),r.checked(!1)),this.values=Object.keys(t),this.filterValues=i?Array.from(i.value):Object.keys(t),zi.call(this,t,i),Bi.call(this)}setOffset(e){this.el.offset(e).show();let t=1;X(this.el,(()=>{t<=0&&this.hide(),t-=1}))}show(){this.el.show()}hide(){this.el.hide(),K(this.el)}}function ji(e,t){const i=n("div",`${ee}-toast`),s=n("div",`${ee}-dimmer active`);i.children(n("div",`${ee}-toast-header`).children(new Ee("close").on("click.stop",(()=>(document.body.removeChild(i.el),void document.body.removeChild(s.el)))),e),n("div",`${ee}-toast-content`).html(t)),document.body.appendChild(i.el),document.body.appendChild(s.el);const{width:r,height:l}=i.box(),{clientHeight:o,clientWidth:a}=document.documentElement;i.offset({left:(a-r)/2,top:(o-l)/3})}function Oi(e,t){let i;return(...s)=>{const n=this,r=s;i||(i=setTimeout((()=>{i=null,e.apply(n,r)}),t))}}function Zi(){const{data:e,verticalScrollbar:t,horizontalScrollbar:i}=this,{l:s,t:n,left:r,top:l,width:o,height:a}=e.getSelectedRect(),h=this.getTableOffset();if(Math.abs(r)+o>h.width)i.move({left:s+o-h.width});else{const t=e.freezeTotalWidth();r<t&&i.move({left:s-1-t})}if(Math.abs(l)+a>h.height)t.move({top:n+a-h.height-1});else{const i=e.freezeTotalHeight();l<i&&t.move({top:n-1-i})}}function Ui(e,t,i,s=!0,n=!1){if(-1===t&&-1===i)return;const{table:r,selector:l,toolbar:o,data:a,contextMenu:h}=this;h.setMode(-1===t||-1===i?"row-col":"range");const c=a.getCell(t,i);e?(l.setEnd(t,i,n),this.trigger("cells-selected",c,l.range)):(l.set(t,i,s),this.trigger("cell-selected",c,t,i)),o.reset(),r.render()}function Ri(e,t){const{selector:i,data:s}=this,{rows:n,cols:r}=s;let[l,o]=i.indexes;const{eri:a,eci:h}=i.range;e&&([l,o]=i.moveIndexes),"left"===t?o>0&&(o-=1):"right"===t?(h!==o&&(o=h),o<r.len-1&&(o+=1)):"up"===t?l>0&&(l-=1):"down"===t?(a!==l&&(l=a),l<n.len-1&&(l+=1)):"row-first"===t?o=0:"row-last"===t?o=r.len-1:"col-first"===t?l=0:"col-last"===t&&(l=n.len-1),e&&(i.moveIndexes=[l,o]),Ui.call(this,e,l,o),Zi.call(this)}function Yi(e){if(0!==e.buttons)return;if(e.target.className===`${ee}-resizer-hover`)return;const{offsetX:t,offsetY:i}=e,{rowResizer:s,colResizer:n,tableEl:r,data:l}=this,{rows:o,cols:a}=l;if(t>a.indexWidth&&i>o.height)return s.hide(),void n.hide();const h=r.box(),c=l.getCellRectByXY(e.offsetX,e.offsetY);c.ri>=0&&-1===c.ci?(c.width=a.indexWidth,s.show(c,{width:h.width}),o.isHide(c.ri-1)?s.showUnhide(c.ri):s.hideUnhide()):s.hide(),-1===c.ri&&c.ci>=0?(c.height=o.height,n.show(c,{height:h.height}),a.isHide(c.ci-1)?n.showUnhide(c.ci):n.hideUnhide()):n.hide()}function Hi(e){const{verticalScrollbar:t,horizontalScrollbar:i,data:s}=this,{top:n}=t.scroll(),{left:r}=i.scroll(),{rows:l,cols:o}=s,{deltaY:a,deltaX:h}=e,c=(e,t)=>{let i=e,s=0;do{s=t(i),i+=1}while(s<=0);return s},d=e=>{if(e>0){const e=s.scroll.ri+1;if(e<l.len){const i=c(e,(e=>l.getHeight(e)));t.move({top:n+i-1})}}else{const e=s.scroll.ri-1;if(e>=0){const i=c(e,(e=>l.getHeight(e)));t.move({top:0===e?0:n-i})}}},g=Math.abs(a),u=Math.abs(h),w=Math.max(g,u);/Firefox/i.test(window.navigator.userAgent)&&Oi(d(e.detail),50),w===u&&Oi((e=>{if(e>0){const e=s.scroll.ci+1;if(e<o.len){const t=c(e,(e=>o.getWidth(e)));i.move({left:r+t-1})}}else{const e=s.scroll.ci-1;if(e>=0){const t=c(e,(e=>o.getWidth(e)));i.move({left:0===e?0:r-t})}}})(h),50),w===g&&Oi(d(a),50)}function Wi(e,t){const{verticalScrollbar:i,horizontalScrollbar:s}=this,{top:n}=i.scroll(),{left:r}=s.scroll();"left"===e||"right"===e?s.move({left:r-t}):"up"!==e&&"down"!==e||i.move({top:n-t})}function Pi(){const{data:e,verticalScrollbar:t}=this,{height:i}=this.getTableOffset(),s=e.exceptRowTotalHeight(0,-1);t.set(i,e.rows.totalHeight()-s)}function Gi(){const{data:e,horizontalScrollbar:t}=this,{width:i}=this.getTableOffset();e&&t.set(i,e.cols.totalWidth())}function Fi(){const{selector:e,data:t,editor:i}=this,[s,n]=t.freeze;if(s>0||n>0){const e=t.freezeTotalWidth(),s=t.freezeTotalHeight();i.setFreezeLengths(e,s)}e.resetAreaOffset()}function Qi(){const{tableEl:e,overlayerEl:t,overlayerCEl:i,table:s,toolbar:n,selector:r,el:l}=this,o=this.getTableOffset(),a=this.getRect();e.attr(a),t.offset(a),i.offset(o),l.css("width",`${a.width}px`),Pi.call(this),Gi.call(this),Fi.call(this),s.render(),n.reset(),r.reset()}function Ji(){const{data:e,selector:t}=this;e.clearClipboard(),t.hideClipboard()}function $i(){const{data:e,selector:t}=this;e.copy(),e.copyToSystemClipboard(),t.showClipboard()}function Vi(){const{data:e,selector:t}=this;e.cut(),t.showClipboard()}function Ki(e,t){const{data:i}=this;if("read"!==i.settings.mode)if(i.paste(e,(e=>ji("Tip",e))))Qi.call(this);else if(t){const e=t.clipboardData.getData("text/plain");this.data.pasteFromText(e),Qi.call(this)}}function Xi(){this.data.hideRowsOrCols(),Qi.call(this)}function _i(e,t){this.data.unhideRowsOrCols(e,t),Qi.call(this)}function qi(){const{data:e}=this;e.autofilter(),Qi.call(this)}function es(){const{toolbar:e}=this;e.paintformatActive()&&(Ki.call(this,"format"),Ji.call(this),e.paintformatToggle())}function ts(e){const{selector:t,data:i,table:s,sortFilter:n}=this,{offsetX:r,offsetY:l}=e,o=e.target.className===`${ee}-selector-corner`,a=i.getCellRectByXY(r,l),{left:h,top:c,width:d,height:g}=a;let{ri:u,ci:w}=a;const{autoFilter:M}=i;if(M.includes(u,w)&&h+d-20<r&&c+g-20<l){const e=M.items(w,((e,t)=>i.rows.getCell(e,t)));return n.hide(),n.set(w,e,M.getFilter(w),M.getSort(w)),void n.setOffset({left:h,top:c+g+2})}e.shiftKey||(o?t.showAutofill(u,w):Ui.call(this,!1,u,w),_(window,(e=>{({ri:u,ci:w}=i.getCellRectByXY(e.offsetX,e.offsetY)),o?t.showAutofill(u,w):1!==e.buttons||e.shiftKey||Ui.call(this,!0,u,w,!0,!0)}),(()=>{o&&t.arange&&"read"!==i.settings.mode&&i.autofill(t.arange,"all",(e=>ji("Tip",e)))&&s.render(),t.hideAutofill(),es.call(this)}))),o||1!==e.buttons||e.shiftKey&&Ui.call(this,!0,u,w)}function is(){const{editor:e,data:t}=this,i=t.getSelectedRect(),s=this.getTableOffset();let n="top";i.top>s.height/2&&(n="bottom"),e.setOffset(i,n)}function ss(){const{editor:e,data:t}=this;"read"!==t.settings.mode&&(is.call(this),e.setCell(t.getSelectedCell(),t.getSelectedValidator()),Ji.call(this))}function ns(e){const{data:t,table:i,selector:s}=this;t.scrolly(e,(()=>{s.resetBRLAreaOffset(),is.call(this),i.render()}))}function rs(e){const{data:t,table:i,selector:s}=this;t.scrollx(e,(()=>{s.resetBRTAreaOffset(),is.call(this),i.render()}))}function ls(e,t){const{ri:i}=e,{table:s,selector:n,data:r}=this;r.rows.setHeight(i,t),s.render(),n.resetAreaOffset(),Pi.call(this),is.call(this)}function os(e,t){const{ci:i}=e,{table:s,selector:n,data:r}=this;r.cols.setWidth(i,t),s.render(),n.resetAreaOffset(),Gi.call(this),is.call(this)}function as(e,t="finished"){const{data:i,table:s}=this;if("read"===i.settings.mode)return;i.setSelectedCellText(e,t);const{ri:n,ci:r}=i.selector;"finished"===t?s.render():this.trigger("cell-edited",e,n,r)}function hs(e){const{data:t}=this;"read"!==t.settings.mode&&("insert-row"===e?t.insert("row"):"delete-row"===e?t.delete("row"):"insert-column"===e?t.insert("column"):"delete-column"===e?t.delete("column"):"delete-cell"===e?t.deleteCell():"delete-cell-format"===e?t.deleteCell("format"):"delete-cell-text"===e?t.deleteCell("text"):"cell-printable"===e?t.setSelectedCellAttr("printable",!0):"cell-non-printable"===e?t.setSelectedCellAttr("printable",!1):"cell-editable"===e?t.setSelectedCellAttr("editable",!0):"cell-non-editable"===e&&t.setSelectedCellAttr("editable",!1),Ji.call(this),Qi.call(this))}function cs(e,t){const{data:i}=this;if("undo"===e)this.undo();else if("redo"===e)this.redo();else if("print"===e)this.print.preview();else if("paintformat"===e)!0===t?$i.call(this):Ji.call(this);else if("clearformat"===e)hs.call(this,"delete-cell-format");else if("link"===e);else if("chart"===e);else if("autofilter"===e)qi.call(this);else if("freeze"===e)if(t){const{ri:e,ci:t}=i.selector;this.freeze(e,t)}else this.freeze(0,0);else i.setSelectedCellAttr(e,t),"formula"!==e||i.selector.multiple()||ss.call(this),Qi.call(this)}function ds(e,t,i,s){this.data.setAutoFilter(e,t,i,s),Qi.call(this)}function gs(){const{selector:e,overlayerEl:t,rowResizer:i,colResizer:s,verticalScrollbar:n,horizontalScrollbar:r,editor:l,contextMenu:o,toolbar:a,modalValidation:h,sortFilter:c}=this;t.on("mousemove",(e=>{Yi.call(this,e)})).on("mousedown",(e=>{l.clear(),o.hide(),2===e.buttons?(this.data.xyInSelectedRect(e.offsetX,e.offsetY)||ts.call(this,e),o.setPosition(e.offsetX,e.offsetY),e.stopPropagation()):2===e.detail?ss.call(this):ts.call(this,e)})).on("mousewheel.stop",(e=>{Hi.call(this,e)})).on("mouseout",(e=>{const{offsetX:t,offsetY:n}=e;n<=0&&s.hide(),t<=0&&i.hide()})),e.inputChange=e=>{as.call(this,e,"input"),ss.call(this)},function(e,{move:t,end:i}){let s=0,n=0;J(e,"touchstart",(e=>{const{pageX:t,pageY:i}=e.touches[0];s=t,n=i})),J(e,"touchmove",(e=>{if(!t)return;const{pageX:i,pageY:r}=e.changedTouches[0],l=i-s,o=r-n;(Math.abs(l)>10||Math.abs(o)>10)&&(q(l,o,e,t),s=i,n=r),e.preventDefault()})),J(e,"touchend",(e=>{if(!i)return;const{pageX:t,pageY:r}=e.changedTouches[0];q(t-s,r-n,e,i)}))}(t.el,{move:(e,t)=>{Wi.call(this,e,t)}}),a.change=(e,t)=>cs.call(this,e,t),c.ok=(e,t,i,s)=>ds.call(this,e,t,i,s),i.finishedFn=(e,t)=>{ls.call(this,e,t)},s.finishedFn=(e,t)=>{os.call(this,e,t)},i.unhideFn=e=>{_i.call(this,"row",e)},s.unhideFn=e=>{_i.call(this,"col",e)},n.moveFn=(e,t)=>{ns.call(this,e,t)},r.moveFn=(e,t)=>{rs.call(this,e,t)},l.change=(e,t)=>{as.call(this,t,e)},h.change=(e,...t)=>{"save"===e?this.data.addValidation(...t):this.data.removeValidation()},o.itemClick=e=>{"validation"===e?h.setValue(this.data.getSelectedValidation()):"copy"===e?$i.call(this):"cut"===e?Vi.call(this):"paste"===e?Ki.call(this,"all"):"paste-value"===e?Ki.call(this,"text"):"paste-format"===e?Ki.call(this,"format"):"hide"===e?Xi.call(this):hs.call(this,e)},J(window,"resize",(()=>{this.reload()})),J(window,"click",(e=>{this.focusing=t.contains(e.target)})),J(window,"paste",(e=>{this.focusing&&(Ki.call(this,"all",e),e.preventDefault())})),J(window,"keydown",(e=>{if(!this.focusing)return;const t=e.keyCode||e.which,{key:i,ctrlKey:s,shiftKey:n,metaKey:r}=e;if(s||r)switch(t){case 90:this.undo(),e.preventDefault();break;case 89:this.redo(),e.preventDefault();break;case 67:$i.call(this),e.preventDefault();break;case 88:Vi.call(this),e.preventDefault();break;case 85:a.trigger("underline"),e.preventDefault();break;case 86:default:break;case 37:Ri.call(this,n,"row-first"),e.preventDefault();break;case 38:Ri.call(this,n,"col-first"),e.preventDefault();break;case 39:Ri.call(this,n,"row-last"),e.preventDefault();break;case 40:Ri.call(this,n,"col-last"),e.preventDefault();break;case 32:Ui.call(this,!1,-1,this.data.selector.ci,!1),e.preventDefault();break;case 66:a.trigger("bold");break;case 73:a.trigger("italic")}else{switch(t){case 32:n&&Ui.call(this,!1,this.data.selector.ri,-1,!1);break;case 27:o.hide(),Ji.call(this);break;case 37:Ri.call(this,n,"left"),e.preventDefault();break;case 38:Ri.call(this,n,"up"),e.preventDefault();break;case 39:Ri.call(this,n,"right"),e.preventDefault();break;case 40:Ri.call(this,n,"down"),e.preventDefault();break;case 9:l.clear(),Ri.call(this,!1,n?"left":"right"),e.preventDefault();break;case 13:l.clear(),Ri.call(this,!1,n?"up":"down"),e.preventDefault();break;case 8:hs.call(this,"delete-cell-text"),e.preventDefault()}"Delete"===i?(hs.call(this,"delete-cell-text"),e.preventDefault()):t>=65&&t<=90||t>=48&&t<=57||t>=96&&t<=105||"="===e.key?(as.call(this,e.key,"input"),ss.call(this)):113===t&&ss.call(this)}}))}class us{constructor(e,t){this.eventMap=function(){const e=new Map;function t(t,i){return e.has(t)&&(()=>{const s=e.get(t);return Array.isArray(s)&&s.push(i)||!1})()||e.set(t,[].concat(i))}function i(t,i){return e.has(t)&&(()=>{const s=e.get(t),n=s.indexOf(i);return n>=0&&s.splice(n,1)&&0===e.get(t).length&&e.delete(t)})()}return{get current(){return e},on:t,once:function(e,s){const n=(...t)=>{s.call(null,...t),i(e,n)};return t(e,n)},fire:function(t,i){return e.has(t)&&(()=>{const s=e.get(t);for(const e of s)e.call(null,...i)})()},removeListener:i,removeAllListeners:function(){e.clear()}}}();const{view:i,showToolbar:s,showContextmenu:r}=t.settings;this.el=n("div",`${ee}-sheet`),this.toolbar=new yi(t,i.width,!s),this.print=new yt(t),e.children(this.toolbar.el,this.el,this.print.el),this.data=t,this.tableEl=n("canvas",`${ee}-table`),this.rowResizer=new te(!1,t.rows.height),this.colResizer=new te(!0,t.cols.minWidth),this.verticalScrollbar=new ie(!0),this.horizontalScrollbar=new ie(!1),this.editor=new Ze(_e,(()=>this.getTableOffset()),t.rows.height),this.modalValidation=new vi,this.contextMenu=new Lt((()=>this.getRect()),!r),this.selector=new fe(t),this.overlayerCEl=n("div",`${ee}-overlayer-content`).children(this.editor.el,this.selector.el),this.overlayerEl=n("div",`${ee}-overlayer`).child(this.overlayerCEl),this.sortFilter=new ki,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new pt(this.tableEl.el,t),gs.call(this),Qi.call(this),Ui.call(this,!1,0,0)}on(e,t){return this.eventMap.on(e,t),this}trigger(e,...t){const{eventMap:i}=this;i.fire(e,t)}resetData(e){this.editor.clear(),this.data=e,Pi.call(this),Gi.call(this),this.toolbar.resetData(e),this.print.resetData(e),this.selector.resetData(e),this.table.resetData(e)}loadData(e){return this.data.setData(e),Qi.call(this),this}freeze(e,t){const{data:i}=this;return i.setFreeze(e,t),Qi.call(this),this}undo(){this.data.undo(),Qi.call(this)}redo(){this.data.redo(),Qi.call(this)}reload(){return Qi.call(this),this}getRect(){const{data:e}=this;return{width:e.viewWidth(),height:e.viewHeight()}}getTableOffset(){const{rows:e,cols:t}=this.data,{width:i,height:s}=this.getRect();return{width:i-t.indexWidth,height:s-e.height,left:t.indexWidth,top:e.height}}}class ws extends St{constructor(e){super(new Ee("ellipsis"),"auto",!1,"top-left"),this.contentClick=e}reset(e){const t=e.map(((e,t)=>n("div",`${ee}-item`).css("width","150px").css("font-weight","normal").on("click",(()=>{this.contentClick(t),this.hide()})).child(e)));this.setContentChildren(...t)}setTitle(){}}const Ms=[{key:"delete",title:S("contextmenu.deleteSheet")}];function ps(e){return n("div",`${ee}-item`).child(e.title()).on("click",(()=>{this.itemClick(e.key),this.hide()}))}function xs(){return Ms.map((e=>ps.call(this,e)))}class fs{constructor(){this.el=n("div",`${ee}-contextmenu`).css("width","160px").children(...xs.call(this)).hide(),this.itemClick=()=>{}}hide(){const{el:e}=this;e.hide(),K(e)}setOffset(e){const{el:t}=this;t.offset(e),t.show(),X(t)}}class Ds{constructor(e=(()=>{}),t=(()=>{}),i=(()=>{}),s=(()=>{})){this.swapFunc=t,this.updateFunc=s,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new ws((e=>{this.clickSwap2(this.items[e])})),this.contextMenu=new fs,this.contextMenu.itemClick=i,this.el=n("div",`${ee}-bottombar`).children(this.contextMenu.el,this.menuEl=n("ul",`${ee}-menu`).child(n("li","").children(new Ee("add").on("click",(()=>{e()})),n("span","").child(this.moreEl))))}addItem(e,t){this.dataNames.push(e);const i=n("li",t?"active":"").child(e);i.on("click",(()=>{this.clickSwap2(i)})).on("contextmenu",(e=>{const{offsetLeft:t,offsetHeight:s}=e.target;this.contextMenu.setOffset({left:t,bottom:s+1}),this.deleteEl=i})).on("dblclick",(()=>{const e=i.html(),t=new Ti("auto","");t.val(e),t.input.on("blur",(({target:t})=>{const{value:i}=t,s=this.dataNames.findIndex((t=>t===e));this.renameItem(s,i)})),i.html("").child(t.el),t.focus()})),t&&this.clickSwap(i),this.items.push(i),this.menuEl.child(i),this.moreEl.reset(this.dataNames)}renameItem(e,t){this.dataNames.splice(e,1,t),this.moreEl.reset(this.dataNames),this.items[e].html("").child(t),this.updateFunc(e,t)}clear(){this.items.forEach((e=>{this.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}deleteItem(){const{activeEl:e,deleteEl:t}=this;if(this.items.length>1){const i=this.items.findIndex((e=>e===t));if(this.items.splice(i,1),this.dataNames.splice(i,1),this.menuEl.removeChild(t.el),this.moreEl.reset(this.dataNames),e===t){const[e]=this.items;return this.activeEl=e,this.activeEl.toggle(),[i,0]}return[i,-1]}return[-1]}clickSwap2(e){const t=this.items.findIndex((t=>t===e));this.clickSwap(e),this.activeEl.toggle(),this.swapFunc(t)}clickSwap(e){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=e}}var Is=i(72),ms=i.n(Is),bs=i(825),ys=i.n(bs),Es=i(659),Ts=i.n(Es),Ns=i(56),Ls=i.n(Ns),Cs=i(540),vs=i.n(Cs),Ss=i(113),As=i.n(Ss),zs=i(388),Bs=i.n(zs),ks={};ks.styleTagTransform=As(),ks.setAttributes=Ls(),ks.insert=Ts().bind(null,"head"),ks.domAPI=ys(),ks.insertStyleElement=vs();ms()(Bs(),ks);Bs()&&Bs().locals&&Bs().locals;class js{constructor(e,t={}){let i=e;this.options={showBottomBar:!0,...t},this.sheetIndex=1,this.datas=[],"string"==typeof e&&(i=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new Ds((()=>{const e=this.addSheet();this.sheet.resetData(e)}),(e=>{const t=this.datas[e];this.sheet.resetData(t)}),(()=>{this.deleteSheet()}),((e,t)=>{this.datas[e].name=t})):null,this.data=this.addSheet();const s=n("div",`${ee}`).on("contextmenu",(e=>e.preventDefault()));i.appendChild(s.el),this.sheet=new us(s,this.data),null!==this.bottombar&&s.child(this.bottombar.el)}addSheet(e,t=!0){const i=e||`sheet${this.sheetIndex}`,s=new Q(i,this.options);return s.change=(...e)=>{this.sheet.trigger("change",...e)},this.datas.push(s),null!==this.bottombar&&this.bottombar.addItem(i,t),this.sheetIndex+=1,s}deleteSheet(){if(null===this.bottombar)return;const[e,t]=this.bottombar.deleteItem();e>=0&&(this.datas.splice(e,1),t>=0&&this.sheet.resetData(this.datas[t]))}loadData(e){const t=Array.isArray(e)?e:[e];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],t.length>0)for(let e=0;e<t.length;e+=1){const i=t[e],s=this.addSheet(i.name,0===e);s.setData(i),0===e&&this.sheet.resetData(s)}return this}getData(){return this.datas.map((e=>e.getData()))}cellText(e,t,i,s=0){return this.datas[s].setCellText(e,t,i,"finished"),this}cell(e,t,i=0){return this.datas[i].getCell(e,t)}cellStyle(e,t,i=0){return this.datas[i].getCellStyle(e,t)}reRender(){return this.sheet.table.render(),this}on(e,t){return this.sheet.on(e,t),this}validate(){const{validations:e}=this.data;return e.errors.size<=0}change(e){return this.sheet.on("change",e),this}static locale(e,t){A(e,t)}}const Os=(e,t={})=>new js(e,t);window&&(window.x_spreadsheet=Os,window.x_spreadsheet.locale=(e,t)=>A(e,t));const Zs=js},61:e=>{"use strict";e.exports=Vue}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={id:s,exports:{}};return e[s](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nc=void 0,(()=>{"use strict";var e,t=(e=i(387))&&e.__esModule?e:{default:e};zen.setup({com:t.default})})()})();